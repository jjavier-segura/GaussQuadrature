function [x,w,ie]=GJ(n,a,b,me)
% Gauss-Jacobi quadrature
% Copyright 2025 A. Gil, J. Segura, N. M. Temme
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INPUT:
%%%%%%%%
%n: degree
%a: alpha
%b: beta
%me: mode of computation
%     me=0 (or third input omitted): combined method
%     me=1:                          only iterative
%     me=2:                          only GW
%     me=3:                          only asymptotics (n not too small)
%--------------------------------------------------------------------
% OUTPUT
%%%%%%%%
%x: nodes
%w: weights
%ie: error flag. If ie=0 computation succesfull
%                   ie=1 computation failed
%                   ie=2 some weights are too small and are set to zero
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
x=[];w=[];
ie=0;
if nargin<4
   me=0;
else
   if(me~=fix(me))||(abs(me-1.5)>2)
      disp('Error: the last input should be either 0, 1 or 2');
      return;
   end
end   
if me<1
% COMBINED METHOD    
   if (a==0)&&(b==0)
      [x,w]=legen(n);
      %disp('legen');
      % Gauss-Legendre algorithm
   elseif (abs(a)==0.5)&&(abs(b)==0.5)
      [x,w]=chebq(n,a,b);
      %disp('cheb');
      % Explicit Chebyshev expressions     
   elseif n<10
      [x,w]=GWGJ(n,a,b);
      %disp('GW');
      % Golub-Welsch      
   else
      te=min(4/55*(n-195),2400);
      te2=a^2+b^2;
      if (n>250)&&(te2<te)
         [x,w]=asympGJ(n,a,b);
         %disp('Asymp');
         % Asymptotic method
      else  
         [x,w]=iterGJ(n,a,b);
         %disp('iter');
         % Iterative method
      end
   end   
elseif me==1
   [x,w]=iterGJ(n,a,b);
   %disp('iter')
   %Iterative-only method
elseif me==2    
   [x,w]=GWGJ(n,a,b);
   %disp('GW');
   %Golub-Welsch (me=2) 
else
   if n>2
     [x,w]=asympGJ(n,a,b);
   %  disp('Asymp');
   % Asymptotic method
   else
     ie=1;
   end  
end  

if length(x)>0
   maw=max(w);
   if ~isfinite(maw)||maw==0
      disp('Error. Probably the degree or the parameters are too large');
      x=[];w=[];
      ie=1;
      return
   elseif min(w)==0
      disp('Warning: some weights are too small and have been set to zero')
      ie=2;
   end
else
   disp('Error. Degree or parameters out of range');
   ie=1;
end

end


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [x,w]=iterGJ(n,a,b)
% Iterative method for Gauss-Jacobi quadrature
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%x: nodes
%w: weights
%n: degree
%a: alpha
%b: beta
%--------------------------------------------------
ab=a+b;ab2=a+b+2;
lo=(ab+1)*log(2)+gammaln(a+1)+gammaln(b+1)-gammaln(ab2);
[x1,w1]=fsweep(n,a,b);
if a==b
  x2=x1;w2=w1;
else    
  [x2,w2]=fsweep(n,b,a);
end  
x2=-x2(end:-1:1);
w2=w2(end:-1:1);
if ~isempty(x1)&&~isempty(x2)
   if (abs(x2(end)-x1(1)))<5.e-15
      x2=x2(1:end-1);
      w2=w2(1:end-1);
   end 
end  
x=[x2 x1];
w=[w2 w1];
jl=0;
maw=max(w);
if ~isfinite(maw)||maw==0
   x=[];w=[];
   return
end  
numec=max(3,floor(log(n)/log(10))+1);
numec=min(n,numec);
for i=1:numec
   if (x(i)<-0.95)&&(b<-0.01)
      jl=jl+1;
      t=acos(-x(i));
      [tn,wn]=fixedt(n,b,a,t);
      w(i)=wn;
      x(i)=-cos(tn);
   end    
end
le=length(x);
jr=0;
for i=0:numec-1
   if (x(le-i)>0.95)&&(a<-0.01)
      jr=jr+1;
      t=acos(x(le-i));
      [tn,wn]=fixedt(n,a,b,t);
      w(le-i)=wn;
      x(le-i)=cos(tn);
   end    
end
w0=w(1:jl);w1=w(jl+1:le-jr);w2=w(le-jr+1:le);
w1m=max(w1);
if w1m==0
   x=[];w=[];
   return
end 
w1=w1/w1m;
if (a>-0.75)&&(b>-0.75)
   w0=fa(n,b,a)*w0;w2=fa(n,a,b)*w2;
   la=(exp(lo)-sum(w0)-sum(w2))/sum(w1);
   w=[w0,la*w1,w2];
else
   x0=x(1:jl);x1=x(jl+1:le-jr);x2=x(le-jr+1:le);
   r1=(b-a)/ab2; 
   r2=((a-b)^2+ab2)/(ab2*(ab2+1));
   s00=sum(w0);s01=sum(w1);s02=sum(w2);
   s10=sum(x0.*w0);s11=sum(x1.*w1);s12=sum(x2.*w2);
   s20=sum(x0.^2.*w0);s21=sum(x1.^2.*w1);s22=sum(x2.^2.*w2);  
   if (s00*s01*s02>0)
      del1=s00*s11*s22+s20*s01*s12+s10*s21*s02;
      del2=s20*s11*s02+s10*s01*s22+s00*s12*s21;
      del=del1-del2;
      la0=s11*s22+r2*s01*s12+r1*s02*s21-s21*s12-r1*s01*s22-r2*s11*s02;           
      la0=la0/del;
      la1=-s10*s22-r2*s00*s12-r1*s02*s20+s20*s12+r1*s00*s22+r2*s10*s02;
      la1=la1/del;
      la2=s10*s21+r2*s00*s11+r1*s01*s20-s20*s11-r1*s00*s21-r2*s10*s01;
      la2=la2/del;
      w=[la0*w0,la1*w1,la2*w2];
   elseif (s00*s01>0)
      del=s00*s11-s10*s01;
      la0=(s11-r1*s01)/del;
      la1=(r1*s00-s10)/del;
      w=[la0*w0,la1*w1];
   elseif (s00*s02>0)
      del=s00*s12-s10*s02;
      la0=(s12-r1*s02)/del;
      la2=(r1*s00-s10)/del;
      w=[la0*w0,la2*w2];
   elseif (s01*s02>0)
      del=s01*s12-s11*s02;
      la1=(s12-r1*s02)/del;
      la2=(r1*s01-s11)/del;
      w=[la1*w1,la2*w2];
   else    
      w=w/sum(w);
   end    
   w=w*exp(lo);
end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%% function fsweep%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [x,w]=fsweep(n,a,b)
x=[];
w=[];
L=2*n+a+b+1;L2=L*L;
a2=2*a*a;b2=2*b*b;
ab=a+b;
B=(b-a)*((ab+6)*n+2*ab);
A=(2*n+ab)*(n*(2*n+ab)+2*(ab+2));
Delta=n^2*(n+ab+1)^2+(a+1)*(b+1)*(n^2+(ab+4)*n+2*ab);
xf=(B+4*(n-1)*sqrt(Delta))/A;
xi=ab*(b-a)/(L^2-1);
if b-a==0
   nor=1.e-130;
   ind=n-2*floor(n/2);
   if ind>0
       y0=0;y1=nor;
   else
       y0=nor;y1=0;
   end
else
   facm=recu(n,a,b,xi);
   if ~isinf(facm)
      nor=1; 
      y1=nor;
      if(abs(xi)<0.4)
         if n<250   
            while (abs(facm)>1)&&(abs(xi)<0.45)
               xi=1.1*xi;
               facm=recu(n,a,b,xi);
            end
         else
            if abs(facm)>1
               xi=1.2*xi;
               facm=recu(n,a,b,xi);
            end
         end
      end
      y0=y1*facm;
   else
      y0=1;
      y1=0;
   end    
end
i=0;
while xi<xf
   [xt,wt,y0,y1]=fixedzser(n,a,b,xi,y0,y1);
      i=i+1;
      x(i)=xt;
      w(i)=wt;
   if (i>2)&& (abs(x(i)/x(i-1)-1)<2.e-15) 
       xf=0;
       x=x(1:length(x)-1);         
       w=w(1:length(w)-1);
   end    
   sqde=sqrt(0.25*((L2-1)*(1-xt*xt)-a2*(1+xt)-b2*(1-xt)));
   de=-tanh(pi/sqde);
   xi=(xt-de)/(1-xt*de);
   t=xi-xt;
   [y0,y1]=seriestay(n,a,b,xt,t,y0,y1);
end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% function fixedt
function [t,w]=fixedt(n,a,b,t0)
epsil=1.e-15;
erro=1;
L=2*n+a+b+1;
L24=L*L/4;
ll2=2*(n+a+b+1);
a4=1/4-a*a;
ab2=a*a-b*b;
i=0;
while erro>epsil
   i=i+1;
   st2=sin(t0/2)^2;
   sq=a4+L24*sin(t0)^2+ab2*st2;
   sqde=sqrt(abs(sq));
   h=1/2+a+st2*(L-ll2*cft(n,a+1,b,t0));
   h=1/h;
   if sq>0
      at=atan(sqde*h);
   else
      at=atanh(sqde*h);
   end
   t=t0-sin(t0)/sqde*at;
   erro=abs(1-t/t0);
   t0=t;
end
w=1/seriest(n-1,a+1,b+1,t)^2/sin(t)^2;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% function cft
% The output is P(n,alpha,beta,cos(theta))/P(n,alpha-1,beta,cos(theta))
function cf=cft(n,a,b,theta)
ai=a+1;
t=sin(theta/2)^2;
bp=-1-(n*t+a)/((n+a+b+1)*t);
ap=-(a+n)/(n+a+b+1)/t;
bb=-1-(n*t+ai)/((n+ai+b+1)*t);
aa=-(ai+n)/(n+ai+b+1)/t;
E=bb;F=bb+aa/bp;cf=ap/(bp+aa/bb);
del=abs(E/F-1);
nb1=n+b+1;
while del>1.0e-15
  ai=ai+1;
  bb=-1-(n*t+ai)/((ai+nb1)*t);
  aa=-(ai+n)/(ai+nb1)/t;
  E=bb+aa/E;
  F=bb+aa/F;
  R=E/F;
  del=abs(R-1);
  cf=cf*R;
end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% function seriest
function  s=seriest(n,a,b,theta)
% The output is 2F1(-n,n+a+b+1;a+1;sin(theta/2)^2)
t=sin(theta/2)^2;
nab=n+a+b;
s=1;
de=1;
k=0;
er=1;
while er>1.e-17
  k=k+1;
  de=(k+nab)*(k-1-n)/k/(k+a)*t*de;
  s=s+de;
  er=abs(de/s);
end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% function fa
function fa=fa(n,a,b)
lofa1=(a+b+3)*log(2)+2*gammaln(a+2)+gammaln(n)+gammaln(n+b+1);
lofa2=log(n)+2*log(n+a+b+1)+gammaln(n+a+1)+gammaln(n+a+b+1);
fa=exp(lofa1-lofa2);
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% function recu
function r=recu(n,a,b,x)
abm=a-b;ab1=a+b+1;ab2=a*a-b*b;
h=0.5*(abm+(ab1+1)*x);
for k=1:n-1
  L=2*k+ab1;
  A=2*(k+1)*(k+ab1)*(L-1);
  B=L*((L^2-1)*x+ab2);
  C=2*(k+a)*(k+b)*(L+1);
  h=(B-C/h)/A;
end
L=2*n+a+b+1;
r=(n+b+1)/2/(1+x)-(n+a+1)/2/(1-x)+1/(L-1)/(1-x^2)*(n*(a-b)+2*(n+a)*(n+b)/h);
r=1/r;
% h is P(n,a,b,x)/P(n-1,a,b,x)
% r is Y/Y', the value used for starting Taylor
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% function fixedzser
function [x,w,y0,y1]=fixedzser(n,a,b,x0,y0,y1)
% fixed point on z and using Taylor for (1-x)^(a+1)/2*(1+x)^(b+1)/2*P
epsil=2.3e-16;
erro=1;
L=2*n+a+b+1;L21=L*L-1;a2=2*a*a;b2=2*b*b;
i=0;
while erro>epsil
   i=i+1;
   sq=0.25*(L21*(1-x0*x0)-a2*(1+x0)-b2*(1-x0));
   sqde=sqrt(abs(sq));
   h=y0/(y1*(1-x0*x0)+x0*y0);
   if sq>0
      argu=atan(sqde*h)/sqde;    
      if h>1
         argu=argu-pi/sqde; 
      end    
      de=tanh(argu);
   else
      de=tanh(atanh(sqde*h)/sqde);
   end
   x=(x0-de)/(1-x0*de);   
   erro=abs(1-x/x0);
   t=x-x0;
   [y0,y1]=seriestay(n,a,b,x0,t,y0,y1);
   x0=x;
end
w=(1-x)^(a)*(1+x)^(b)/y1/y1;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% function seriestay
function [y0,yp1]=seriestay(n,a,b,xp,t,y0,yp1)
% TAYLOR in the variable x for (1-x)^((a+1)/2)*(1+x)*((b+1)/2)P(n,a,b,x)
epso=1.0e-19;
ym1=0;ym2=0; 
delta=t;
y0=y0*1.e-30;
yp1=yp1*1.e-30;
suma=y0+yp1*t;
sumad=yp1;
j=-1;
errod=1; 
xp2=xp*xp;
a2=a*a;b2=b*b;
L=2*n+a+b+1;L2=L*L;
while (errod>epso)&&(j<100)
   j=j+1;
   c1=4*(j+2)*(j+1)*(1-xp2)^2;
   c2=-16*(j+1)*j*(1-xp2)*xp;
   c3=0.5*j*(j-1)*(48*xp2-16)+(L2-1)*(1-xp2)-(2*(b2-1))*(1-xp)-(2*(a2-1))*(1+xp);
   c4=16*(j-1)*(j-2)*xp-2*(L2-1)*xp+2*b2-2*a2;
   c5=4*(j-2)*(j-3)+(1-L2);
   yp2= -1/c1*(c2*yp1+c3*y0+c4*ym1+c5*ym2);
   ym2=ym1;ym1=y0;y0=yp1;yp1=yp2;  
   ntd=(j+2)*yp2*t;
   sumad=sumad+ntd;
   t=t*delta;
   nt=yp2*t;
   suma=suma+nt;
   if (j>20) && (y0*yp1~=0)
      errod=max(abs((ntd/sumad)),abs((nt/suma)));
   end
end
y0=suma;yp1=sumad;
y0=y0*1.e30;
yp1=yp1*1.e30;
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
function  [xcn,w]=asympGJ(n,alpha,beta)
%---------------------------------------------------------------------
% Computation of the nodes and weights of the Gauss-Jacobi quadrature
% using asymptotic expansions.
% --------------------------------------------------------------------
NN=0.1*n;
nelem=floor(NN);
nbess=floor((n-nelem)*0.5);
if (nelem+2*nbess)<n
  nelem=nelem+1;
end  
if nelem==0
  [jacn1b,jacw1b,jacn2b,jacw2b]=besselNWGJ(n,alpha,beta,nelem);  
  xcn=[-jacn2b(nbess:-1:1)  jacn1b];
  w=[jacw2b(nbess:-1:1) jacw1b]; 
else    
  [xcn1,w1]=elemenNWGJ(n,alpha,beta,nelem);
  [jacn1b,jacw1b,jacn2b,jacw2b]=besselNWGJ(n,alpha,beta,nelem);  
  xcn=[-jacn2b(nbess:-1:1)  xcn1 jacn1b];
  w=[jacw2b(nbess:-1:1) w1 jacw1b]; 
end  
end
function [jacn,jacw]=elemenNWGJ(n,a,b,nelem)
%--------------------------------------------------------------------
% Calculation of the nodes and weights of Gauss-Jacobi quadrature 
% using the asymptotic expansion in terms of elementary functions
% -------------------------------------------------------------------         
%% n odd or even
%----------------
nbess=floor((n-nelem)*0.5);
if rem(n,2)==0
  nev=1;
  mm=n/2;
else
  nev=0;
  mm=(n-1)/2;
end  
alphah=a*0.5;
a2=a*a;
a3=a2*a;
a4=a2*a2;
a5=a4*a;
a6=a4*a2;
a7=a6*a;
a8=a6*a2;
a9=a8*a;
a10=a8*a2;
a11=a10*a;
a12=a10*a2;
b2=b*b;
b4=b2*b2;
b6=b4*b2; 
b8=b6*b2;
b10=b8*b2;
b12=b10*b2;
abp1=a+b+1.0;
kappa=n+0.5*abp1;
kappai=1.0/kappa;
kappa2=kappa*kappa;
kappa2i=1.0/kappa2;
kappa3=kappa2*kappa;
kappa3i=1.0/kappa3;
kappa4=kappa3*kappa;
kappa4i=1.0/kappa4;
kappa5=kappa4*kappa;
kappa5i=1.0/kappa5;
kappa6=kappa5*kappa;
kappa6i=1.0/kappa6;
gk(1)= 1.0;
gk(2)=0.5*b;
gk(3)=-(1.0/24.0)*(a+1-3*b2);
gk(4)=-(1.0/48.0)*b*(1-b2+a);
gk(5)= (1.0/5760.0)*(12.0*a+7+15*b4-30*a*b2+5*a2-30*b2);
gk(6)= (1.0/11520.0)*b*(7+3*b4-10*a*b2+5*a2-10*b2+12*a);
gk(7)= -(1.0/2903040.0)*(205*a+93-63*b6+315*b4*a+315*b4...
          -315*a2*b2-756*a*b2+35*a3+147*a2-441*b2);
gk(8)= -(1.0/5806080.0)*b*(93-9*b6+63*b4+63*b4*a-105*a2*b2...
       +35*a3-252*a*b2+147*a2-147*b2+205*a);
gk(9)= (1.0/1393459200.0)*(2912*a+1143+135*b8-1260*a*b6-1260*b6...
        +3150*b4*a2+7560*b4*a-2100*a3*b2+175*a4+4410*b4-8820*a2*b2...
        -12300*a*b2+1120*a3+2714*a2-5580*b2);
gk(10)= (1.0/2786918400.0)*b*(1143+15*b8-180*a*b6+630*b4*a2...
        -180*b6+882*b4+1512*b4*a-700*a3*b2+175*a4-2940*a2*b2+1120.0*a3...
        -4100*a*b2+2714*a2-1860*b2+2912*a);
gk(11)= -(1.0/367873228800.0)*(21481.0*a+7665.0-99*b10...
        +1485.0*a*b8+1485*b8-6930*a2*b6-16632.0*a*b6+11550.0*b4*a3...
        -9702.0*b6+385*a5+48510.0*b4*a2-5775.0*a4*b2+67650.0*b4*a...
        -36960.0*a3*b2+3465.0*a4+30690.0*b4-89562.0*a2*b2-96096.0*a*b2...
        +12694.0*a3+23430.0*a2-37719.0*b2);
gk(12)= -(1.0/735746457600.0)*b*(7665.0-9*b10+165*a*b8+165*b8-990*a2*b6...
        +2310.0*b4*a3-2376.0*a*b6+9702.0*b4*a2-1925.0*a4*b2-1386.0*b6...
        +6138.0*b4+13530.0*b4*a+385*a5-12320*a3*b2+3465*a4-29854*a2*b2...
        +12694.0*a3-32032*a*b2+23430*a2-12573*b2+21481*a);
gk(13)= (1.0/24103053950976000.0)*(12730293.0+38231028.0*a...
        +12285*b12-270270.0*a*b10+2027025.0*a2*b8-270270.0*b10...
        -6306300.0*a3*b6+4864860.0*a*b8+2837835.0*b8+7882875.0*a4*b4...
        -26486460.0*a2*b6-36936900.0*a*b6+50450400.0*b4*a3-3153150.0*a5*b2...
        -16756740.0*b6+175175.0*a6+2102100.0*a5+122252130.0*b4*a2...
        -28378350.0*a4*b2+131171040.0*b4*a-103963860.0*a3*b2+10745735.0*a4...
        +51486435.0*b4-191891700.0*a2*b2-175929390.0*a*b2+29717688.0*a3...
        +46399613.0*a2-62776350.0*b2);
S= 1.0; d= 1.0; k= 0; p= 1.0; 
while ((d > 1.0e-16)&&(k < 12))||(k<4)
  p= p*(-a+k)/kappa; k= k+1;
  t= gk(k+1)*p;
  d= abs(t);
  S= S+t;
end
Gab=S;
factor=Gab/(sqrt(pi*kappa));
% M factor for the weights
apbp1=a+b+1.0;
C1N=qasymN(n+1,a);
C2N=1/qasymN(n+b+1,a);
Mfactor=2.0^apbp1*C1N*C2N;
factord=(1.0/sqrt(Mfactor))*factor;
% Nodes
ii=0;
for k=nbess+1:nelem+nbess
  ii=ii+1;  
  theta0=(n+1.0-k+alphah-0.25)*pi/kappa; 
  xz=cos(theta0);
  x=xz;
  x2=xz*xz;
  x3=x2*xz;
  x4=x3*xz;
  x5=x4*xz;
  x6=x5*xz;
  sinth=sin(theta0);
  s2=sinth*sinth;
  s3=s2*sinth;
  s5=s3*s2;
  s6=s3*s3;
  theta1=-(0.125000)*(2*a2*x+2*b2*x-2*b2+2*a2-x)/sinth;
  theta2= (0.00260416666666666666666666666667)*(24*a2*b2*x3-24*a2*b2*x-33*x...
          -36*b2*x2+36*a2*x2-24*a4*x2+24*b4*x2+84*b2*x-60*a4*x...
          -60*b4*x+84*a2*x-8*b2*x3-8*a2*x3+4*b4*x3+4*a4*x3+40*a2-40*b2-32*a4+32*b4+2*x3)/s3;
  theta3= -0.0000651041666666666666666666666667*(-120*a4*b2*x2+520*a4*b2*x-760*a4*b2*x3...
  	      -760*a2*b4*x3+520*a2*b4*x+120*a2*b4*x2-80*a4*b2*x4+80*a2*b4*x4+1720.0*a2*b2*x3-1240*a2*b2*x...
          -480*a2*b2*x5+240*a4*b2*x5+240*a2*b4*x5-2595*x-7120*b2*x2+7120.0*a2*x2-6320*a4*x2...
          +6320*b4*x2+6690*b2*x-5980*a4*x-5980*b4*x+6690*a2*x+200*a4*b2-200*a2*b4+2720*b2*x3...
          +2720*a2*x3-1960*b6*x2+760*b6*x3+1880*b6*x+760*a6*x3+1880*a6*x+1960*a6*x2-2460*b4*x3...
          -2460*a4*x3-370*b2*x4+370*a2*x4-80*b6*x4+80*a6*x4+280*b4*x4-280*a4*x4+16*b6*x5+...
           16*a6*x5+112*b2*x5+112*a2*x5-80*b4*x5-80*a4*x5+2032*a2-2032*b2-1920*a4+1920*b4...
          -1160*x3+616*a6-616*b6-24*x5)/s5;
  epsil=theta1*kappa2i+theta2*kappa4i+theta3*kappa6i;
  theta=theta0+epsil;
  thetah=theta*0.5;
  if (k>=0.2*n) && (k<0.8*n)
    j=k-mm;
    if nev==1
      delta=(a-b+2.0-4.0*j)*0.25*pi/kappa;
    else
      delta=(a-b+4.0-4.0*j)*0.25*pi/kappa;
    end    
    jacn(ii)=-sin(epsil+delta); 
  else  
    jacn(ii)=cos(theta);
  end  
  % Calculation of weights
  s=sin(theta);
  s2=s*s;
  s3=s2*s;
  s4=s2*s2;
  x=jacn(ii);
  x2=x*x;
  x3=x2*x;
  x4=x3*x;
  chi=kappa*theta-(alphah+0.25)*pi;
  if (k>=0.2*n) && (k<0.8*n)  
    coschi=(-1.0)^(n-k+1)*sin(kappa*epsil);
    sinchi=(-1.0)^(n-k)*cos(kappa*epsil); 
  else
    sinchi=sin(chi);
    coschi=cos(chi);
  end  
  nk1=0.1250*(2*a2*x+2*b2*x-2*b2+2*a2-x)/s;
  mk2=-0.00260416666666666666666666666667*(-24+16*a-24*a2*b2-48*a*b2+48*a2+48*b2...
       +12*a4+12*b4-16*a3+3*x2+12*a4*x2+12*b4*x2-12*b2*x2-12*a2*x2...
       +16*a3*x2-16*x2*a+36*a2*x-36*b2*x+24*a4*x-24*b4*x+24*a2*b2*x2+...
       48*b2*x2*a)/s2;
  nk3=-0.000325520833333333333333333333333*(-32*a*b2-24*a4*b2+24*a2*b4-64*a3*b2+96*a*b4...
       -208*a2+208*b2+32*a4-32*b4+32*a3+8*a6-8*b6-32*a5+192*x-384*a2*x...
       -384*b2*x+15*x3-58*b2*x3-58*a2*x3-24*b6*x2+8*b6*x3+24*b6*x+8*a6*x3...
       +24*a6*x+24*a6*x2+20*b4*x3+20*a4*x3-48*a3*x3+32*a5*x3+32*a5*x2-32*a5*x...
       +48*a3*x+16*x3*a-16*x*a-24*a2*b4*x-24*a2*b4*x2+168*a2*b2*x3+80*b2*x*a+...
        24*a4*b2*x2-96*b4*x2*a+24*a2*b4*x3-168*a2*b2*x-24*a4*b2*x+24*a4*b2*x3+...
        64*a3*b2*x2+96*b4*x3*a-128*a3*x*b2-80*b2*x3*a+128*a3*x3*b2-96*b4*x*a+...
        234*b2*x2-234*a2*x2+72*a4*x2-72*b4*x2+84*a4*x+84*b4*x-32*a3*x2+32*b2*x2*a)/s3;
  nk5= 0.2543131510416666666666667e-6*(28160.0*a4*b2*x-113200.0*a4*b2*x3+62640.0*a4*b2*x4...
        -68400.0*a4*b2*x2-14720.0*a6*b2*x4-11840.0*a6*b2*x+25600.0*a6*b2*x3...
        -11840.0*a2*b6*x+25600.0*a2*b6*x3+14720.0*a2*b6*x4-62640.0*a2*b4*x4...
        +68400.0*a2*b4*x2+28160.0*a2*b4*x-113200.0*a2*b4*x3+27520.0*a6*b2*x2...
        -13760.0*a6*b2*x5-13760.0*a2*b6*x5-27520.0*a2*b6*x2-9280.0*a4*b6*x4...
        +18560.0*a4*b6*x2+9280.0*a4*b6*x+9280.0*a4*b6*x5-18560.0*a4*b6*x3...
        -2240.0*a2*b8*x2+3360.0*a2*b8*x-2240.0*a2*b8*x3-1120.0*a2*b8*x5+3360.0*a2*b8*x4...
        +3360.0*a8*b2*x-2240.0*a8*b2*x3-1120.0*a8*b2*x5+2240.0*a8*b2*x2-3360.0*a8*b2*x4...
        +9280.0*a6*b4*x5+9280.0*a6*b4*x4-18560.0*a6*b4*x2+9280.0*a6*b4*x-18560.0*a6*b4*x3...
        +85040.0*a4*b2*x5+85040.0*a2*b4*x5+584640.0*x+1519200.0*b2*x2-1519200.0*a2*x2...
        -873280.0*b4*x2+873280.0*a4*x2-1357440.0*b2*x+760320.0*a4*x+760320.0*b4*x...
        -1357440.0*a2*x+400920.0*b4*x3-32880.0*b4*x4+32880.0*a4*x4+400920.0*a4*x3...
        +5760.0*a4*b2-12800.0*a6*b2+12800.0*a2*b6-5760.0*a2*b4-2880.0*a8*x2+...
        3520.0*a8*x4-3920.0*a8*x+2080.0*a8*x3-3920.0*b8*x+2080.0*b8*x3...
        -3520.0*b8*x4+2880.0*b8*x2-112560.0*a6*x2-10640.0*a6*x4-89600.0*a6*x...
        -59920.0*a6*x3-89600.0*b6*x-59920.0*b6*x3+10640.0*b6*x4+112560.0*b6*x2...
        -688640.0*b2*x3-688640.0*a2*x3+76950.0*b2*x4-76950.0*a2*x4+160.0*a10*x4...
        +160.0*a10*x+320.0*a10*x3+32*a10*x5+320*a10*x2-320*b10*x2+160*b10*x+320*b10*x3...
        +32*b10*x5-160*b10*x4+9280.0*a6*b4+27402.0*b2*x5+27402.0*a2*x5...
        -17000.0*b4*x5-17000.0*a4*x5+1200.0*a8*x5+1200.0*b8*x5+...
        336.0*a6*x5+336.0*b6*x5+1120.0*a8*b2-9280.0*a4*b6...
        -1120.0*a2*b8-422528.0*a2+422528.0*b2-238080.0*b4+...
        238080.0*a4+292320.0*x3-25984.0*a6+25984.0*b6-1280.0*a8...
        +1280.0*b8-5985.0*x5+32*a10-32*b10+106800.0*a2*b2*x3+20480.0*a2*b2*x...
        -56800.0*a4*b4*x+113600.0*a4*b4*x3-56800.0*a4*b4*x5-127280.0*a2*b2*x5)/s5;
  mk4= 6.78168402777777777777777777778e-7*(-54720+6912*a-32640*a2*b2-26880*a*b2+9600*a4*b2+...
        13440*a2*b4-960*a6*b2+1440*a4*b4-960*a2*b6+11520*a3*b2+9600*a3*b4+1920*a*b4...
        -1920*a5*b2-5760*a*b6+128000*a2+126720*b2-59200*a4-56640*b4-3840*a3-640*a6...
        -1920*b6+240*a8+240*b8-1920*a7-1152*a5+297600*a2*x-297600*b2*x-945*x4-33840*a2*b2*x4...
        +9600*a5*b2*x4-7680*a5*x2*b2+11520*a5*b2*x3+1440*a4*b4*x4+960*a2*b6*x4+34560*a3*b2*x4...
        -11520*b6*x3*a-3840*a3*b4*x3+1920*a2*b6*x+33120*a4*b2*x4+5760*b6*x4*a-23040*a3*b4*x2...
        -11520*a5*x*b2-2880*a4*b4*x2+1920*a6*b2*x3+36960*a2*b4*x4+15360*b4*x4*a-42720*b2*x4*a...
        +960*a6*b2*x4-1920*a6*b2*x+3840*a3*b4*x+13440*a3*b4*x4-1920*a2*b6*x3+11520*b6*x*a+...
        1440*a8*x2-960*b8*x+960*a8*x3+960*a8*x+240*a8*x4+1440*b8*x2-960*b8*x3+240*b8*x4+...
        5640*b2*x4+6920*a2*x4+3360*b6*x4+4640*a6*x4-9240*b4*x4-11800*a4*x4+3840*a7*x3-12960*a3*x4...
        +1920*a7*x4+768*a5*x4+10272*x4*a-3840*a7*x-60840*b2*x3+60840*a2*x3+4320*b6*x2...
        -8160*b6*x3+2400*b6*x+8160*a6*x3-2400*a6*x+1760*a6*x2+35760*b4*x3-35760*a4*x3...
        -5760*a3*x3+1920*a5*x3+384*a5*x2-1920*a5*x+5760*a3*x+23520*a2*b4*x-50400*a2*b4*x2...
        -5760*b2*x*a-42720*a4*b2*x2-17280*b4*x2*a-23520*a2*b4*x3-23520*a4*b2*x+23520*a4*b2*x3...
        -46080*a3*b2*x2-13440*b4*x3*a-11520*a3*x*b2+5760*b2*x3*a+11520*a3*x3*b2+13440*b4*x*a...
        +226080*b2*x2+223520*a2*x2-95320*a4*x2-100440*b4*x2-130560*a4*x+130560*b4*x+...
         16800*a3*x2-17184*x2*a-102960*x2+69600*b2*x2*a+66480*a2*b2*x2)/s4;
   mk6= -0.8409826423335537918871252e-10*(-915909120.0+21906432.0*a-336268800.0*a2*b2...
          -84962304.0*a*b2+114508800.0*a4*b2+123863040.0*a2*b4+7580160.0*a6*b2...
          -60721920.0*a4*b4+5773824.0*a2*b6+39094272.0*a3*b2-17095680.0*a3*b4...
          -47287296.0*a*b4+23030784.0*a5*b2+37094400.0*a*b6+80640.0*a9*b2+483840.0*a7*b4...
          -1128960.0*a5*b6+887040.0*a3*b8-241920.0*b10*a+8967168.0*a7*b2-22224384.0*a5*b4...
          -5483520.0*a3*b6+7822080.0*b8*a-24192.0*a10*b2+60480.0*a4*b8-80640.0*a6*b6...
          +60480.0*a8*b4-24192.0*a2*b10-4677120.0*a4*b6-1451520.0*a6*b4+2499840.0*a8*b2...
          +4112640.0*a2*b8+2200568832.0*a2+2197601280.0*b2-1393056000.0*a4...
          -1386862848.0*b4+7433216.0*a3+246048768.0*a6+242242560.0*b6...
          -5668992.0*a8-4765824.0*b8+15166464.0*a7-46169088.0*a5-403200.0*b10...
          -80640*a10+1743616.0*a9-80640.0*a11+4032*b12+4032*a12+8070015744.0*a2*x...
          -8070015744.0*b2*x-844036200.0*x4+421441272.0*a2*b2*x4-207696384.0*a5*b2*x4...
          +153127296.0*a5*x2*b2-96009984.0*a5*b2*x3-364109760.0*a4*b4*x4...
          -168860160.0*a2*b6*x4+1057222656.0*a3*b2*x4+80398080.0*b6*x3*a+...
          35400960.0*a3*b4*x3-93090816.0*a2*b6*x+334968480.0*a4*b2*x4-138700800.0*b6*x4*a...
          +158497920.0*a3*b4*x2+131830272.0*a5*x*b2+273137760.0*a4*b4*x2-142369920.0*a6*b2*x3...
          +361257120.0*a2*b4*x4+630435456.0*b4*x4*a-781892496.0*b2*x4*a-159570432.0*a6*b2*x4...
          +89220096.0*a6*b2*x-45642240.0*a3*b4*x-209825280.0*a3*b4*x4+150111360.0*a2*b6*x3...
          -124992000.0*b6*x*a-58803696.0*a8*x2+27869184.0*b8*x-60742080.0*a8*x3-28191744.0*a8*x...
          -26286624.0*a8*x4-61190640.0*b8*x2+61387200.0*b8*x3-24222240.0*b8*x4+1909973520.0*b2*x4...
          +1920005136.0*a2*x4+239349600.0*b6*x4+254477664.0*a6*x4-1232034300.0*b4*x4...
          -1254807036.0*a4*x4-19789056.0*a7*x3-298741296.0*a3*x4-32108544.0*a7*x4...
          +167481216.0*a5*x4+164637360.0*x4*a+38803968.0*a7*x-7559516160.0*b2*x3...
          +7559516160.0*a2*x3+1294151040.0*b6*x2-870135840.0*b6*x3-902748672.0*b6*x...
          +872716320.0*a6*x3+901458432.0*a6*x+1280877696.0*a6*x2+4661959680.0*b4*x3...
          -4663895040.0*a4*x3-95808384.0*a3*x3+123790464.0*a5*x3-102646656.0*a5*x2...
          -150054912.0*a5*x+108122112.0*a3*x-34030080.0*a2*b4*x-289296000.0*a2*b4*x2...
          +1935360.0*a2*b2*x3-108122112.0*b2*x*a-262120320.0*a4*b2*x2-452882304.0*b4*x2*a...
          -86194080.0*a2*b4*x3-967680.0*a2*b2*x+35320320.0*a4*b2*x+83613600.0*a4*b2*x3...
          -828124416.0*a3*b2*x2-329341824.0*b4*x3*a-223211520.0*a3*x*b2+95808384.0*b2*x3*a...
          +205551360.0*a3*x3*b2+373266432.0*b4*x*a+11648448000.0*b2*x2+11638980864.0*a2*x2...
          -7223920704.0*a4*x2-7244596800.0*b4*x2-5151057408.0*a4*x+5152025088.0*b4*x...
          +225087744.0*a3*x2-141827328.0*x2*a-4937526720.0*x2+658554624.0*b2*x2*a...
          -207833472.0*a2*b2*x2-29594880.0*a6*b4*x4-22659840.0*a6*b4*x3+12313728.0*b2*x5*a...
          -43924608.0*b4*x5*a+38707200.0*a7*b2*x5-35820288.0*a5*b2*x5+10241280.0*a3*b4*x5...
          -49029120.0*a3*b6*x5+3096576.0*a7*x2*b2+62576640.0*a3*b6*x2+25095168.0*a5*x*b4...
          -50190336.0*a5*b4*x3-38900736.0*a7*b2*x4+32901120.0*a7*b2*x-157764096.0*a5*b4*x4...
          +112218624.0*a5*b4*x2-110638080.0*a3*b6*x4-47093760.0*a3*b6*x+96122880.0*a3*b6*x3...
          -14353920.0*b8*x*a-11692800.0*b8*x2*a+33868800.0*b8*x3*a-5241600.0*b8*x4*a...
          +98501760.0*b6*x2*a+11188800.0*a8*b2*x5-10039680.0*a4*b6*x5-19514880.0*b8*x5*a...
          -1814400.0*a8*b2*x4-10039680.0*a4*b6*x+53149824.0*a6*b2*x5+120224160.0*a2*b4*x5...
          -9011520.0*a2*b8*x2+4656960.0*a8*b2*x-846720.0*a2*b8*x4-13124160.0*a2*b8*x5...
          +93804480.0*a2*b6*x2+11329920.0*a6*b4*x5-118933920.0*a4*b2*x5-6108480.0*a8*b2*x2...
          +25095168.0*a5*b4*x5-6592320.0*a2*b8*x+20079360.0*a4*b6*x3-967680.0*a2*b2*x5...
          +24071040.0*a4*b6*x2+4193280.0*a4*b4*x5+16974720.0*a6*b4*x2+4193280.0*a4*b4*x...
          +19716480.0*a2*b8*x3-15845760.0*a8*b2*x3+11329920.0*a6*b4*x+86450112.0*a6*b2*x2...
          -57020544.0*a2*b6*x5+17660160.0*a3*b2*x5-8386560.0*a4*b4*x3-34110720.0*a4*b6*x4...
          +44593920.0*b6*x5*a-2802240.0*a10*x2+1794240.0*a10*x5-2217600.0*a10*x3...
          -1060416.0*a10*x+766080.0*a10*x4+1705536.0*b10*x-2479680.0*b10*x2...
          +927360.0*b10*x3-1149120.0*b10*x5+1088640.0*b10*x4-109918620.0*b2*x5...
          +109918620.0*a2*x5+17628408.0*b4*x5-16660728.0*a4*x5+4741632.0*a9*x5...
          -19014912.0*a7*x5-12313728.0*a3*x5+26264448.0*a5*x5-2424576.0*a9*x2...
          -8193024.0*a9*x3+3451392.0*a9*x-1671936.0*a9*x4+22214016.0*a7*x2...
          +1382976.0*a8*x5-1705536.0*b8*x5+15392160.0*b6*x5-16682400.0*a6*x5...
          +1935360.0*a7*b4*x5-645120.0*a5*b6*x5-2257920.0*a3*b8*x5+26836992.0*a7*b2*x6...
          +564480.0*a9*b2*x6+67769856.0*a5*b4*x6+1451520.0*a7*b4*x6+1048320.0*a3*b8*x6...
          +68423040.0*a3*b4*x6+31538304.0*a5*b2*x6+53544960.0*a3*b6*x6+1774080.0*a5*b6*x6...
          -268192512.0*a3*b2*x6+1290240.0*a5*b6*x3-645120.0*a5*b6*x+483840.0*a7*x2*b4...
          -1370880.0*a3*b8*x2+967680.0*b10*x*a-1209600.0*b10*x2*a+1209600.0*b10*x4*a...
          -1532160.0*a9*x2*b2-1290240.0*a9*x3*b2-322560.0*a9*x*b2+887040.0*a9*x4*b2...
          -2419200.0*a7*b4*x4-3870720.0*a7*b4*x3+1935360.0*a7*b4*x-4677120.0*a5*b6*x4...
          +4032000.0*a5*b6*x2-564480.0*a3*b8*x4-1612800.0*a3*b8*x+3870720.0*a3*b8*x3...
          -71608320.0*a7*b2*x3+65540160.0*a6*b2*x6+5423040.0*a8*b2*x6+151693920.0*a4*b4*x6...
          +14071680.0*a6*b4*x6+5745600.0*a2*b8*x6-195824160.0*a2*b4*x6-187356960.0*a4*b2*x6...
          +241920.0*a6*b6*x2-241920.0*a6*b6*x4+80640.0*a6*b6*x6+120960.0*a8*b4*x5...
          -241920.0*a8*b4*x3+120960.0*a8*b4*x-60480.0*a8*b4*x4-60480.0*a8*b4*x2+60480.0*a8*b4*x6...
          -120960.0*a2*b10*x2+120960.0*a2*b10*x4+24192.0*a2*b10*x6+96768.0*a2*b10*x...
          -96768.0*a10*b2*x+120960.0*a10*b2*x4+24192.0*a10*b2*x6-120960.0*a10*b2*x2...
          -120960.0*a4*b8*x+241920.0*a4*b8*x3-120960.0*a4*b8*x5-60480.0*a4*b8*x2...
          -60480.0*a4*b8*x4+60480.0*a4*b8*x6+69281856.0*a2*b6*x6-96768.0*a2*b10*x5...
          +96768.0*a10*b2*x5+14716800.0*a4*b6*x6+122661000.0*a2*b2*x6+9112320.0*b8*x6*a...
          +3104640.0*b6*x6*a+241920.0*b10*x6*a+208300176.0*b2*x6*a-130265856.0*b4*x6*a...
          -967680.0*b10*x5*a+1612800.0*a9*b2*x5+2463615.0*x6+2352896.0*a9*x6...
          -5271936.0*a7*x6+80640.0*a11*x6+66220336.0*a3*x6-18665472.0*a5*x6+...
          322560.0*a11*x5-44716464.0*x6*a-403200.0*a11*x2-322560.0*a11*x+403200.0*a11*x4...
          +2627856.0*b8*x6+3208464.0*a8*x6-18250848.0*b6*x6-23911776.0*a6*x6+633024.0*a10*x6...
          +310464.0*b10*x6-24192.0*b12*x-80640.0*b12*x3+60480.0*b12*x2-24192.0*b12*x5...
          +60480.0*b12*x4+4032.0*b12*x6+24192.0*a12*x5+80640.0*a12*x3+24192.0*a12*x...
          +60480.0*a12*x4+4032.0*a12*x6+60480.0*a12*x2-16572276.0*b2*x6-20104308.0*a2*x6...
          +31880772.0*b4*x6+40170564.0*a4*x6)/s6;
  Mcoef=1.0+mk2*kappa2i+mk4*kappa4i+mk6*kappa6i;
  Ncoef=nk1*kappai+nk3*kappa3i+nk5*kappa5i;
  Wderi=-kappa*(sinchi*Mcoef+coschi*Ncoef);
  udth=Wderi*factord;
  jacws(ii)=1.0/(udth*udth);
  xc1=2*(sin(thetah))^2;
  xc2=1+jacn(ii);  
  facw=xc1^(a+0.5)*xc2^(b+0.5)/2^(a+b+1);  
  jacw(ii)=facw*jacws(ii);
end   
end
function [jacn1b,jacw1b,jacn2b,jacw2b]=besselNWGJ(n,a,b,nelem)
%----------------------------------------------------
%Bessel expansions to compute the nodes and weights
%of the GJ quadrature
%----------------------------------------------------
np=floor(n/2);
if mod(n,2)==0 
  nn1=np;
else
  nn1=np+1;  
end
nbess=floor((n-nelem)*0.5);
[jacn1b,jacw1b]=jacbessNW(a,b,n,nbess);
if a==b
  jacn2b=jacn1b;
  jacw2b=jacw1b;
else    
  [jacn2b,jacw2b]=jacbessNW(b,a,n,nbess);
end  
end
function [jacn,jacw]=jacbessNW(a,b,n,np)
%------------------------------------------------------------
%Computation of the nodes and weights of G-J quadrature
%using the asymptotic expansion in terms of Bessel functions
%------------------------------------------------------------
a2=a*a;
a3=a2*a;
a4=a2*a2;
a5=a4*a;
a6=a4*a2;
a7=a5*a2;
a8=a7*a;
a9=a8*a;
a10=a9*a;
a11=a10*a;
a12=a11*a;
a13=a12*a;
a14=a13*a;
b2=b*b;
b4=b2*b2;
b6=b4*b2;
b8=b6*b2;
b10=b8*b2;
b12=b10*b2;
b14=b12*b2;
%Coefficients theta small
%theta_1
AA0=(a2+3*b2-1)/12.0; 
AA1=(-3*a2-5*b2+2)/240.0; 
AA2=(5*a2+7*b2-3)/10080.0;
AA3=(-7*a2-9*b2+4)/725760.0; 
AA4=(9*a2+11*b2-5)/79833600.0; 
AA5=(-11*a2-13*b2+6)/12454041600.0;
AA6=(13*a2+15*b2-7)/2615348736000.0;
AA7=(15*a2-17*b2+8)/711374856192000.0;
AA8=(17*a2+19*b2-9)/243290200817664000.0;
AA9=(-19*a2-21*b2+10)/102181884343418880000.0;
%theta_2
theta02=1/5760*(23*a4+210*a2*b2+135*b4-70*a2-210*b2+47);
theta12=-1/725760*(1328*a4+10332*a2*b2+3780*b4-3565*a2-6363*b2+1517);
theta22=1/9676800*(3449*a4+23750*a2*b2+5985*b4-8396*a2-10820*b2+2730);
theta32=-1/1916006400*(75478*a4+481008*a2*b2+98010*b4-171689*a2-...
        186087*b2+48538);
theta42=1/10461394944000*(29483057*a4+180493950*a2*b2+33017985*b4-...
        64241218*a2-64425270*b2+16979435);
theta52=-1/6974263296000*(992780*a4+5967788*a2*b2+1037400*b4-...
        2105627*a2-2051597*b2+539433);
theta62= 1/51218989645824000*(275686283*a4+1645357410*a2*b2+...
          279435987*b4-574754512*a2-556070544*b2+145176284);
theta72= -1/40872753737367552000*(6486746654*a4+38634183672*a2*b2+...
          6493162410*b4-13372638379*a2-12957424053*b2+3356634812);
theta82= 1/999111758024540160000*(3755928439*a4+22370970050*a2*b2+...
          3742378871*b4-7684648938*a2-7477388622*b2+1923679555);
theta92= -1/6204484017332394393600000*(454035411976*a4+...
          2706490562100*a2*b2+451826248500*b4-924099043619*a2-...
          903259281525*b2+231067567375);
%theta_3
theta03= 1/2903040*(1493*a6+27909*a4*b2+51975*a2*b4+14175*b6-...
         9303*a4-87570*a2*b2-51975*b4+19887*a2+59661*b2-12077);
theta13=-1/58060800*(175*a8+2100*a6*b2+9450*a4*b4+18900*a2*b6+...
        14175*b8+140*a7+2940*a5*b2+13860*a3*b4+18900*a*b6+...
        22093*a6+386345*a4*b2+571095*a2*b4+33075*b6-840*a5-...
        8400*a3*b2-17640*a*b4-131922*a4-1048900*a2*b2-271530*b4+...
        1260*a3+5460*a*b2+244097*a2+350855*b2-560*a-73963);
theta23=1/7664025600*(16940*a8+175560*a6*b2+665280*a4*b4+...
        1081080*a2*b6+623700*b8+13904*a7+242352*a5*b2+990000*a3*b4+...
        1164240*a*b6+986915*a6+16557475*a4*b2+20860785*a2*b4-...
        218295*b6-71016*a5-616176*a3*b2-1120680*a*b4-5739231*a4-...
        40644098*a2*b2-5758335*b4+94776*a3+357192*a*b2+9605260*a2+...
        8577052*b2-37664*a-1893404);
theta33=-1/41845579776000*(30600570*a8+275194920*a6*b2+...
        884863980*a4*b4+1183782600*a2*b6+539188650*b8+25873848*a7+...
        375855480*a5*b2+1338016680*a3*b4+1378377000*a*b6+1113598804*a6+...
        18328359140*a4*b2+20965564620*a2*b4-224324100*b6-...
        113369256*a5-856936080*a3*b2-1368286920*a*b4-6392993692*a4-...
        42164034640*a2*b2-4903959060*b4+135459324*a3+449188740*a*b2+...
        10029117629*a2+7682826515*b2-48720672*a-1725918170);
theta43=1/251073478656000*(36476440*a8+287206920*a6*b2+...
        794593800*a4*b4+891891000*a2*b6+324324000*b8+31908656*a7+...
        389910768*a5*b2+1222013520*a3*b4+1122161040*a*b6+952204601*a6+...
        15636615753*a4*b2+16956039555*a2*b4+177972795*b6-...
        121409184*a5-805962144*a3*b2-1147124160*a*b4-5450096474*a4-...
        34547291304*a2*b2-4233976110*b4+131097564*a3+387526308*a*b2+...
        8217132804*a2+6445765848*b2-43218656*a-1437302791);
theta04= 1/1393459200*(107959*a8+3438660*a6*b2+12680010*a4*b4+...
        9922500*a2*b6+1488375*b8-1146220*a6-22278060*a4*b2-40011300*a2*b4-...
        9922500*b6+5095482*a4+49100940*a2*b2+27331290*b4-10087180*a2-30261540*b2...
        +6029959);
theta14= 1/91968307200*(3850*a11+57750*a9*b2+346500*a7*b4+...
        1039500*a5*b6+1559250*a3*b8+935550*a*b10-89320*a10-1589280*a8*b2-...
        10034640*a6*b4-28607040*a4*b6-36174600*a2*b8-14968800*b10-105754*a9-...
        2756952*a7*b2-18899100*a5*b4-43991640*a3*b6-27754650*a*b8-7092077*a8-...
        224707692*a6*b2-729805230*a4*b4-369271980*a2*b6+45997875*b8+...
        793980*a7+13358268*a5*b2+55113300*a3*b4+60166260*a*b6+76736250*a6+...
        1385103258*a4*b2+1938341790*a2*b4+64636110*b6-2235772*a5-...
        20976648*a3*b2-39411900*a*b4-321806576*a4-...
        2538904368*a2*b2-415134720*b4+2493370*a3+...
        10317582*a*b2+529604270*a2+505920162*b2-949674*a-103170147);
theta24= 1/502146957312000*(875875*a12+15765750*a10*b2+...
        118243125*a8*b4+472972500*a6*b6+1064188125*a4*b8+1277025750*a2*b10+...
        638512875*b12-21371350*a11-282732450*a9*b2-1469367900*a7*b4-...
        3727023300*a5*b6-4568914350*a3*b8-2128376250*a*b10+496145650*a10+...
        7998940950*a8*b2+44501757300*a6*b4+107980973100*a4*b6+109285025850*a2*b8+...
        30222942750*b10+593949356*a9+13678544880*a7*b2+84019015080*a5*b4+...
        171513342000*a3*b6+86553967500*a*b8+18169472479*a8+584496882060*a6*b2+...
        1743270779250*a4*b4+673764191100*a2*b6-122353256025*b8-4047871828*a7-...
        59839399620*a5*b2-215885009340*a3*b4-196197101100*a*b6-202752126658*a6-...
        3482148614490*a4*b2-4175409788550*a2*b4+43506713250*b6+10114063960*a5+...
        82924361520*a3*b2+132209957880*a*b4+816608815844*a4+5685703154040*a2*b2+...
        400501401300*b4-9971183222*a3-35442937530*a*b2-1196352411682*a2-...
        568361230710*b2+3332413084*a+120278049612);
%--------------------------------------------------
Yjk01= ((-1+2*a)*(a2-1+3*b2))/48;
Yjk11= (80*a+44*a2+60*b2-80*a3-5*a4-45*b4-21-30*a2*b2-240*a*b2)/5760.0;
Yjk21= (-448*a-255*a2-273*b2+448*a3+63*a4+315*b4+90+294*a2*b2+...
              1344*a*b2)/241920.0;
Yjk31= (3840*a+2170*a2+2310*b2-3840*a3-867*a4-2835*b4-688-...
               +3210*a2*b2-11520*a*b2)/29030400.0;
Yjk41= (-11264*a-6349*a2-6963*b2+11264*a3+3355*a4+8415*b4+...
              1920+10758*a2*b2+33792*a*b2)/1916006400.0;
Yjk51= (372736*a+211548*a2+236964*b2-372736*a3-132327*a4-279279*b4...
            -62208-387114*a2*b2-1118208*a*b2)/2092278988800.0;
Yjk61= (-81920*a-47081*a2-53271*b2+81920*a3+32781*a4+61425*b4+13568+...
            90114*a2*b2+245760*a*b2)/20922789888000.0;
Yjk71= (3342336*a+1949462*a2+2212074*b2-3342336*a3-1458311*a4-2506599*b4...
           -552960-3833874*a2*b2-10027008*a*b2)/51218989645824000.0;
Yjk81= (-24903680*a-14745165*a2-16712115*b2+24903680*a3+11600127*a4+18677475*b4+...
           4128768+29491230*a2*b2+74711040*a*b2)/29194824098119680000.0;
Yjk91=(80740352*a+48496288*a2+54788448*b2-80740352*a3-39583953*a4-60555033*b4...
          -13434880-98041878*a2*b2-242221056*a*b2)/8992005822220861440000;
      
Yjk02=((a+1)*(-1+2*a)*(5*a4+4*a3+30*a2*b2-14*a2-16*a+60*a*b2+21-90*b2+45*b4))/5760.0;
Yjk12= (-8554*a-7029*a2+945*b2+11410*a3+6621*a4+2205*b4-945*b6-2331*a6-2786*a5...
          -70*a7+28182*a2*b2+35238*a*b2-1890*b6*a-33852*a3*b2-14763*a4*b2-23625*a2*b4...
          -11970*a*b4-1890*a3*b4-630*a5*b2-141)/1935360.0;
Yjk22= (134559+1886208*a+1274528*a2-542160*b2-2494320*a3-1459134*a4-587790.0*b4...
           +378000*b6+525072*a6+576192*a5+175*a8+31920*a7+14175*b8-5549460*a2*b2...
          -7842960.0*a*b2+680400*b6*a+7320960*a3*b2+3471600*a4*b2+5670000*a2*b4...
          +2842560*a*b4+740880*a3*b4+267120*a5*b2+2100*a6*b2+18900*a2*b6+9450*a4*b4)...
          /1393459200.0;
Yjk32=(-127938.0-3781184.0*a-2246965.0*a2+250965*b2+4973364.0*a3...
          +2949428.0*a4+1873080.0*b4-977130*b6-1084930.0*a6-1093026.0*a5-1155.0*a8...
          -99154.0*a7-51975.0*b8+10589524.0*a2*b2+15800268.0*a*b2-1683990.0*b6*a...
          -14449644.0*a3*b2-7405046.0*a4*b2-12007710.0*a2*b4-5915250.0*a*b4-1992870.0*a3*b4...
          -774642.0*a5*b2-12320.0*a6*b2-83160.0*a2*b6-48510*a4*b4)/15328051200.0;
Yjk42= (-21852840.0+5059704832.0*a+2783266006.0*a2+717403050.0*b2...
           -6634318600.0*a3-4005860485.0*a4-3235357125.0*b4+1479728250.0*b6...
           +1503803054.0*a6+1393032368.0*a5+3338335.0*a8+181581400.0*a7...
           +89864775.0*b8-13963808950.0*a2*b2-21190423800.0*a*b2+2502700200.0*b6*a...
           +19098337440.0*a3*b2+10488042110.0*a4*b2+16636469850.0*a2*b4...
           +8048280240.0*a*b4+3198915720.0*a3*b4+1332971640.0*a5*b2+31691660.0*a6*b2...
           +164864700.0*a2*b6+109999890.0*a4*b4)/167382319104000.0;
Yjk52= (244819296.0-8051738112.0*a-4258274509.0*a2-2271178035.0*b2...
           +10539758304.0*a3+6500964657.0*a4+5894846685.0*b4-2507835330.0*b6...
           -2482378446.0*a6-2121017868.0*a5-9337328.0*a8-367002324.0*a7...
           -162162000.0*b8+22256443890.0*a2*b2+33746162976.0*a*b2-4208103900.0*b6*a...
           -30095291016.0*a3*b2-17545361814.0*a4*b2-27063584730.0*a2*b4-12878168940.0*a*b4...
           -5757782940.0*a3*b4-2552700852.0*a5*b2-79423344.0*a6*b2-330810480.0*a2*b6...
           -246486240.0*a4*b4)/3012881743872000.0;
Yjk62= (-34344195840.0+732396060672.0*a+382434981008.0*a2+269869906800.0*b2...
           -957842900000.0*a3-604792490548.0*a4-577354022100.0*b4+235639813500.0*b6...
           +233954526932.0*a6+185199420928.0*a5+1306926153.0*a8+40247418400.0*a7...
           +15747957225.0*b8-2041315285240.0*a2*b2-3069449157600.0*a*b2+394265944800.0*b6*a...
           +2715903767040.0*a3*b2+1665937429460.0*a4*b2+2496824487900.0*a2*b4+1171181168640.0*a*b4...
           +572054490720.0*a3*b4+267619758240.0*a5*b2+10083323900.0*a6*b2+34948122300.0*a2*b6...
           +28478720790.0*a4*b4)/4097519171665920000.0; 
Yjk03= ((2.0*a-1.0)*(a+2.0)*(a+1.0)*(35.0*a6+84.0*a5+315.0*a4*b2...
          -157.0*a4-516.0*a3+1512.0*a3*b2-126.0*a2*b2+77.0*a2+945.0*a2*b4...
           -8316.0*a*b2+3780.0*a*b4+1872.0*a-1395.0+945.0*b6+6615.0*b2-4725*b4))...
            /1451520.0;
Yjk13= (-(a+2)*(-340785.0-1107684.0*a-167548.0*a2+1557900.0*b2...
           +1987760.0*a3-118950.0*a4-670950.0*b4-18900.0*b6-133932.0*a6...
           -613176.0*a5+35455.0*a8+95280.0*a7+14175.0*b8+700.0*a9+1175340.0*a2*b2...
           +5130000.0*a*b2+378000.0*b6*a-8442960.0*a3*b2+426180.0*a4*b2-2906820.0*a2*b4...
           -3258360.0*a*b4+4127760.0*a3*b4+1619760.0*a5*b2+339780.0*a6*b2+1152900.0*a2*b6...
           +1082970.0*a4*b4+37800.0*a5*b4+56700.0*a*b8+75600.0*a3*b6+8400.0*a7*b2))...
           /696729600.0;
Yjk23= (-148633920.0-1429430688.0*a-1043370633.0*a2+1141687305.0*b2...
           +2707658818.0*a3+1379721218.0*a4-368027550.0*b4-135904230.0*b6...
           -715533522.0*a6-1597247628.0*a5+202346397.0*a8+468986412.0*a7...
           +38825325.0*b8-64862314.0*a9-36726305.0*a10+1403325.0*b10...
           -3938550.0*a11+2814367644.0*a2*b2+5980187070.0*a*b2+388980900.0*b6*a...
           -7901107368.0*a3*b2-3699431010.0*a4*b2-4372787430.0*a2*b4-3834287820.0*a*b4...
           +2719868580.0*a3*b4+1795141260.0*a5*b2+1178710236.0*a6*b2+1504738620.0*a2*b6...
           +3276346590.0*a4*b4+1559250.0*a3*b8+57750.0*a9*b2+37442790.0*a6*b4...
           +684967140.0*a5*b4+8513505.0*a8*b2+935550.0*a*b10+1039500.0*a5*b6...
           +114448950.0*a*b8+805238280.0*a3*b6+73409490.0*a4*b6+202703688.0*a7*b2...
           +346500.0*a7*b4+54729675.0*a2*b8)/735746457600.0;
Yjk33= (-136717079040.0+5364629892864.0*a+3250588950102.0*a2...
           -1098938827350.0*b2-12913042350096.0*a3-3663146945843.0*a4-582600093075.0*b4...
           +893258566200.0*b6+1463252457768.0*a6+9717201161136.0*a5-1711897418907.0*a8...
           -4621353897024.0*a7-177719416875.0*b8+229660310880.0*a9+159780961340.0*a10...
           -9705395700.0*b10+12158546400.0*a11-837161325.0*a12-42567525.0*b12...
           -8038176818490.0*a2*b2-19166828793840.0*a*b2-1152388036800.0*b6*a...
           +25464467901600.0*a3*b2+12153776380200.0*a4*b2+14234538197880.0*a2*b4...
           +12510995056560.0*a*b4-8706340843200.0*a3*b4-4851511479360.0*a5*b2...
           -3029769402660.0*a6*b2-5230345220100.0*a2*b6-10862605804050.0*a4*b4...
           -12259447200.0*a3*b8+18817999200.0*a9*b2-70945875.0*a4*b8-85135050.0*a2*b10...
           -7882875.0*a8*b4+1075224150.0*a10*b2-178094596680.0*a6*b4-2500630292160.0*a5*b4...
           +94600806300.0*a8*b2-6810804000.0*a*b10-8778369600.0*a5*b6-491740048800.0*a*b8...
           -2971759190400.0*a3*b6-339828489000.0*a4*b6-255279024000.0*a7*b2-3127924800.0*a7*b4...
           -31531500.0*a6*b6-247629482100.0*a2*b8)/8034351316992000.0;
Yjk43= (-7377082776576.0*a-1265734340474.0*a2-519272390790.0*b2...
           +20323148306736.0*a3-156275041363.0*a4+2080039996125.0*b4-1466148804120.0*b6...
           +2383626146640.0*a6-17041139378172.0*a5+4556591050538.0*a8+11657690566524.0*a7...
           +255344339250.0*b8+226624127028.0*a9-100161762701.0*a10+17614441845.0*b10...
           +4765580820.0*a11+2906258355.0*a12+127702575.0*b12+9515270232438.0*a2*b2...
           +23409360774864.0*a*b2+1241505244980.0*b6*a-31586888209896.0*a3*b2...
           -16430787661752.0*a4*b2-18022602648960.0*a2*b4-15356460073500.0*a*b4...
           +10587052263060.0*a3*b4+2990868710076.0*a5*b2+1206968652432.0*a6*b2...
           +6797848337280.0*a2*b6+13729744746900.0*a4*b4+24721596900.0*a3*b8...
           -68415246900.0*a9*b2+269594325.0*a4*b8+289459170.0*a2*b10+36261225.0*a8*b4...
           -3761707950.0*a10*b2+288203225310.0*a6*b4+3411095851800.0*a5*b4-441647669463.0*a8*b2...
           +12770257500.0*a*b10+18954575640.0*a5*b6+719261442900.0*a*b8+4030800293520.0*a3*b6...
           +532749467250.0*a4*b6-891836687664.0*a7*b2+7203236040.0*a7*b4+132432300.0*a6*b6...
           +376051650975.0*a2*b8+150956328960.0)/48206107901952000.0;
Yjk53= (2399235131068416.0*a-898671405563274.0*a2+429439560007050.0*b2...
           -7022278184706832.0*a3+2208104034208117.0*a4-864466689098475.0*b4+...
           522832693628700.0*b6-3053141585499180.0*a6+6203840550680256.0*a5...
           -2551977932952162.0*a8-6124535145573168.0*a7-85657377856050.0*b8...
           -393455171072192.0*a9-38810831286526.0*a10-6902980934850.0*b10...
           -12020974885920.0*a11-1636512552675.0*a12-62957369475.0*b12...
           -2945434768737930.0*a2*b2-7223560655232240.0*a*b2-333339024891600.0*b6*a...
           +10035561845794560.0*a3*b2+6112893056048820.0*a4*b2+5779866909419100.0*a2*b4...
           +4745022782644800.0*a*b4-3248436081736080.0*a3*b4+726186717709200.0*a5*b2...
           +919913642353080.0*a6*b2-2199784275397800.0*a2*b6-4376459769522300.0*a4*b4...
           -10582627255200.0*a3*b8+39861592811040.0*a9*b2-162545107725.0*a4*b8...
           -158168760750.0*a2*b10-26177676525.0*a8*b4+2133980298450.0*a10*b2...
           -110564183328300.0*a6*b4-1157105441836800.0*a5*b4+279648231523830.0*a8*b2...
           -5111021916000.0*a*b10-8651796753600.0*a5*b6-250218430862400.0*a*b8...
           -1347711068995200.0*a3*b6-197521879382100.0*a4*b6+847673587405440.0*a7*b2...
           -3495172000320.0*a7*b4-87618831300.0*a6*b6-134520428992950.0*a2*b8...
           +103734087229440.0)/98340460119982080000.0;
Zjk01= ((-1+2.0*a)*(5.0*a4+4.0*a3+30.0*a2*b2-14.0*a2+...
               60.0*a*b2-16.0*a+21-90*b2+45*b4))/5760.0;
Zjk11= (-5388.0*a+2713.0*a2+2835*b2+3912.0*a3-383.0*a4+...
          945*b4-945*b6-35.0*a6-1260.0*a5-639-11970.0*a2*b2+22680.0*a*b2...
          -7560.0*a3*b2-315.0*a4*b2-945.0*a2*b4-11340.0*a*b4)/1451520.0;
Zjk21= (17620.0*a-12801.0*a2-26775*b2-16244.0*a3+1779.0*a4+...
          2835.0*b4+4725*b6+315.0*a6+5446.0*a5+6180+51450.0*a2*b2...
          -75180.0*a*b2+32340.0*a3*b2+2415.0*a4*b2+5985.0*a2*b4+...
           45990.0*a*b4)/29030400.0;
Zjk31= (-75848.0*a+73060.0*a2+153780*b2+84624.0*a3-10827.0*a4...
          -27555*b4-24255*b6-2629.0*a6-29788.0*a5-36102-271282.0*a2*b2...
          +326832.0*a*b2-173448.0*a3*b2-17237.0*a4*b2-36135.0*a2*b4...
          -229020.0*a*b4)/1277337600.0;
Zjk41= (82273924.0*a-98566621.0*a2-189864675.0*b2-106205600.0*a3...
          +15976550.0*a4+40630590.0*b4+28828800.0*b6+4580576.0*a6+...
          39429676.0*a5+45469050.0+342642300.0*a2*b2-357477120.0*a*b2...
          +223783560.0*a3*b2+26186160.0*a4*b2+48288240.0*a2*b4+...
          275134860.0*a*b4)/20922789888000.0;
Zjk51= (-7910804.0*a+11195493.0*a2+19603935.0*b2+11411992.0*a3...
          -1975719.0*a4-4623255.0*b4-2927925.0*b6-621855.0*a6...
          -4464044.0*a5-4784133.0-37028082.0*a2*b2+34641672.0*a*b2...
          -24660168.0*a3*b2-3196167.0*a4*b2-5352165.0*a2*b4...
          -28517580.0*a*b4)/41845579776000.0;
Zjk61= (354073448.0*a-569172750.0*a2-918276930.0*b2-556599916.0*a3...
          +108013731.0*a4+230748939.0*b4+135958095.0*b6+35987793.0*a6...
          +228448142.0*a5+227641728.0+1816688850.0*a2*b2-1562318292.0*a*b2...
          +1229911716.0*a3*b2+170684301.0*a4*b2+265688019.0*a2*b4+1352137806.0*a*b4)...
            /51218989645824000.0;
Zjk71=(-81297768400.0*a+144230413490.0*a2+217838283390.0*b2+136765421504.0*a3...
          -29077826419.0*a4-57277856475.0*b4-32073585075.0*b6-10057277809.0*a6...
          -58586738716.0*a5-54662618220.0-449059439346.0*a2*b2+361360472256.0*a*b2...
          -308132209224.0*a3*b2-44872305681.0*a4*b2-66027926475.0*a2*b4-325020332700.0*a*b4)...
            /408727537373675520000.0;
Zjk81=(27707934380.0*a-53127697575.0*a2-76158100425.0*b2-49232027824.0*a3...
          +11264050398.0*a4+20720635782.0*b4+11166581580.0*b6+3998993460.0*a6...
          +21895165964.0*a5+19283907810.0+162580410300.0*a2*b2-124020730416.0*a*b2...
          +112790392968.0*a3*b2+17017559988.0*a4*b2+23959147212.0*a2*b4+114998523948.0*a*b4)...
              /5994670548147240960000.0;    
Zjk02= ((a+2.0)*(-1.0+2.0*a)*(35.0*a6+84.0*a5-157.0*a4+315.0*a4*b2+...
              1512.0*a3*b2-516.0*a3+945.0*a2*b4-126.0*a2*b2+77.0*a2+1872.0*a...
              -8316.0*a*b2+3780.0*a*b4+6615*b2-1395+945*b6-4725*b4))/1451520.0;
Zjk12= (483165+1356066.0*a-1012140.0*a2-2196900.0*b2-1175984.0*a3+329310.0*a4...
               +935550.0*b4+56700*b6+34980.0*a6+439484.0*a5-19635.0*a8-72016.0*a7-33075*b8...
               -350.0*a9+4320260.0*a2*b2-6407280.0*a*b2-831600*b6*a+4761000.0*a3*b2...
               -1045900.0*a4*b2-603540.0*a2*b4+4622940.0*a*b4-2766960.0*a3*b4...
               -1056720.0*a5*b2-184660.0*a6*b2-623700.0*a2*b6-581490.0*a4*b4-18900.0*a5*b4...
               -28350.0*a*b8-37800.0*a3*b6-4200.0*a7*b2)/464486400.0;
Zjk22= (-30517830.0-52017372.0*a+47902959.0*a2+151223985.0*b2+76555520.0*a3...
               -21588566.0*a4-76432950.0*b4+1101870.0*b6+4359146.0*a6-40094328.0*a5...
               -203929.0*a8+9461760.0*a7+2546775.0*b8-1014860.0*a9-131285.0*a10...
               +31185.0*b10-241451188.0*a2*b2+229686336.0*a*b2+43464960.0*b6*a...
               -216124304.0*a3*b2+54410554.0*a4*b2+45306030.0*a2*b4-197813880.0*a*b4...
               +137617920.0*a3*b4+53152000.0*a5*b2+10101652.0*a6*b2+34663860.0*a2*b6...
               +32184570.0*a4*b4+11550.0*a6*b4+1746360.0*a5*b4+1925.0*a8*b2+2286900.0*a*b8...
               +3270960.0*a3*b6+34650.0*a4*b6+412720.0*a7*b2+51975.0*a2*b8)/61312204800.0;
Zjk32=(53282797164.0*a-80765771957.0*a2-173678143275.0*b2-103454435816.0*a3...
               +59334179818.0*a4+91472431050.0*b4-1154503350.0*b6-23708200858.0*a6...
               +61972541676.0*a5+3839817982.0*a8-17815011864.0*a7-3755401650.0*b8...
               +3017094080.0*a9+358232875.0*a10-70945875.0*b10+312285684620.0*a2*b2...
               -223695927000.0*a*b2-55309854600.0*b6*a+250574582440.0*a3*b2...
               -69840366050.0*a4*b2-66481164750.0*a2*b4+222163201260.0*a*b4...
               -171489918600.0*a3*b4-67509642200.0*a5*b2-13802308520.0*a6*b2...
               -45781936200.0*a2*b6-43540196700.0*a4*b4-38888850.0*a6*b4-3054411360.0*a5*b4...
               -7182175.0*a8*b2-3481077600.0*a*b8-5354949600.0*a3*b6-104053950.0*a4*b6...
               -767006240.0*a7*b2-137162025.0*a2*b8+37588714110.0)/334764638208000.0;
Zjk42= (-34737116490.0-40396499316.0*a+100848946107.0*a2+140991548805.0*b2...
               +85530666984.0*a3-91822679927.0*a4-76065710175.0*b4+227161935.0*b6...
               +42929591333.0*a6-53825500412.0*a5-8289608938.0*a8+18732090976.0*a7...
               +3768915150.0*b8-4533561032.0*a9-506315810.0*a10+85135050.0*b10...
               -294126243690.0*a2*b2+174512013336.0*a*b2+52010038080.0*b6*a...
               -221927146472.0*a3*b2+66804154757.0*a4*b2+67517020935.0*a2*b4...
               -192702591900.0*a*b4+160633680480.0*a3*b4+64768617472.0*a5*b2...
               +14104262432.0*a6*b2+44136172080.0*a2*b6+43512831180.0*a4*b4+...
               65405340.0*a6*b4+3587023440.0*a5*b4+13343330.0*a8*b2+3572969400.0*a*b8...
               +5896931040.0*a3*b6+157297140.0*a4*b6+955034080.0*a7*b2+185134950.0*a2*b8)...
               /2008587829248000.0;
Zjk52= (7287546549420.0*a-28205808799305.0*a2-28746893402775.0*b2-14478935341152.0*a3...
              +28545906940460.0*a4+15797123055900.0*b4+95776317000.0*b6-14618177209400.0*a6...
              +8866771812408.0*a5+3185897654035.0*a8-4032345979848.0*a7-900252478125.0*b8...
              +1436600330022.0*a9+153012184325.0*a10-22226329125.0*b10+68170358780920.0*a2*b2...
              -35524617291360.0*a*b2-12071221507800.0*b6*a+49624740192080.0*a3*b2...
              -15844918544680.0*a4*b2-16494805810920.0*a2*b4+42341811699960.0*a*b4...
              -37497758578200.0*a3*b4-15522109850440.0*a5*b2-3568087331020.0*a6*b2...
              -10428651405900.0*a2*b6-10699388259150.0*a4*b4-22765172430.0*a6*b4...
              -987322375260.0*a5*b4-5098037945.0*a8*b2-867619402650.0*a*b8-1527879389400.0*a3*b6...
              -49751752050.0*a4*b6-277762939480.0*a7*b2-53170892775.0*a2*b8+8025850403550.0)...
              /4097519171665920000.0;  
Zjk03= ((-1+2.0*a)*(a+3)*(a+2)*(120015.0-209184.0*a+68924.0*a2-585900.0*b2...
         +34440.0*a3-7110.0*a4+463050.0*b4-132300.0*b6-564.0*a6...
         -7536.0*a5+175.0*a8+840.0*a7+14175*b8-308580.0*a2*b2+988920.0*a*b2...
         +113400.0*b6*a-142560.0*a3*b2+28380.0*a4*b2+94500.0*a2*b4...
         -650160.0*a*b4+83160.0*a3*b4+17640.0*a5*b2+2100.0*a6*b2+18900.0*a2*b6...
         +9450.0*a4*b4))/348364800.0;
Zjk13= ((a+3.0)*(-100555560.0-75521604.0*a+295399693.0*a2+371236635.0*b2...
        -43905748.0*a3-330638106.0*a4-230665050.0*b4+36528030.0*b6+175117962.0*a6...
        +188783088.0*a5-59349169.0*a8-120350232.0*a7+467775.0*b8+23756656.0*a9...
        +13683285.0*a10-280665.0*b10+1575420.0*a11-712128780.0*a2*b2...
        +454059540.0*a*b2+130810680.0*b6*a-300131040.0*a3*b2+327312810.0*a4*b2...
        +383922990.0*a2*b4-410121360.0*a*b4+316487160.0*a3*b4+67617000.0*a5*b2...
        -31864140.0*a6*b2-16673580.0*a2*b6-126376470.0*a4*b4-623700.0*a3*b8...
        -23100.0*a9*b2-6923070.0*a6*b4-60904800.0*a5*b4-1458765.0*a8*b2-374220.0*a*b10...
        -415800.0*a5*b6-12474000.0*a*b8-88482240.0*a3*b6-14615370.0*a4*b6-12957120.0*a7*b2...
        -138600.0*a7*b4-11694375.0*a2*b8))/91968307200.0;
Zjk23= (289704725568.0*a-8795832423300.0*a2-7946000653500.0*b2+4608403126564.0*a3...
         +10654420907219.0*a4+5243465702475.0*b4-955077423300.0*b6-5890189748796.0*a6...
         -6809064317262.0*a5+7304418486771.0*a8+6882238481376.0*a7-3691212525.0*b8...
         +2354747855954.0*a9+303085531606.0*a10+10641881250.0*b10+32879623920.0*a11...
         +9947662725.0*a12+139864725.0*b12+1195944750.0*a13+60810750.0*a*b12...
         +45045000.0*a7*b6-1536034500.0*a11*b2+11261250.0*a9*b4+101351250.0*a5*b8...
         +121621500.0*a3*b10+12477216633570.0*a2*b2-7509472666020.0*a*b2...
         -2683200405600.0*b6*a+8666914561500.0*a3*b2-6361472970060.0*a4*b2...
         -6180312764340.0*a2*b4+7522180006770.0*a*b4-8416463758560.0*a3*b4...
         -6532971138720.0*a5*b2-3690016675020.0*a6*b2-330177919500.0*a2*b6...
         +579605533650.0*a4*b4+117502585200.0*a3*b8-246082568160.0*a9*b2...
         +8292559275.0*a4*b8+4998643650.0*a2*b10+1903376475.0*a8*b4-30888407550.0*a10*b2...
         +584069969340.0*a6*b4+2104986749580.0*a5*b4-999743363190.0*a8*b2...
         +16540524000.0*a*b10+132402441600.0*a5*b6+271171350450.0*a*b8...
         +1950475527000.0*a3*b6+955213845300.0*a4*b6-2284475380200.0*a7*b2...
         +59709180960.0*a7*b4+5606300700.0*a6*b6+364373959950.0*a2*b8+2698669249920.0)...
          /1147764473856000.0;
Zjk33=(-64766368800000.0+29673424080000.0*a+256213624726800.0*a2+159079692789360.0*b2...
        -164712374327792.0*a3+31922624309272.0*a4-115748344693800.0*b4+22295652163785.0*b6...
         +737262871684647.0*a6+883844805942700.0*a5-147698752196337.0*a8+65461894569504.0*a7...
         +647835162975.0*b8-73492259805940.0*a9-17943778638097.0*a10-391714878555.0*b10...
         -3594318960232.0*a11-581509463535.0*a12-8300667375.0*b12+1033557525.0*a14+...
         1612836225.0*a10*b4-7882875.0*a8*b6-23648625.0*a6*b8-38131673580.0*a13...
         -42567525.0*a4*b10-42567525.0*a2*b12-3916212300.0*a*b12-3506302800.0*a7*b6...
         +17090073000.0*a11*b2+44276532300.0*a9*b4-7435127700.0*a5*b8-8377288920.0*a3*b10...
         -2511483975.0*a12*b2-673694029929456.0*a2*b2+45624373395696.0*a*b2...
         +72174280258080.0*b6*a-772909388975064.0*a3*b2-435291054226821.0*a4*b2...
         +242107953972885.0*a2*b4-155169255002580.0*a*b4+304991840855520.0*a3*b4...
         -230687238936096.0*a5*b2-45872986569804.0*a6*b2+6839739646740.0*a2*b6+49544359259850.0*a4*b4...
         -3902282584200.0*a3*b8+8339622531240.0*a9*b2-341893577025.0*a4*b8-202331959830.0*a2*b10...
         +455972291775.0*a8*b4+915014670570.0*a10*b2-2738671946010.0*a6*b4-21052884336120.0*a5*b4...
         +31898718798921.0*a8*b2-614538844920.0*a*b10-4382386248240.0*a5*b6-7921524510900.0*a*b8...
         -56106814523760.0*a3*b6-28528969218750.0*a4*b6+44423237612304.0*a7*b2+1610073344880.0*a7*b4...
         -236951294580.0*a6*b6-11206755685125.0*a2*b8-18243225.0*b14)/96412215803904000.0;
 Zjk43=(-12387362574770496.0*a-56663885273740308.0*a2-18353929987593900.0*b2...
          -3315962794975532.0*a3-213975464845167853.0*a4+19343011061803275.0*b4...
          -4244324262243975.0*b6-495639592499398377.0*a6-552287517842041986.0*a5...
          -44111292204646002.0*a8-211388186113444824.0*a7-266820775070850.0*b8...
          -2684720461708288.0*a9+1250515371114115.0*a10+107305719045525.0*b10...
          +557815162426236.0*a11+95360032642875.0*a12+2893868052075.0*b12-695264845275.0*a14...
          -1096326606375.0*a10*b4+6834452625.0*a8*b6+18895251375.0*a6*b8+2077574048550.0*a13...
          +31116860775.0*a4*b10+28222269075.0*a2*b12+1445848554150.0*a*b12+1555820065800.0*a7*b6...
          +19312455462300.0*a11*b2-30805768743750.0*a9*b4+3113822561850.0*a5*b8+3300248051100.0*a3*b10...
          +1695667898925.0*a12*b2+348250837656391650.0*a2*b2+61224438312735660.0*a*b2...
          -16736301192429000.0*b6*a+506593468691646660.0*a3*b2+462978049748954955.0*a4*b2...
          -91445805695959515.0*a2*b4+18808664578876350.0*a*b4-115501069910475720.0*a3*b4...
          +311194353006443880.0*a5*b2+130216800670765560.0*a6*b2-1404796635988200.0*a2*b6...
          -48604668386412060.0*a4*b4+1050794541096300.0*a3*b8-443608651163340.0*a9*b2+...
           105820012423125.0*a4*b8+60799037849550.0*a2*b10-352283044428315.0*a8*b4...
          +11749188040590.0*a10*b2-6450525097847010.0*a6*b4-15064716305628000.0*a5*b4...
          +905700365322345.0*a8*b2+173689974958500.0*a*b10+1194477491025000.0*a5*b6...
          +1925337944930400.0*a*b8+13696129448820000.0*a3*b6+7193026009055250.0*a4*b6...
          +26917748719043040.0*a7*b2-2038861946071080.0*a7*b4+75660905420100.0*a6*b6...
          +2858297528861775.0*a2*b8+10854718875.0*b14+11013114933394560.0)/98340460119982080000.0;
 %McMahons Asymptotic Expansions for Large Zeros
 mu=4.0*a2;
 mu2=mu*mu;
 mu3=mu2*mu;
 cmac1=(1.0-mu)/8.0;
 cmac2=-4.0*(mu-1.0)*(7.0*mu-31.0)/1536.0;
 cmac3=-32.0*(mu-1.0)*(83.0*mu2-982.0*mu+3779.0)...
       /491520.0;
 cmac4=-64.0*(mu-1.0)*(6949.0*mu3-153855.0*mu2+...
         1585743.0*mu-6277237.0)/220200960.0;    
 kappa=n+0.5*(a+b+1.0); 
 kappa2=kappa*kappa;
 kappa4=kappa2*kappa2;    
 kappa6=kappa4*kappa2;
 kappa8=kappa6*kappa2;
 % M factor for the weights
 apbp1=a+b+1.0;
 FF1=qasymN(n+1.0,a);
 FF2=1/qasymN(n+b+1.0,a);
 factorg1=FF1*FF2;
 Mfactor=2.0^apbp1*factorg1;
 factorg2=FF1; 
 factord=factorg2*(1.0/(kappa^a*sqrt(Mfactor)*sqrt(2.0)));
 factord2=factord*factord;
 %Calculation of approximatelly the first 40+10*a zeros of the Bessel function J_a(z)
 bb=(40+10.5*a-0.25)*pi;
 [jk,num,ierr]=besjz(1e-10,bb,a); 
 iorder=0;   
 if (jk(num)<jk(num-1))
    iorder=1;
 end
 for i=1:np
    % We obtain approximations to the positive zeros in decreasing order 
    if (i>num) 
      am=(i+0.5*a-0.25)*pi;
      ami=1.0/am;
      ami2=ami*ami;
      ami3=ami*ami2;
      ami5=ami2*ami3;
      ami7=ami5*ami2;
      j1= am+cmac1*ami+cmac2*ami3+cmac3*ami5+cmac4*ami7;
    else
      if (iorder==0) 
        j1=jk(i);
      else
        j1=jk(num-i+1);
      end
    end
    % Order 0 approximation
    j1z=j1;
    t=j1z/kappa;  
    t2=t*t;
    t3=t2*t;
    % Order 1 approximation
    c=cos(t);
    c2=c*c;
    c3=c2*c;
    s=sin(t);
    s2=s*s;
    s3=s2*s;
    if abs(t)<0.5
      t4=t3*t;
      t5=t4*t;
      t6=t5*t;
      t8=t6*t2;
      t10=t8*t2;
      t12=t10*t2;
      t14=t12*t2;
      t16=t14*t2;
      t18=t16*t2;
      chi=t/s; 
      chi2=chi*chi;
      chi3=chi2*chi;
      chi5=chi2*chi3;
      chi6=chi3*chi3;
      chi7=chi5*chi2;
      Ak1=chi*t*0.5*(AA0+AA1*t2+AA2*t4+AA3*t6+AA4*t8+...
           AA5*t10+AA6*t12+AA7*t14+AA8*t16+AA9*t18); 
      thet1=Ak1/kappa2;
      thet2=chi3*t*(theta02+theta12*t2+theta22*t4+theta32*t6+theta42*t8+...
           theta52*t10+theta62*t12+theta72*t14+theta82*t16+theta92*t18)/kappa4;
      thet3=chi5*t*(theta03+theta13*t2+theta23*t4+theta33*t6+theta43*t8)/kappa6;
      thet4=chi7*t*(theta04+theta14*t2+theta24*t4)/kappa8;
      theta=t+thet1+thet2+thet3+thet4;
      h=thet1+thet2+thet3+thet4;
    else  
      Ak1=-(1.0/8.0)*(-t*c+2.0*a2*t*c+2.0*c*t*b2+s-2.0*t*b2-4.0*a2*s...
         +2.0*a2*t)/(s*t);
      Tk0=Ak1;
      Tk02=Tk0*Tk0;
      Tk03=Tk02*Tk0;
      Tkd10= (1.0/8.0)*(2.0*t2*b2-t2+2.0*t2*a2-4.0*a2+1.0-2.0*c*t2*b2...
           +2.0*c*t2*a2+4.0*c2*a2-c2)/(s2*t2);   
      Tk1= (1.0/3072.0)*(225.0*s+16.0*a*c3*t3-58.0*a2*c3*t3...
         -48.0*a3*c3*t3+20.0*a4*c3*t3+32.0*a5*c3*t3...
         -240.0*t*a2*b2*c2+96.0*a4*t*b2*c2+240.0*t*a2*b2*c3...
         -240.0*t*a2*b2*c-96.0*a4*t*b2*c3+96.0*a4*t*b2*c...
         +96.0*a6*t+168.0*t2*a2*b2*s-48.0*t2*a*b2*s...
         +12.0*t2*b4*s*c2-12.0*t2*b2*s*c2+192.0*t2*a3*b2*s...
         +96.0*a4*t2*b2*s-48.0*a2*t2*b4*s+80.0*t3*a*b2*c...
         -80.0*t3*a*b2*c3-168.0*t3*a2*b2*c+168.0*t3*a2*b2*c3...
         -128.0*t3*a3*b2*c+128.0*t3*a3*b2*c3-96.0*t3*b4*a*c...
         +96.0*t3*b4*a*c3-24.0*t3*a4*b2*c+24.0*t3*a4*b2*c3...
         -24.0*t3*b4*a2*c+24.0*t3*b4*a2*c3+32.0*t3*a*b2*c2...
         +64.0*t3*a3*b2*c2-96.0*t3*b4*a*c2+24.0*t3*a4*b2*c2...
         -24.0*t3*b4*a2*c2-96.0*a6*t2*s*c-60.0*t2*a2*s*c+...
         264.0*a4*t2*s*c-24.0*t2*b4*s*c+60.0*t2*b2*s*c+8.0*b6*c3*t3...
         +24.0*b6*c*t3-64.0*a6*s-48.0*a6*t2*s+64.0*a5*t2*s...
         -144.0*t2*a2*s+204.0*a4*t2*s+12.0*t2*b4*s-48.0*t2*b2*s...
         +16.0*t2*a*s-80.0*a3*t2*s-300.0*a4*t3*c-300.0*t3*b4*c...
         +20.0*t3*b4*c3+576.0*t3*b2*c-58.0*t3*b2*c3+24.0*a6*t3*c...
         +576.0*a2*t3*c+48.0*t3*a3*c-16.0*t3*a*c-32.0*t3*a5*c...
         -120.0*a4*t3*c2+120.0*t3*b4*c2-246.0*t3*b2*c2...
         -24.0*t3*b6*c2+24.0*a6*t3*c2+246.0*a2*t3*c2...
         -32.0*t3*a3*c2+32.0*t3*a5*c2+240.0*t*a2*b2...
         +1036.0*s*c2*a2-560.0*a4*c2*s+72.0*t2*a2*b2*s*c2...
         +48.0*t2*a*b2*s*c2-192.0*t2*a3*b2*s*c2...
         -96.0*a4*t2*b2*s*c2-48.0*a2*t2*b4*s*c2...
         -240.0*t2*a2*b2*s*c+96.0*a2*t2*b4*s*c...
         +174.0*a2*c*t-54.0*a2*c2*t+54.0*t*b2*c2+54.0*c*t*b2...
         +3.0*s*c2*t2+54.0*a2*t-54.0*t*b2+27.0*c3*t...
         +24.0*s*t2-225.0*s*c2-240.0*a4*t-96.0*a4*t*b2...
         +64.0*a6*s*c2-27.0*c*t-174.0*c3*t*a2-288.0*a4*c*t...
         +240.0*a4*c2*t+288.0*a4*c3*t+96.0*a6*c*t-96.0*a6*c2*t...
         -96.0*a6*c3*t-54.0*t*b2*c3+80.0*a3*s*c2*t2...
         -16.0*s*a*c2*t2-24.0*a2*s*c2*t2+60.0*a4*s*c2*t2...
         -64.0*a5*s*c2*t2-48.0*a6*s*c2*t2-1036.0*a2*s...
         +15.0*c3*t3-240.0*t3*c+8.0*a6*c3*t3-160.0*a4*t3...
         +160.0*t3*b4-272.0*t3*b2-8.0*t3*b6+8.0*a6*t3...
         -32.0*t3*a*b2-64.0*t3*a3*b2+96.0*t3*b4*a...
         -24.0*t3*a4*b2+24.0*t3*b4*a2+272.0*a2*t3...
         +32.0*t3*a3-32.0*t3*a5+560.0*a4*s)/(s3*t3); 
      Ak2=(1.0/384.0)*(-45.0-48*a+24.0*t2+48.0*a4+192.0*a3+...
          168.0*a2-48.0*t2*b2*a+12.0*t2*b4...
         -48.0*t2*b2-24.0*t2*a2*b2+12.0*a4*t2-48.0*a2*t2+16.0*a*t2-16.0*a3*t2+...
         45.0*c2-12.0*t2*c2*b2+36.0*t*b2*s-48.0*a4*s*t-36.0*a2*s*t...
         -96.0*a3*s*t-16.0*a*t2*c2+60.0*t2*c*b2-60.0*a2*t2*c+24.0*a4*t2*c...
         -12.0*a2*t2*c2+12.0*a4*t2*c2+18.0*s*t*c-24.0*c*b4*t2+...
         12.0*c2*t2*b4+16.0*a3*t2*c2+48.0*t*b2*a2*s+96.0*t*b2*a*s...
         +48.0*a*s*t*c-36.0*c*t*b2*s-12.0*a2*s*t*c-96.0*a3*s*t*c...
         -48.0*a4*s*t*c+48.0*t2*b2*a*c2+24.0*t2*b2*a2*c2...
         -48.0*a4*c2-168.0*a2*c2+3.0*t2*c2-192.0*a3*c2+48.0*a*c2...
         -48.0*b2*a2*t*c*s-96.0*b2*a*t*c*s)/(s2*t2);
      Sk1=-Ak2;
      thet1=Ak1/kappa2;
      thet2=(-(1.0/6.0)*(6*Tk02*a+6*t*Tk0*Sk1-6.0*t*Tk1+3.0*Tk02+...
         2.0*t*Tk03-6.0*t*Tk0*Tkd10)/t)/kappa4;  
      theta=t+thet1+thet2;
      h=thet1+thet2;
    end
    jacn(np-i+1)=cos(theta);
    %----------
    % Weights
    %---------
    t=theta; 
    t2=t*t;
    t3=t2*t;
    t4=t3*t;
    t5=t4*t;
    t6=t5*t;
    t8=t6*t2;
    t10=t8*t2;
    t12=t10*t2;
    t14=t12*t2;
    t16=t14*t2;
    t18=t16*t2;
    s=sin(theta);
    s2=s*s;
    s3=s2*s;
    s4=s3*s;
    s5=s4*s;
    x=jacn(np-i+1);
    x2=x*x;
    x3=x2*x;
    x4=x3*x;
    x5=x4*x;
    Yk0=1.0;
    if (abs(theta)<0.4) 
      chi=t/s; 
      chi2=chi*chi;
      chi3=chi2*chi;
      chi4=chi3*chi;
      chi5=chi2*chi3;
      Zk0=2*a+1.0+t2*chi*(AA0+AA1*t2+AA2*t4+AA3*t6+AA4*t8+...
         AA5*t10+AA6*t12+AA7*t14+AA8*t16+AA9*t18); 
      Zk1=t2*chi3*(Zjk01+Zjk11*t2+Zjk21*t4+Zjk31*t6+...
           Zjk41*t8+Zjk51*t10+Zjk61*t12+Zjk71*t14+...
           Zjk81*t16); 
      Zk2=t2*chi5*(Zjk02+Zjk12*t2+Zjk22*t4+Zjk32*t6+...
            Zjk42*t8+Zjk52*t10);
      Zk3=t2*chi7*(Zjk03+Zjk13*t2+Zjk23*t4+Zjk33*t6+Zjk43*t8);
      Yk1=chi2*(Yjk01+Yjk11*t2+Yjk21*t4+Yjk31*t6+...
            Yjk41*t8+Yjk51*t10+Yjk61*t12+Yjk71*t14+...
            Yjk81*t16+Yjk91*t18);
      Yk2=chi4*(Yjk02+Yjk12*t2+Yjk22*t4+Yjk32*t6+...
            Yjk42*t8+Yjk52*t10+Yjk62*t12); 
      Yk3=chi6*(Yjk03+Yjk13*t2+Yjk23*t4+Yjk33*t6+Yjk43*t8+...
            Yjk53*t10); 
      Ycoef=Yk0+Yk1/kappa2+Yk2/kappa4+Yk3/kappa6;
      Zcoef=Zk0+Zk1/kappa2+Zk2/kappa4+Zk3/kappa6;
    else
      Zk0=-0.25*(-8.0*a*s-3.0*s+2.0*a2*x*t+2.0*x*t*b2-x*t...
          +2.0*a2*t-4.0*a2*s-2.0*t*b2)/s;
      Yk1=-0.00260416666666666666666666666667*(27.0-24.0*t2-120.0*a2+...
           16.0*t2*a-16.0*a3*t2+12.0*a4*t2+48.0*t2*a2+12.0*t2*b4...
           +48.0*t2*b2-24.0*t2*a2*b2-48.0*t2*a*b2+48.0*a4-27.0*x2...
           -48.0*a4*x2+3.0*x2*t2+120.0*a2*x2+48.0*t*a2*b2*s+24.0*t2*a2*b2*x2...
           +48.0*t2*a*b2*x2+12.0*t*b2*s*x-48.0*a4*s*x*t+36.0*a2*s*x*t...
           -48.0*t*a2*b2*s*x-24.0*b4*x*t2-12.0*t*b2*s-48.0*t*a4*s+...
           12.0*a2*t*s+12.0*t2*b4*x2-12.0*t2*b2*x2+24.0*a4*t2*x...
           -36.0*t2*b2*x+36.0*t2*a2*x+12.0*a4*x2*t2-6.0*s*x*t...
           -16.0*a*x2*t2-12.0*a2*x2*t2+16.0*a3*x2*t2)/(t2*s2);
      Zk1=(1.0/1536.0)*(-8.0*t3*b6-32.0*t3*b4+208.0*t3*b2...
           -208.0*a2*t3+32.0*a4*t3+8.0*a6*t3+32.0*t3*a3-32.0*t3*a5...
           +96.0*t3*a*b4+24.0*t3*a2*b4-24.0*t3*a4*b2-64.0*t3*a3*b2...
           -32.0*t3*a*b2+384.0*t*a5+96.0*a6*t-96.0*a4*t*b2-384.0*t*a3*b2...
           -336.0*t*a2*b2+336.0*t*a4-90.0*a2*t+90.0*t*b2-96.0*a3*t...
           +96.0*a*t*b2+96.0*a2*t2*b4*s*x+144.0*t2*a2*b2*s*x-96.0*a4*t2*b2*s*x2...
           -384.0*t2*a3*b2*s*x2-48.0*a2*t2*b4*s*x2-408.0*t2*a2*b2*s*x2...
           -48.0*t2*a*b2*s*x2-96.0*t*a*b2*x2+288.0*t2*a*b2*x*s+...
           384.0*t*a3*b2*x2+96.0*t*a*b2*x3+384.0*t*a3*b2*x-384.0*t*a3*b2*x3...
           -96.0*s*a*t2*b4*x2+192.0*s*a*b4*x*t2-192.0*s*a5*t2*x...
           -96.0*s*a*t2*b4-315.0*s-384.0*s*a5-400.0*s*a4+192.0*t3*x...
           +15.0*x3*t3+315.0*s*x2-45.0*x3*t+72.0*s*t2-64.0*a6*s+...
           45.0*x*t+1364.0*a2*s-216.0*a*s-288.0*a3*x*t2*s-36.0*t2*b4*s*x2...
           +36.0*t2*b2*s*x2+264.0*t2*a2*b2*s-240.0*t2*a*b2*s+96.0*t3*a*b4*x3...
           +24.0*t3*a2*b4*x3+24.0*t3*a4*b2*x3+128.0*t3*a3*b2*x3+168.0*t3*a2*b2*x3...
           -80.0*t3*a*b2*x3-96.0*a*t*b2*x+96.0*a3*x2*t-48.0*a6*s*x2*t2...
           -160.0*a5*s*x2*t2-116.0*s*a4*x2*t2+24.0*s*a*x2*t2+...
           152.0*a2*s*x2*t2+112.0*a3*s*x2*t2+96.0*a4*t*b2*x2...
           +336.0*t*a2*b2*x2-96.0*a4*t*b2*x3+96.0*a4*t*b2*x...
           -336.0*t*a2*b2*x3+336.0*t*a2*b2*x-96.0*a6*t2*s*x-216.0*a4*t2*s*x...
           -108.0*t2*a2*s*x+72.0*t2*b4*s*x+108.0*t2*b2*s*x-96.0*t3*a*b4*x2...
           -24.0*t3*a2*b4*x2+24.0*t3*a4*b2*x2+64.0*t3*a3*b2*x2+32.0*t3*a*b2*x2...
           -96.0*t3*a*b4*x-24.0*t3*a2*b4*x-24.0*t3*a4*b2*x-128.0*t3*a3*b2*x...
           -168.0*t3*a2*b2*x+80.0*t3*a*b2*x+96.0*a4*t2*b2*s+384.0*t2*a3*b2*s...
           -48.0*a2*t2*b4*s-384.0*a5*x2*t-384.0*a5*x3*t+258.0*x3*t*a2...
           +90.0*t*b2*x3+96.0*a6*x*t-96.0*a6*x2*t-96.0*a6*x3*t...
           +288.0*a4*x*t-336.0*a4*x2*t-288.0*a4*x3*t+20.0*a4*x3*t3...
           +32.0*a5*x3*t3+8.0*a6*x3*t3+16.0*a*x3*t3-58.0*a2*x3*t3...
           -48.0*a3*x3*t3-1364.0*s*x2*a2+400.0*a4*s*x2-9.0*s*x2*t2...
           -90.0*t*b2*x2+90.0*a2*x2*t+8.0*b6*x3*t3+24.0*b6*x*t3-234.0*a2*t3*x2...
           +72.0*a4*t3*x2+24.0*a6*t3*x2-32.0*t3*a3*x2+32.0*t3*a5*x2+84.0*t3*b4*x...
           -384.0*t3*b2*x-384.0*a2*t3*x+84.0*a4*t3*x+24.0*a6*t3*x+...
           48.0*t3*a3*x-32.0*t3*a5*x-16.0*t3*a*x-24.0*t3*b6*x2...
           -72.0*t3*b4*x2+234.0*t3*b2*x2-48.0*a6*t2*s-32.0*a5*t2*s...
           +144.0*t2*a*s-400.0*a3*t2*s-100.0*a4*t2*s-176.0*t2*a2*s...
           -36.0*t2*b4*s-144.0*t2*b2*s+20.0*t3*b4*x3-58.0*t3*b2*x3...
           +64.0*a6*s*x2-258.0*a2*x*t-90.0*x*t*b2+384.0*t*a5*x+...
           48.0*a*x*t+384.0*s*a5*x2-960.0*s*a3*x2+216.0*s*x2*a+...
           288.0*x3*t*a3-48.0*x3*t*a+960.0*a3*s-288.0*a3*t*x)/(t2*s3);
      Yk2=6.78168402777777777777777777778e-7*(165375.0-6480.0*t2-54720.0*t4...
          -774960.0*a2-80640.0*a6+8640.0*a6*t2+26880.0*a5*t2...
          +51840.0*a4*t2*b2+57600.0*t2*a3*b2-14400.0*a2*t2*b4...
          +165375.0*x4+4320.0*t2*a-23520.0*a3*t2-65880.0*a4*t2...
          +41760.0*t2*a2+3240.0*t2*b4+12960.0*t2*b2-64080.0*t2*a2*b2...
          -12960.0*t2*a*b2+473760.0*a4-89160.0*s*x3*t*a2-1920.0*a8*s*x3*t3...
          -7680.0*a7*s*x3*t3+13440.0*s*a5*x3*t3-4320.0*s*a6*x3*t3...
          +15120.0*a4*s*x3*t3+960.0*s*a*x3*t3-7080.0*s*a2*x3*t3...
          -6720.0*a3*s*x3*t3+23040.0*a6*t2*b2*x2+46080.0*t2*a5*b2*x2...
          -28800.0*a2*t2*b4*x3+11520.0*a4*t2*b4*x3-11520.0*a6*t2*b2*x4...
          -5760.0*a4*t2*b4*x4-23040.0*t2*a5*b2*x4+28800.0*a2*t2*b4*x...
          -11520.0*a4*t2*b4*x+3840.0*t3*a3*b2*s-49920.0*t3*a2*b2*s...
          -1920.0*t3*a*b2*s+5760.0*a6*t3*b2*s-5760.0*a4*t3*b4*s...
          +1920.0*a2*t3*b6*s+7680.0*a6*t*b2*s+15360.0*t3*a5*b2*s...
          -23040.0*t3*a3*b4*s+5760.0*t3*a*b4*s+9120.0*t3*a2*b4*s...
          -1440.0*t3*a4*b2*s-5760.0*t4*a*b2*x-1920.0*t4*a6*b2*x...
          +1920.0*t4*b6*a2*x+11520.0*t4*b6*a*x+3840.0*t4*a3*b4*x...
          -11520.0*t4*a5*b2*x+13440.0*t4*a*b4*x+23520.0*t4*a2*b4*x...
          -23520.0*t4*a4*b2*x-11520.0*t4*a3*b2*x-23040.0*t4*a3*b4*x2...
          -7680.0*t4*a5*b2*x2-17280.0*t4*a*b4*x2-50400.0*t4*a2*b4*x2...
          -42720.0*t4*a4*b2*x2-46080.0*t4*a3*b2*x2+66480.0*t4*a2*b2*x2...
          +69600.0*t4*a*b2*x2-2880.0*t4*a4*b4*x2-960.0*t3*a*s*x+...
          7680.0*a7*t3*s*x+7680.0*a8*t*x3*s-7680.0*a8*t*s*x...
          -5760.0*a8*t3*s*x-7680.0*a7*t3*s*x2+7680.0*a8*t*s*x2...
          -5760.0*a8*t3*s*x2+480.0*t3*b6*x3*s+1440.0*t3*b6*s*x+1200.0*t3*b4*x3*s...
          +5040.0*t3*b4*s*x-3480.0*t3*b2*x3*s-23040.0*t3*b2*s*x...
          -69120.0*a2*t3*s*x+97200.0*a4*t3*s*x-18720.0*a6*t3*s*x+...
          6720.0*t3*a3*s*x-13440.0*t3*a5*s*x-1440.0*t3*b6*s*x2...
          -4320.0*t3*b4*s*x2+14040.0*t3*b2*s*x2-14040.0*a2*t3*s*x2...
          +60480.0*a4*t3*s*x2-15840.0*a6*t3*s*x2-1920.0*t3*a3*s*x2...
          +9600.0*t3*a5*s*x2+960.0*t4*a6*b2*x4+960.0*t4*b6*a2*x4...
          +5760.0*t4*b6*a*x4+13440.0*t4*a3*b4*x4+9600.0*t4*a5*b2*x4...
          +15360.0*t4*a*b4*x4+36960.0*t4*a2*b4*x4+33120.0*t4*a4*b2*x4...
          +34560.0*t4*a3*b2*x4-33840.0*t4*a2*b2*x4-42720.0*t4*a*b2*x4...
          +1440.0*t4*a4*b4*x4-3840.0*t4*a3*b4*x3+11520.0*t4*a5*b2*x3...
          -13440.0*t4*a*b4*x3-23520.0*t4*a2*b4*x3+23520.0*t4*a4*b2*x3...
          +11520.0*t4*a3*b2*x3+5760.0*t4*a*b2*x3+1920.0*t4*a6*b2*x3...
          -1920.0*t4*b6*a2*x3-11520.0*t4*b6*a*x3-960.0*t4*a6*b2...
          -960.0*t4*b6*a2-5760.0*t4*b6*a+9600.0*t4*a3*b4...
          -1920.0*t4*a5*b2-1920.0*t4*b6-56640.0*t4*b4+126720.0*t4*b2...
          +240.0*t4*b8+1920.0*t4*a*b4+13440.0*t4*a2*b4+9600.0*t4*a4*b2...
          +11520.0*t4*a3*b2-32640.0*t4*a2*b2-26880.0*t4*a*b2...
          +1440.0*t4*a4*b4-3840.0*a3*t4-1152.0*a5*t4-1920.0*a7*t4+6912.0*t4*a...
          +128000.0*a2*t4+240.0*a8*t4-640.0*a6*t4-59200.0*a4*t4+3840.0*a8...
          -11520.0*a6*t2*b2+5760.0*a4*t2*b4-23040.0*t2*a5*b2-7680.0*a7*t2...
          +5760.0*a8*t2+43200.0*t2*a2*b2*x-43200.0*t2*a2*b2*x3-17280.0*a4*t2*b2*x...
          +17280.0*a4*t2*b2*x3+34560.0*a4*t2*b2*x4+57600.0*t2*a3*b2*x4+14400.0*a2*t2*b4*x4...
          -20880.0*t2*a2*b2*x4-12960.0*t2*a*b2*x4-67200.0*a4*t*b2*s+27000.0*t*b2*s*x2...
          -86400.0*a4*t2*b2*x2-115200.0*t2*a3*b2*x2-27000.0*t*b2*x3*s...
          +71040.0*a6*s*x*t-67200.0*a6*s*x2*t-71040.0*a6*s*x3*t+124320.0*a4*s*x2*t...
          +157920.0*a4*s*x3*t-27000.0*s*x2*t*a2+67200.0*a4*t*b2*s*x2-124320.0*t*a2*b2*s*x2...
          -330750.0*x2+161280.0*a6*x2-80640.0*a6*x4+473760.0*a4*x4-774960.0*x4*a2...
          -810.0*x4*t2-102960.0*t4*x2+3840.0*a8*x4-7680.0*a8*x2-945.0*x4*t4...
          -947520.0*a4*x2+7290.0*x2*t2+1549920.0*a2*x2+124320.0*t*a2*b2*s+...
          84960.0*t2*a2*b2*x2+25920.0*t2*a*b2*x2+27000.0*t*b2*s*x-157920.0*a4*s*x*t...
          +89160.0*a2*s*x*t-7680.0*a6*t*b2*s*x2-15360.0*t3*a5*b2*s*x2...
          +23040.0*t3*a3*b4*s*x2-5760.0*t3*a*b4*s*x2+15840.0*t3*a2*b4*s*x2...
          +1440.0*t3*a4*b2*s*x2-3840.0*t3*a3*b2*s*x2-56160.0*t3*a2*b2*s*x2...
          +1920.0*t3*a*b2*s*x2-67200.0*a4*t*b2*x3*s+67200.0*a4*t*b2*s*x...
          +124320.0*t*a2*b2*x3*s+5760.0*t3*a*b4*x3*s-5760.0*t3*a*b4*s*x...
          -3360.0*t3*a2*b4*x3*s-21600.0*t3*a2*b4*s*x-38880.0*t3*a4*b2*x3*s...
          +38880.0*t3*a4*b2*s*x+26880.0*t3*a3*b2*x3*s-26880.0*t3*a3*b2*s*x...
          +24000.0*t3*a2*b2*x3*s+82080.0*t3*a2*b2*s*x-4800.0*t3*a*b2*x3*s...
          +4800.0*t3*a*b2*s*x-5760.0*a6*t3*b2*x3*s+5760.0*a6*t3*b2*s*x...
          -5760.0*a4*t3*b4*x3*s+5760.0*a4*t3*b4*s*x-1920.0*a2*t3*b6*x3*s...
          -5760.0*a2*t3*b6*s*x+7680.0*a6*t*b2*x3*s-7680.0*a6*t*b2*s*x...
          -30720.0*t3*a5*b2*x3*s+30720.0*t3*a5*b2*s*x-23040.0*t3*a3*b4*x3*s...
          +23040.0*t3*a3*b4*s*x-5760.0*a6*t3*b2*s*x2+5760.0*a4*t3*b4*s*x2...
          +5760.0*a2*t3*b6*s*x2-124320.0*t*a2*b2*s*x-6480.0*b4*x*t2...
          -27000.0*t*b2*s-124320.0*t*a4*s+27000.0*a2*t*s-16200.0*t2*b2*x2...
          -36720.0*a4*t2*x-9720.0*t2*b2*x+9720.0*t2*a2*x+84960.0*a4*x2*t2...
          -13500.0*s*x*t-8640.0*a*x2*t2-48600.0*a2*x2*t2+47040.0*a3*x2*t2...
          -7680.0*a8*t*s-1920.0*a8*t3*s-3840.0*a7*t4*x+297600.0*a2*t4*x...
          +960.0*a8*t4*x-2400.0*a6*t4*x-130560.0*a4*t4*x-480.0*t3*b6*s...
          -1920.0*t3*b4*s+12480.0*t3*b2*s-12480.0*a2*t3*s+51840.0*a4*t3*s...
          -7200.0*a6*t3*s+1920.0*t3*a3*s-9600.0*t3*a5*s+2400.0*t4*b6*x...
          +130560.0*t4*b4*x-297600.0*t4*b2*x+5760.0*a3*t4*x-1920.0*a5*t4*x...
          +11520.0*t3*s*x+4320.0*t4*b6*x2-100440.0*t4*b4*x2+226080.0*t4*b2*x2...
          +1440.0*t4*b8*x2+16800.0*a3*t4*x2+384.0*a5*t4*x2-17184.0*t4*a*x2...
          +223520.0*a2*t4*x2+1440.0*a8*t4*x2+1760.0*a6*t4*x2...
          -95320.0*a4*t4*x2+3360.0*t4*b6*x4-9240.0*t4*b4*x4+5640.0*t4*b2*x4...
          +240.0*t4*b8*x4-8160.0*t4*b6*x3+35760.0*t4*b4*x3-60840.0*t4*b2*x3...
          -5760.0*a3*t4*x3+1920.0*a5*t4*x3+3840.0*a7*t4*x3+60840.0*a2*t4*x3...
          +960.0*a8*t4*x3+8160.0*a6*t4*x3-35760.0*a4*t4*x3+6480.0*b4*x3*t2...
          +67200.0*a6*t*s-11520.0*a6*t2*x+9720.0*t2*b2*x3-3240.0*t2*b4*x4...
          +3240.0*t2*b2*x4-53760.0*a5*x2*t2+26880.0*a5*x4*t2-28800.0*a6*x2*t2...
          +11520.0*a6*x3*t2+20160.0*a6*x4*t2-23520.0*a3*x4*t2+36720.0*a4*x3*t2...
          -19080.0*a4*x4*t2+13500.0*s*x3*t+4320.0*x4*t2*a-9720.0*x3*t2*a2...
          +6840.0*x4*t2*a2+768.0*a5*x4*t4+1920.0*a7*x4*t4+4640.0*a6*x4*t4...
          +240.0*a8*x4*t4+6920.0*a2*x4*t4-12960.0*a3*x4*t4+10272.0*a*x4*t4...
          +900.0*s*x3*t3-11800.0*a4*x4*t4+11520.0*a8*t2*x-11520.0*a8*x3*t2...
          -5760.0*a8*x4*t2+15360.0*a7*x2*t2-7680.0*a7*x4*t2-960.0*b8*x3*t4...
          -960.0*b8*x*t4+7680.0*a7*t3*s)/(s4*t4);
      Zk2=3.39084201388888888888888888889e-7*(-240.0*t5*a2*b8-1920.0*t5*a*b8+...
          240.0*t5*a8*b2-480.0*t5*a6*b4+480.0*t5*a4*b6-3840.0*t5*a5*b4+...
          5120.0*t5*a3*b6-10240.0*t5*a6*b2-3840.0*t5*a4*b4+15360.0*t5*a2*b6...
          -31872.0*t5*a5*b2+18560.0*t5*a3*b4+16000.0*t5*a*b6-22720.0*t5*a4*b2...
          +20160.0*t5*a2*b4-2560.0*t5*a3*b2+6400.0*t5*a*b4+1280.0*t5*a2*b2...
          -5888.0*t5*a*b2-1800.0*t3*b6-7200.0*t3*b4+46800.0*t3*b2-46800.0*a2*t3...
          +189600.0*a4*t3-13560.0*a6*t3-42720.0*t3*a3+173280.0*t3*a5+...
          13920.0*t3*a*b4+55320.0*t3*a2*b4-39960.0*t3*a4*b2-187200.0*t3*a3*b2...
          +42720.0*t3*a*b2-497280.0*t*a5+467040.0*a6*t-467040.0*a4*t*b2...
          +497280.0*t*a3*b2+965520.0*t*a2*b2-965520.0*t*a4+212625.0*a2*t...
          -212625.0*t*b2+108000.0*a3*t-108000.0*a*t*b2-163200.0*a6*t3*b2*x2...
          +13440.0*a2*t3*b6*x2-3840.0*a*t3*b6*x2+53760.0*a6*t*b2*x3-537600.0*t*a5*b2*x3...
          +163680.0*a2*t2*b4*s*x+245520.0*t2*a2*b2*s*x-908160.0*a4*t2*b2*s*x2...
          -314880.0*t2*a3*b2*s*x2+588480.0*t2*a2*b2*s*x2+86400.0*t2*a*b2*s*x2...
          +216000.0*t*a*b2*x2-38880.0*t2*a*b2*x*s-3840.0*t5*a*b8*x3-26880.0*a6*t*b2*x...
          +268800.0*t*a5*b2*x+243840.0*t3*a5*b2*x-5760.0*t3*a3*b4*x+5760.0*a*t3*b6*x...
          +466560.0*t4*a*b2*s+10080.0*t4*a6*b2*s-28320.0*t4*b6*a2*s...
          -16320.0*t4*b6*a*s+72000.0*t4*a3*b4*s+58560.0*t4*a5*b2*s+...
          24000.0*a4*t2*b4*s+183360.0*a6*t3*b2*x+92160.0*a4*t3*b4*x...
          -20160.0*a2*t3*b6*x+212625.0*x4*t*a2+68160.0*a8*x4*t3+82560.0*a7*x4*t3...
          -276000.0*x4*a5*t3-39480.0*x4*a6*t3-205080.0*a4*x4*t3+52650.0*x4*a2*t3...
          +63360.0*a3*x4*t3-57600.0*t2*a3*b4*s+38880.0*t2*a*b2*x3*s-72000.0*a4*t2*b2*x*s...
          -994560.0*t*a3*b2*x2+172800.0*t2*a3*b2*x*s-6480.0*t3*a2*b2*x2-618240.0*t4*a2*b2*x*s...
          -1199040.0*t4*a*b2*x*s+234240.0*t3*a4*b4*x2+62400.0*t4*a4*b4*x*s-46080.0*a7*t2*s*x...
          +59520.0*a8*t2*s*x-27586560.0*a7*t2*s*x2-4515840.0*a8*t2*s*x2+188160.0*t3*a3*b4*x2...
          +126720.0*t4*a3*b4*x*s-111360.0*t3*a5*b2*x2-134400.0*t4*a5*b2*x*s+...
          542400.0*t4*a*b4*x*s+350160.0*t4*a2*b4*x*s-81360.0*t4*a4*b2*x*s...
          -28800.0*t4*a3*b2*x*s-467040.0*a4*t*b2*x4+72000.0*a4*t2*b2*x3*s+...
          25920.0*a*t2*b4*x3*s+497280.0*t*a3*b2*x4-172800.0*t2*a3*b2*x3*s...
          -163680.0*a2*t2*b4*x3*s+965520.0*t*a2*b2*x4-245520.0*t2*a2*b2*x3*s...
          -108000.0*t*a*b2*x4-116160.0*t4*a6*b2*x2*s+13440.0*t3*b6*a2*x3+...
          8640.0*t4*b6*a2*x2*s-3840.0*t3*b6*a*x3+17280.0*t4*b6*a*x2*s-216000.0*t*a*b2*x3...
          -497280.0*t*a3*b2*x+994560.0*t*a3*b2*x3-234720.0*t4*a*b2*x3*s-129600.0*t3*a4*b4*x4...
          -62400.0*t4*a4*b4*x3*s-88320.0*t3*a3*b4*x3-270720.0*t4*a3*b4*x2*s...
          -487680.0*t3*a5*b2*x3-274560.0*t4*a5*b2*x2*s-427680.0*t4*a*b4*x2*s...
          -345600.0*t4*a2*b4*x2*s-115440.0*t4*a4*b2*x2*s+336000.0*t4*a3*b2*x2*s...
          +1008720.0*t4*a*b2*x2*s-366720.0*t3*a6*b2*x3+134400.0*t4*a5*b2*x3*s...
          +38880.0*t3*a*b4*x4+122880.0*t4*a*b4*x3*s-32040.0*t3*a2*b4*x4...
          -17520.0*t4*a2*b4*x3*s+66120.0*t3*a4*b2*x4+81360.0*t4*a4*b2*x3*s...
          +237120.0*t3*a3*b2*x4+28800.0*t4*a3*b2*x3*s+188880.0*t3*a2*b2*x4...
          -98640.0*t4*a2*b2*x3*s-63360.0*t3*a*b2*x4+81600.0*t3*a6*b2*x4...
          +96000.0*t4*a6*b2*x3*s-20160.0*t3*b6*a2*x4-65280.0*t4*b6*a2*x3*s...
          +5760.0*t3*b6*a*x4-49920.0*t4*b6*a*x3*s-144000.0*t3*a3*b4*x4...
          -126720.0*t4*a3*b4*x3*s+55680.0*t3*a5*b2*x4+37800.0*t2*b4*x3*s...
          +56700.0*t2*b2*x3*s+830280.0*s*t4*a2*b2*x2+26880.0*s*t4*a*b6*x...
          -96000.0*s*t4*a6*b2*x+53760.0*s*t4*a2*b6*x-197280.0*s*t4*a4*b4*x2...
          +418080.0*s*t2*a4*b2*x4-12960.0*s*t2*a*b4*x4+243840.0*s*t2*a3*b2*x4...
          +81840.0*s*t2*a2*b4*x4-171480.0*s*t2*a2*b2*x4-62640.0*s*t2*a*b2*x4...
          -13920.0*s*t4*a*b4*x4+98400.0*s*t4*a2*b4*x4+120240.0*s*t4*a4*b2*x4...
          -168960.0*s*t4*a3*b2*x4-210360.0*s*t4*a2*b2*x4-41520.0*s*t4*a*b2*x4...
          +106080.0*s*t4*a6*b2*x4+31200.0*s*t4*b6*a2*x4+22080.0*s*t4*b6*a*x4...
          +198720.0*s*t4*a3*b4*x4+216000.0*s*t4*a5*b2*x4-136320.0*s*t2*a6*b2*x4...
          -24000.0*s*t2*a4*b4*x4+42240.0*s*t2*a5*b2*x4+57600.0*s*t2*a3*b4*x4...
          +129840.0*x4*t4*a4*b4*s-76800.0*a9*t3*x+3840.0*a10*t*x-5760.0*a10*t3*x...
          +113874720.0*s*t2*a5*x4-2189520.0*s*t2*a3*x4+86058540.0*s*t2*a4*x4...
          -6916680.0*s*t2*x4*a+18900.0*s*t2*b2*x4+67990320.0*s*t2*a6*x4...
          -13860.0*s*t4*b4*x4+8460.0*s*t4*b2*x4+22110720.0*s*t2*a7*x4+...
          5040.0*s*t4*b6*x4-1347840.0*s*t4*a*x2+3984960.0*s*t2*a8*x4...
          -18900.0*s*t2*b4*x4+360.0*s*t4*b8*x4+96960.0*s*t4*a2*b2-19200.0*s*t4*a7*x...
          +183360.0*x5*t3*a6*b2+117120.0*x5*t3*a4*b4+243840.0*x5*t3*a5*b2+...
          94080.0*x5*t3*a3*b4-23584.0*x2*t5*a*b2+42560.0*x2*t5*a6*b2...
          -52800.0*x2*t5*b6*a2-54400.0*x2*t5*b6*a-45440.0*x2*t5*a3*b4+...
          88704.0*x2*t5*a5*b2+101600.0*x2*t5*a*b4-19560.0*x2*t5*a2*b4+...
          24680.0*x2*t5*a4*b2-65600.0*x2*t5*a3*b2+209920.0*x3*t5*a3*b4+...
          109056.0*x3*t5*a5*b2-31840.0*x3*t5*a*b4+129000.0*x3*t5*a2*b4...
          +127720.0*x3*t5*a4*b2-91520.0*x3*t5*a3*b2-161720.0*x3*t5*a2*b2...
          -976.0*x3*t5*a*b2+90720.0*x3*t5*a4*b4-23840.0*x5*t5*a6*b2...
          -26400.0*x5*t5*b6*a2-27200.0*x5*t5*b6*a-109120.0*x5*t5*a3*b4...
          -67008.0*x5*t5*a5*b2+73120.0*x5*t5*a*b4-54120.0*x5*t5*a2*b4...
          -48000.0*a4*t2*b4*s*x-1920.0*s*a2*b8*t4*x-3840.0*s*a6*b4*t2*x4...
          +1920.0*s*a8*b2*t4*x4+2880.0*s*a6*b4*t4*x4+1920.0*s*a4*b6*t4*x4...
          -7680.0*s*a8*b2*t2*x4+480.0*s*a2*b8*t4*x4-480.0*x3*t5*a2*b8...
          +960.0*x3*t5*a6*b4-25920.0*s*a*b4*x*t2-76800.0*a7*b2*t3*x2...
          +15360.0*a3*b6*t3*x2-11520.0*a8*b2*t3*x2+92160.0*a5*b4*t3*x2...
          +11520.0*a6*b4*t3*x2+3840.0*a4*b6*t3*x2-7680.0*a8*b2*t*x2...
          -23040.0*a3*b6*t3*x+5760.0*a8*b2*t3*x+46080.0*a5*b4*t3*x+...
          5760.0*a6*b4*t3*x-5760.0*a4*b6*t3*x-3840.0*a8*b2*t*x+...
          53760.0*a7*b2*t3*x+7680.0*x4*t5*a3*b6-720.0*x4*t5*a8*b2...
          -3840.0*x4*t5*a5*b4-480.0*x4*t5*a6*b4-7680.0*x4*t5*a7*b2...
          -146880.0*s*a5*t2*x+12960.0*s*a*t2*b4-118080.0*s*a9*x4*t4...
          -3840.0*s*a9*t4*x+67200.0*s*a9*t4*x2+11520.0*s*a9*t4*x3+46080.0*s*a9*t2*x...
          -399360.0*s*a9*x2*t2-46080.0*s*a9*x3*t2+360960.0*s*a9*x4*t2+...
          53326350.0*s-187608960.0*s*a5-379512000.0*s*a4-12430800.0*t3*x...
          +13213800.0*x3*t3-106652700.0*s*x2+30618000.0*x3*t...
          -16254000.0*s*t2-55641600.0*a6*s-15309000.0*x*t-114933600.0*a2*s...
          +112374540.0*a*s-240.0*x5*t5*a8*b2-7680.0*x5*t5*a5*b4-480.0*x5*t5*a6*b4...
          -480.0*x5*t5*a4*b6-3840.0*x5*t5*a7*b2-1920.0*x5*t5*a*b8-240.0*x5*t5*a2*b8...
          +10240.0*x3*t5*a3*b6-480.0*x3*t5*a8*b2+15360.0*x3*t5*a5*b4+...
          960.0*x3*t5*a4*b6-3840.0*a10*t*x4-124800.0*a6*t2*b2*s+...
          111360.0*t2*a5*b2*s+38880.0*a3*x*t2*s+26880.0*a6*t*b2*x4+...
          11520.0*a6*t2*b2*x3*s+48000.0*a4*t2*b4*x3*s-268800.0*t*a5*b2*x4+...
          69120.0*t2*a5*b2*x3*s-115200.0*t2*a3*b4*x3*s-56700.0*s*a2*x3*t2...
          -38880.0*a3*s*x3*t2-53760.0*a6*t*b2*x2-11520.0*a6*t2*b2*x*s...
          +537600.0*t*a5*b2*x2-69120.0*t2*a5*b2*x*s-59520.0*a8*s*x3*t2...
          +46080.0*a7*s*x3*t2+146880.0*s*a5*x3*t2+91680.0*s*a6*x3*t2+207720.0*a4*s*x3*t2...
          -94500.0*t2*b2*s*x2-417000.0*t2*a2*b2*s-23760.0*t2*a*b2*s+27840.0*t3*a*b4*x3...
          +110640.0*t3*a2*b4*x3-134640.0*t3*a4*b2*x3-40320.0*t3*a3*b2*x3...
          -236640.0*t3*a2*b2*x3+42240.0*t3*a*b2*x3+108000.0*a*t*b2*x...
          -216000.0*a3*x2*t-98424960.0*a6*s*x2*t2-209176320.0*a5*s*x2*t2...
          -253258560.0*s*a4*x2*t2+48705480.0*s*a*x2*t2+12610020.0*a2*s*x2*t2...
          -140797440.0*a3*s*x2*t2+934080.0*a4*t*b2*x2-1931040.0*t*a2*b2*x2...
          -934080.0*a4*t*b2*x3+467040.0*a4*t*b2*x+1931040.0*t*a2*b2*x3...
          -965520.0*t*a2*b2*x-91680.0*a6*t2*s*x-207720.0*a4*t2*s*x...
          +56700.0*t2*a2*s*x-37800.0*t2*b4*s*x-56700.0*t2*b2*s*x...
          -52800.0*t3*a*b4*x2-23280.0*t3*a2*b4*x2-26160.0*t3*a4*b2*x2...
          -49920.0*t3*a3*b2*x2+20640.0*t3*a*b2*x2-1440.0*t3*a*b4*x...
          -99000.0*t3*a2*b4*x+120360.0*t3*a4*b2*x+232320.0*t3*a3*b2*x...
          +303960.0*t3*a2*b2*x-74160.0*t3*a*b2*x+490080.0*a4*t2*b2*s...
          +71040.0*t2*a3*b2*s-81840.0*a2*t2*b4*s+530880.0*a8*t2*s...
          -8722560.0*a7*t3*x-497280.0*a5*x4*t+108000.0*a3*x4*t-965520.0*a4*x4*t...
          -212625.0*t*b2*x4+467040.0*a6*x4*t+994560.0*a5*x2*t-485157120.0*a5*x3*t...
          +16200.0*t3*b4*x4-52650.0*t3*b2*x4+268800.0*t*a7*x4-537600.0*t*a7*x2...
          -84480.0*a8*t3*x2+18827520.0*a7*t3*x3+2073600.0*a8*s*x2-6504960.0*a8*t*x3...
          +20183040.0*a7*s*x2-47754240.0*t*a7*x3+3603840.0*a8*t3*x3+5400.0*t3*b6*x4...
          -72960.0*a7*t3*x2-26880.0*a8*t*x4+53760.0*a8*t*x2-223680.0*t4*a*b4*s...
          -85440.0*t4*a2*b4*s-4800.0*t4*a4*b2*s-167040.0*t4*a3*b2*s+215040.0*a9*t*x...
          +215040.0*a9*t*x5-430080.0*a9*t*x3+3840.0*a10*t*x5-7680.0*a10*t*x3...
          +19200.0*a10*t3*x3-1800.0*t3*b6*x5+25600.0*x3*t5*a6*b2+30720.0*x3*t5*b6*a2...
          +32000.0*x3*t5*b6*a+1280.0*x4*t5*a2*b2-3840.0*x4*t5*a4*b4+7680.0*a10*t*x2...
          +115200.0*t2*a3*b4*s*x+261120.0*a6*t2*b2*s*x2+5760.0*x4*t5*a*b8+...
          720.0*x4*t5*a2*b8+46080.0*s*a5*t2*b4*x3-23040.0*s*a5*t2*b4*x4...
          -46080.0*s*a5*t2*b4*x+30720.0*s*a3*b6*t4*x+7680.0*s*a5*b4*t4*x-30720.0*s*a7*b2*t4*x...
          -57600.0*s*a5*b4*t4*x2-15360.0*s*a7*b2*t4*x2+15360.0*s*a3*b6*t4*x4...
          -30720.0*s*a3*b6*t4*x3-7680.0*s*a5*b4*t4*x3+30720.0*s*a7*b2*t4*x3...
          +53760.0*a7*b2*t3*x5-107520.0*a7*b2*t3*x3+6720.0*t3*b6*a2*x5...
          -1920.0*t3*b6*a*x5-92160.0*a5*b4*t3*x3+5760.0*a6*b4*t3*x5...
          -11520.0*a6*b4*t3*x3+1920.0*a4*b6*t3*x5+3840.0*a4*b6*t3*x3-3840.0*a8*b2*t*x5...
          +7680.0*a8*b2*t*x3+7680.0*a3*b6*t3*x5+15360.0*a3*b6*t3*x3+...
          5760.0*a8*b2*t3*x5-11520.0*a8*b2*t3*x3+46080.0*a5*b4*t3*x5...
          -23040.0*a3*b6*t3*x4+122880.0*s*a7*t2*b2*x2-61440.0*s*a7*t2*b2*x4...
          +32640.0*s*a5*b4*t4*x4+23040.0*s*a7*b2*t4*x4-3840.0*s*a*b8*x3*t4...
          -3840.0*s*a*b8*x*t4+5760.0*s*a*t4*b8*x2+960.0*s*a*t4*b8*x4-3840.0*s*a8*b2*t4*x...
          +3840.0*s*a4*b6*t4*x-7680.0*s*a6*b4*t2*x+2880.0*s*a2*b8*t4*x2...
          -5760.0*s*a6*b4*t4*x2+15360.0*s*a8*b2*t2*x2-1920.0*s*a2*b8*t4*x3+...
          3840.0*s*a8*b2*t4*x3-3840.0*s*a4*b6*t4*x3+7680.0*s*a6*b4*t2*x3...
          -53480.0*x5*t5*a4*b2+116480.0*x5*t5*a3*b2+166840.0*x5*t5*a2*b2...
          -42032.0*x5*t5*a*b2-45360.0*x5*t5*a4*b4+26880.0*x4*t5*a3*b4...
          -56832.0*x4*t5*a5*b2-108000.0*x4*t5*a*b4-600.0*x4*t5*a2*b4...
          -1960.0*x4*t5*a4*b2+68160.0*x4*t5*a3*b2+29472.0*x4*t5*a*b2-32320.0*x4*t5*a6*b2...
          +37440.0*x4*t5*b6*a2+38400.0*x4*t5*b6*a+14280.0*x5*t3*a4*b2-61440.0*s*a7*t2*b2...
          +23040.0*s*a5*t2*b4-15360.0*s*a3*b6*t4+24960.0*s*a5*b4*t4-7680.0*s*a7*b2*t4...
          +960.0*s*a*b8*t4-46080.0*a5*b4*t3*x4-5760.0*a6*b4*t3*x4+3840.0*a8*b2*t*x4...
          +30720.0*a7*t*b2*x4+108000.0*t*a*b2*x5-30720.0*a7*t*b2*x5+61440.0*a7*t*b2*x3...
          +268800.0*t*a5*b2*x5-61440.0*a7*t*b2*x2-497280.0*t*a3*b2*x5+38400.0*a7*t3*b2*x4...
          -30720.0*a7*t*b2*x-26880.0*a6*t*b2*x5-5760.0*a4*b6*t3*x4+5760.0*a8*b2*t3*x4...
          -3840.0*x2*t5*a*b8-480.0*x2*t5*a2*b8-12800.0*x2*t5*a3*b6+480.0*x2*t5*a8*b2...
          +7680.0*x2*t5*a5*b4+960.0*x2*t5*a6*b4+7680.0*x2*t5*a7*b2+467040.0*a4*t*b2*x5...
          -965520.0*t*a2*b2*x5-6400.0*x5*t5*a3*b6-30720.0*a9*t3*x2-30720.0*a9*t*x4+...
          61440.0*a9*t*x2-240.0*x4*t5*a10+480.0*x4*t5*a4*b6-960.0*x2*t5*a4*b6...
          -26400.0*x5*t3*a*b4-192000.0*x5*t3*a3*b2-11640.0*x5*t3*a2*b4-67320.0*x5*t3*a2*b2...
          +31920.0*x5*t3*a*b2-1760.0*x*t5*a6*b2-4320.0*x*t5*b6*a2-4800.0*x*t5*b6*a...
          -100800.0*x*t5*a3*b4-42048.0*x*t5*a5*b2-41280.0*x*t5*a*b4-74880.0*x*t5*a2*b4...
          -74240.0*x*t5*a4*b2-24960.0*x*t5*a3*b2-5120.0*x*t5*a2*b2+43008.0*x*t5*a*b2...
          -45360.0*x*t5*a4*b4-1920.0*s*a8*b2*t4+2880.0*s*a6*b4*t4-1920.0*s*a4*b6*t4...
          -7680.0*s*a8*b2*t2+3840.0*s*a6*b4*t2+480.0*s*a2*b8*t4-7200.0*s*a10*x4*t4+...
          7680.0*s*a10*t2*x+1920.0*s*a10*t4*x-15360.0*s*a10*t2*x2+2880.0*s*a10*t4*x2...
          -7680.0*s*a10*t2*x3+1920.0*s*a10*t4*x3+11520.0*s*a10*t2*x4-2560.0*x2*t5*a2*b2...
          +7680.0*x2*t5*a4*b4+48.0*t5*b10+3840.0*x*t5*a7*b2-3840.0*a10*t3*x2+...
          212625.0*t*b2*x5+368640.0*a9*t3*x3-291840.0*a9*x5*t3+30720.0*a9*x4*t3...
          -13440.0*a10*x5*t3+5760.0*a10*x4*t3-21760.0*x3*t5*a9-480.0*x3*t5*a10...
          -1920.0*x4*t5*a9-480.0*x3*t5*b10-48.0*x5*t5*b10-3840.0*x*t5*a3*b6+...
          720.0*x*t5*a8*b2-7680.0*x*t5*a5*b4-480.0*x*t5*a6*b4-480.0*x*t5*a4*b6...
          +1488.0*x5*t5*a10+19840.0*x5*t5*a9+5760.0*x*t5*a*b8+720.0*x*t5*a2*b8...
          +480.0*x2*t5*b10+240.0*x4*t5*b10+1280.0*x2*t5*a9-480.0*x2*t5*a10...
          -783000.0*x5*t3-831600.0*x3*t5-46080.0*s*a9-5760.0*a6*b4*t3+3840.0*a8*b2*t...
          -46080.0*a5*b4*t3+1920.0*a4*b6*t3+7680.0*a3*b6*t3+5760.0*a8*b2*t3+...
          30720.0*a7*b2*t-104640.0*a4*b4*t3+6720.0*a2*b6*t3+38400.0*a7*b2*t3+...
          26880.0*a6*b2*t-268800.0*a5*b2*t-44160.0*a3*b4*t3-1920.0*a*b6*t3+...
          81600.0*a6*b2*t3-182400.0*a2*b2*t3+55680.0*a5*b2*t3-1920.0*a10*t3...
          -3840.0*a10*t-30720.0*a9*t+16320.0*a8*t3+2022300.0*s*t2*x4-3488400.0*s*t4*x2...
          +28350.0*s*t4*x4-1635840.0*s*t4*a+134400.0*x*t5*b6-1140480.0*x*t5*b4...
          +2036160.0*x*t5*b2+5880.0*x*t5*b8+248832.0*x*t5*a3-609600.0*x*t5*a5...
          +393408.0*x*t5*a7-34560.0*x*t5*a+6649920.0*x*t5*a2+45560.0*x*t5*a8+...
          1120640.0*x*t5*a6-4844800.0*x*t5*a4-61527600.0*x5*t*a-9600.0*t3*a7...
          -26880.0*t*a8+268800.0*t*a7+183970080.0*x5*t*a3+242578560.0*x5*t*a5...
          +99526560.0*x5*t*a6+324735120.0*x5*t*a4-26219025.0*x5*t*a2+...
          3252480.0*x5*t*a8+23877120.0*x5*t*a7-21876960.0*x5*t3*a5-22027080.0*x5*t3*a6...
          +12858960.0*x5*t3*a3-1045620.0*x5*t3*a4-1688400.0*x5*t3*a+4808070.0*x5*t3*a2...
          -189600.0*x5*t5*a5+203328.0*x5*t5*a7+108104.0*x5*t5*a6+97400.0*x5*t5*a8...
          +41103.0*x5*t5*a2+42032.0*x5*t5*a3-192340.0*x5*t5*a4-2426880.0*x5*t3*a8...
          -10104960.0*x5*t3*a7+5280.0*x4*t5*b8-4320.0*x2*t5*b8+11136.0*x2*t5*a7+...
          2278800.0*x2*t5*a2+6880.0*x2*t5*a8+163720.0*x2*t5*a6-1307360.0*x2*t5*a4...
          -168840.0*x2*t5*b6+1309920.0*x2*t5*b4-2278800.0*x2*t5*b2+23584.0*x2*t5*a3...
          -36000.0*x2*t5*a5+89880.0*x3*t5*b6-601380.0*x3*t5*b4+1032960.0*x3*t5*b2...
          -3120.0*x3*t5*b8-290864.0*x3*t5*a3+799200.0*x3*t5*a5+34560.0*x3*t5*a...
          +2680320.0*x3*t5*a2-205360.0*x3*t5*a8-162280.0*x3*t5*a6-826660.0*x3*t5*a4...
          -504.0*x5*t5*b6+25500.0*x5*t5*b4-41103.0*x5*t5*b2-1800.0*x5*t5*b8...
          -15960.0*x4*t5*b6+49320.0*x4*t5*b4-115425.0*x4*t5*b2-29472.0*x4*t5*a3...
          +39840.0*x4*t5*a5-8448.0*x4*t5*a7+115425.0*x4*t5*a2-6560.0*x4*t5*a8...
          +18520.0*x4*t5*a6-50600.0*x4*t5*a4-4500.0*x5*t3*b4+13050.0*x5*t3*b2...
          +112374540.0*s*a*x4-401964480.0*s*a3*x4-187608960.0*s*a5*x4-55641600.0*s*a6*x4...
          -379512000.0*s*a4*x4-114933600.0*s*x4*a2-1036800.0*s*a8*x4-10091520.0*s*a7*x4...
          +38400.0*s*a9*t2+92160.0*s*a9*x2-46080.0*s*a9*x4-2880.0*s*a9*t4+3840.0*s*a10*t2...
          +480.0*s*a10*t4-596736.0*x3*t5*a7+2160.0*b8*x2*t4*s+42240.0*a7*x3*t4*s...
          -51600.0*a6*x3*t4*s+33120.0*a8*x3*t4*s+91260.0*a2*x3*t4*s+234720.0*a3*x3*t4*s...
          +45000.0*a4*x3*t4*s-151680.0*a5*x3*t4*s+15659088.0*a2*t4*x2*s+855600.0*a8*t4*x2*s...
          +7815072.0*a6*t4*x2*s-10732740.0*a4*t4*x2*s-272400.0*a6*t4*x*s+422400.0*a4*t4*x*s...
          -12240.0*t4*b6*x3*s+53640.0*t4*b4*x3*s-91260.0*t4*b2*x3*s-1440.0*t4*b8*x3*s...
          +6480.0*t4*b6*x2*s-150660.0*t4*b4*x2*s+339120.0*t4*b2*x2*s+4106160.0*a3*t4*x2*s...
          +276000.0*a5*t4*x2*s+4214400.0*a7*t4*x2*s+3600.0*t4*b6*x*s+195840.0*t4*b4*x*s...
          -446400.0*t4*b2*x*s-1440.0*t4*b8*x*s+1199040.0*a3*t4*x*s-513600.0*a5*t4*x*s+...
          446400.0*a2*t4*x*s-18720.0*a8*t4*x*s-38976.0*t5*b6+357120.0*t5*b4...
          -633792.0*t5*b2+640.0*t5*a9-48.0*t5*a10-1920.0*t5*b8+640.0*t5*a8...
          +41536.0*t5*a6-3840.0*t5*a5+5888.0*t5*a3+633792.0*t5*a2...
          -358400.0*t5*a4-2688.0*t5*a7+52438050.0*x3*t*a2-425250.0*t*b2*x3...
          +99526560.0*a6*x*t-934080.0*a6*x2*t-199053120.0*a6*x3*t+324735120.0*a4*x*t...
          +1931040.0*a4*x2*t-649470240.0*a4*x3*t+7658400.0*a4*x3*t3+71044800.0*a5*x3*t3...
          +53019600.0*a6*x3*t3+16071120.0*a*x3*t3-58139910.0*a2*x3*t3-83228160.0*a3*x3*t3...
          +229867200.0*s*x2*a2+759024000.0*a4*s*x2+14231700.0*s*x2*t2+425250.0*t*b2*x2...
          -425250.0*a2*x2*t-3600.0*b6*x3*t3+5400.0*b6*x*t3-5850.0*a2*t3*x2+...
          15480.0*a4*t3*x2+53040.0*a6*t3*x2-20640.0*t3*a3*x2+102720.0*t3*a5*x2...
          +18900.0*t3*b4*x-86400.0*t3*b2*x+53331840.0*a2*t3*x-6612780.0*a4*t3*x...
          -30992520.0*a6*t3*x+70369200.0*t3*a3*x-49167840.0*t3*a5*x-14382720.0*t3*a*x...
          -3600.0*t3*b6*x2-9000.0*t3*b4*x2+5850.0*t3*b2*x2+30434640.0*a6*t2*s...
          +95301600.0*a5*t2*s-41788800.0*t2*a*s+142986960.0*a3*t2*s+167200020.0*a4*t2*s...
          +21305520.0*t2*a2*s+18900.0*t2*b4*s+75600.0*t2*b2*s-14400.0*t3*b4*x3...
          +73350.0*t3*b2*x3+111283200.0*a6*s*x2-26219025.0*a2*x*t+212625.0*x*t*b2...
          -1036800.0*a8*s+3252480.0*a8*t*x-10091520.0*a7*s+23877120.0*t*a7*x...
          -1176960.0*a8*t3*x-605760.0*a7*t4*s+9150336.0*a2*t4*s-49560.0*a8*t4*s...
          -3372096.0*a6*t4*s-4712160.0*a4*t4*s-2880.0*t4*b6*s-84960.0*t4*b4*s+...
          190080.0*t4*b2*s+8165760.0*a3*t4*s-7842240.0*a5*t4*s+242578560.0*t*a5*x...
          +5475840.0*a7*t2*s+360.0*b8*s*t4-209280.0*a4*t3*b4*x3-61527600.0*a*x*t...
          +375217920.0*s*a5*x2+803928960.0*s*a3*x2-224749080.0*s*x2*a-367940160.0*x3*t*a3...
          +123055200.0*x3*t*a-401964480.0*a3*s+183970080.0*a3*t*x+1920.0*x*t5*a9...
          -240.0*x*t5*a10-240.0*x*t5*b10-153600.0*t2*a5*b2*s*x2+67440.0*s*t4*a4*b4...
          -33915540.0*s*t2*x4*a2-751320.0*s*t4*a8*x4-2295360.0*s*t4*a7*x4-679200.0*s*t4*x4*a5...
          -3174336.0*s*t4*x4*a6+2538780.0*s*t4*a4*x4-296820.0*s*t4*x4*a-508524.0*s*t4*x4*a2...
          +1561200.0*s*t4*a3*x4+53326350.0*s*x4-1987200.0*s*t4-1814400.0*x*t5...
          -15309000.0*x5*t)/(s5*t4); 
      Ycoef=Yk0+Yk1/kappa2+Yk2/kappa4; 
      Zcoef=Zk0+Zk1/kappa2+Zk2/kappa4;
    end    
    w=kappa*t;   
    if (i>0)&&(i<20)
      u=j1z;
      h=h*kappa;
      wn=-h*(2.0*u+h)/(2.0*u); 
      w2=wn*wn; 
      v=2.0*wn/u;
      fk(1)= 0.0;    
      j1=besselj(a+1,u);
      fk(2)=wn*j1; 
      S=fk(2); 
      kk= 1; tt= 1.0;
      while ((abs(tt)>1.0e-20)&&(kk < 20))
        fk(kk+2)=(kk*(a+kk)*v*fk(kk+1)-w2*fk(kk))/(kk*(kk+1)); 
        S= S+fk(kk+2);
        tt= fk(kk+2)/fk(2); 
        kk= kk+1;
      end  
      j0=(1.0+h/u)^a*S;
      j1=besselj(a+1,w);   
    else
      j0=besselj(a,w);
      j1=besselj(a+1,w);
    end
    expand=-kappa*(Ycoef*j1-(0.5*j0/w)*Zcoef);
    jacws(np-i+1)=1.0/(factord2*expand*expand*theta);
    thetah=theta*0.5;
    xc1=2*(sin(thetah))^2;
    xc2=1+jacn(np-i+1);  
    facw=xc1^(a+0.5)*xc2^(b+0.5)/2^(a+b+1);  
    jacw(np-i+1)=facw*jacws(np-i+1);
 end
end  

function [xcer,num,ierr]=besjz(a,b,pnu)
%---------------------------------------------------------
%Calculation of the first num zeros of the Bessel function
%J_(pnu)(z)
%----------------------------------------------------------
ierr=0;
dpi=pi;
if (floor(pnu)==pnu)
  pnu=abs(pnu);
end
if (a<1.e-8) 
  a=1.e-8;
end
if (pnu>=0)
  a=max(max(pnu,a),2.4);
end
pnu2=pnu*pnu-0.25;
if (pnu2~=0) 
  j=floor(pnu2/abs(pnu2));
else
  j=1;
end 
dev=1;
if (j==1)
  xm=a;
  xc=b;
else
  xm=b;
  xc=a;
end
i=0;
omega2=1-(pnu*pnu-0.25)/xc/xc;
omegam=1-(pnu*pnu-0.25)/xm/xm;
if (j>0) 
  omegab=omega2;
else
  omegab=omegam;
end
ss=omega2*omegam;
if (ss<0) 
  k=0;
elseif (omegab<=0) 
  k=-1;
else
  k=1;
end
while ((j*(xc-xm)>0)&&(k>=0))
  iter=0;
  dev=eps+1;
  isal=0;
  h=1;
  while ((dev>eps)&&(j*(xc-xm)>0)&&(k>=0)&&(abs(h)/xc>1.e-15))
    if(iter>1000)
      disp('convergence failure');
      ierr=1;
    end
    ffc=fc(xc,pnu+1,eps);
    h=1/((pnu+0.5)/xc-ffc);
    omega=sqrt(omega2);
    atast=atan(omega*h);
    dest=atast/omega;
    dev=abs(dest)/xc;
    if (j*dest<0) 
      if(dev>1.e-10) 
        dest=dest+j*dpi/omega;
      end
    end
    if (isal>1) 
      dev=0.5*eps;
    end
    if (log(dev)<0.25*log(eps)) 
      isal=1;
    end
    xc=xc-dest;
    iter=iter+1;
    omega2=1-(pnu*pnu-0.25)/xc/xc;
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    if (omega2<=0)
      k=-1;
    end
  end
  if ((j*(xc-xm)>0)&&(k>=0)) 
    i=i+1;
    xcer(i)=xc;
    ffc=fc(xc,pnu+1,eps);
    h=1/((pnu+0.5)/xc-ffc);
    xc=xc-j*dpi/omega;
    omega2=1-(pnu*pnu-0.25)/xc/xc; 
    if (omega2<=0) 
      k=-1;
    end
  end          
end        
if (k<0) 
  ffc=fc(xm,pnu+1,eps);
  hm=1/((pnu+0.5)/xm-ffc);
  ffc=fc(xc,pnu+1,eps);
  h=1/((pnu+0.5)/xc-ffc);
  if ((j*h>0)&&(h*hm<0))
    iter=0;
    dev=eps+1;
    omega=sqrt(-omega2);
    isal=0;
    while ((dev>eps)&&(abs(h*omega)<1)&&(j*(xc-xm)>0))
      iter=iter+1; 
      if(iter>1000)
        disp('convergence failure');
        ierr=1;
      end
      if (abs(h*omega)<1)
        atast=0.5*log((1+omega*h)/(1-omega*h));
        dest=atast/omega;
        dev=abs(dest)/xc;
        if (isal==1) 
          dev=0.5*eps;
        end
        if (log(dev)<0.25*log(eps)) 
          isal=1;
        end  
        xc=xc-dest;
        ffc=fc(xc,pnu+1,eps);
        omega2=1-(pnu*pnu-0.25)/xc/xc;
        h=1/((pnu+0.5)/xc-ffc);
        omega=sqrt(-omega2);
      end
    end  
    if (dev<eps) 
      i=i+1;
      xcer(i)=xc;
    end
  end        
end       
num=i;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
dev=eps+1;
if (abs(pnu+0.8774132)<0.01)&&(a<0.8)
   xc=0.721004;       
   while (dev>10*eps)
      ffc=fc(xc,pnu+1,eps);
      h=1/((pnu+0.5)/xc-ffc);
      xc=xc-h;
      dev=abs(h)/xc;
   end
   if (xc>a)
      if i>0
        if (abs(1-xc/xcer(i))>1.e-8)
          xcer(i+1)=xc;
          num=num+1;
        end
      else
        xcer(1)=xc;
      end
   end   
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
end
%-----------------------------------------
function [fct]=fc(xc,pnu,eps)
if pnu<0.5
  fct=besselj(pnu,xc)/besselj(pnu-1,xc);
else  
  tiny=1.e-290;
  tinysq=sqrt(tiny);          
  m=0;
  b=2*pnu/xc;
  a=1;
  fct=tinysq;
  c0=fct;
  d0=0;
  delta=0;
  while (abs(delta-1)>eps) 
    d0=b+a*d0;
    if (abs(d0)<tinysq) 
      d0=tinysq;
    end
    c0=b+a/c0;
    if(abs(c0)<tinysq) 
      c0=tinysq;
    end
    d0=1/d0;
    delta=c0*d0;
    fct=fct*delta;
    m=m+1;
    if (m>1e8)
      disp('convergence of the cf fails');
    end  
    a=-1;  
    b=2*(pnu+m)/xc;
  end
end 
end    

function qas=qasymN(X,a)
if a<0
  id=0;
else
  id=1;
end  
w=(2*X+a-1)/2.0;
w2=1.0/(w*w);
if id==0
  r=(a+1)/2.0;
else
  r=(-a+1)/2.0; 
end  
r2=r*r;
r3=r2*r;
r4=r2*r2;
r5=r4*r;
r6=r5*r;
r7=r6*r;
cc(1)=1.0;
cc(2)=r/12.0;
cc(3)=r/1440.0+r2/288.0;
cc(4)=r/90720.0+r2/17280.0+r3/10368.0;
cc(5)=r/4838400.0+101*r2/87091200.0+r3/414720.0+r4/497664.0;
cc(6)=r/239500800.0+13*r2/522547200.0+61*r3/1045094400.0+...
      r4/14929920.0+r5/29859840.0;
cc(7)=691.0*r/7846046208000.0+7999.0*r2/14485008384000.0+...
      59.0*r3/41803776000.0+143.0*r4/75246796800.0...
      +r5/716636160.0+r6/2149908480.0;
cc(8)=r/523069747200.0+ 2357*r2/188305108992000.0...
      +5941.0*r3/173820100608000.0...
      +11*r4/214990848000.0+41*r5/902961561600.0...
      +r6/42998169600.0+r7/180592312320.0;
s=1.0;
k=1;
t=1.0;
u=1.0;
while (abs(u)>eps)&&(k< 8)			
  t=-4.0*w2*(k-r)*(k-r-0.5)*t;
  u=t*cc(k+1);
  s=s+u;
  k=k+1;
end  
if id==0
  qas=s*exp(a*log(w)); 
else  
  qas=s*exp(-a*log(w));  
  qas=1/qas;
end  
end


function [x,w]=chebq(n,a,b)
   
ind=n-2*floor(n/2);
kf1=floor((n+1)/2);
kf2=floor(n/4);
k1=1:kf2;
if (a*b)>0
   k2=kf2+1:kf1;
   if a<0
      x=[cos((k1-0.5)*pi/n) sin(0.5*(n+1-2*k2)*pi/n)];
      x=[-x x(end-ind:-1:1)];
      w=repelem(pi/n,n);
   else
      x=[cos(k1*pi/(n+1)) sin(0.5*(n+1-2*k2)*pi/(n+1))];
      w=pi/(n+1)*sin((1:kf1)*pi/(n+1)).^2;
      x=[-x x(end-ind:-1:1)];
      w=[w w(end-ind:-1:1)];
   end    
else
   pi12=pi/(n+0.5);
   k2=kf2+1:3*kf2;k3=3*kf2+1:n;
   km=1:kf1;
   kmn=kf1+1:n;
   x=[cos(k1*pi12), sin(0.5*(n-2*k2+0.5)*pi12), -cos((n-k3+0.5)*pi12)];
   w=2*pi/(n+0.5)*[sin(km*pi/(2*n+1)).^2 cos((n-kmn+0.5)*pi/(2*n+1)).^2];
   if(a<0)
       x=-x;
   else
      x=x(end:-1:1);
      w=w(end:-1:1);
   end    
end  

end
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%% function GWGJ
%%%%%%%%%%%%%%%%%%%%%% Golub-Welsch algorithm
function [x,w]=GWGJ(N,a,b)
lo=(a+b+1)*log(2)+gammaln(a+1)+gammaln(b+1)-gammaln(a+b+2);
mu0=exp(lo);
bd(1)=(b-a)/(a+b+2);
if N>1
  ad(1)=2/(2+a+b)*sqrt((1+a)*(1+b)/(2+a+b+1));
  bd(N)=(b^2-a^2)/(2*N+a+b-2)/(2*N+a+b);
  for i=2:N-1
    ad(i)=2/(2*i+a+b)*sqrt(i*(i+a)*(i+b)*(i+a+b)/(2*i+a+b+1)/(2*i+a+b-1));
    bd(i)=(b^2-a^2)/(2*i+a+b-2)/(2*i+a+b);
  end
  J=diag(ad,-1)+diag(ad,1)+diag(bd,0);
else
  J=bd(1);
end  
[V,D]=eig(J);
x=diag(D)';
w=mu0*V(1,:).^2;
end
