function [xz,wns,w,uv]=GHa(n,expoc)
%-----------------------------------------------------------------------
%Computation of the nodes and weights of the Gauss-Hermite quadrature 
%using asymptotic methods.
% n-->degree 
% expoc: cut off (only weights such that w/wmax<10^(-expoc) are computed)
% xz-->nodes;  wns-->unscaled weights; 
% w-->scaled weights; uv--> barycentric weights
%------------------------------------------------------------------------
if nargin<2 
  expoc=1.e300;
end
expoc=max(expoc,20);
[xce,wge,wse]=hermweightnodesElem(n);
[xcA,wgA,wsA]=hermweightnodesAiry(n);
nz=floor(n/2);
na=max(20,floor(0.1*n));
if mod(n,2)>0
  nz=nz+1;
end 
for i=1:nz-na
  xc(i)=xce(i); 
  wg(i)=wge(i);
  ws(i)=wse(i);
end    
j=0;
for i=nz-na+1:nz
  j=j+1;  
  xc(i)=xcA(j); 
  wg(i)=wgA(j);
  ws(i)=wsA(j);
end    
xcut=sqrt(2.3*expoc);
xn=xc(1);
k=0;
while xn<xcut && k<nz
  k=k+1;
  xz(k)=xn;
  wns(k)=wg(k);
  w(k)=ws(k);
  if k<nz
    xn=xc(k+1);
  end
end
ind=n-2*floor(n/2);
xz=[-xz(end:-1:1+ind) xz];
wns=[wns(end:-1:1+ind) wns];
w=[w(end:-1:1+ind) w];
uv=-cumprod(-ones(1,n)).*sqrt(wns);
end
function [xc,wns,ws]=hermweightnodesElem(n)
%--------------------------------------------------------
%Use of the expansions in terms of elementary functions
%to compute the nodes and weights of the 
%Hermite quadrature
%--------------------------------------------------------
pihalf=1.5707963267948966192;
sqrt2=1.414213562373095048801688724209;
coef=[-1.0;
      -.1666666666666666666666666666666666666667;
      -.1083333333333333333333333333333333333333;
      -0.9781746031746031746031746031746031746032e-1;
      -.1029789462081128747795414462081128747795;
      -.1185528148548981882315215648548981882315;
      -.1447223360808430252874697319141763586208;
      -.1841424702124313566112507911449710391509;
      -.2416409291265798430296173838035026955039;
      -.3247526187621921340540265530664549271342;
      -.4448299202057149699692755265103329301935;
      -.6188302165966338536833280127383877276859;
      -.8720638695113304270841891338472154431061;
      -1.242376013463518484631280415563674045003;
      -1.786501336623570632631872965424237746926;
      -2.589730695499675375475142176509540386026;
      -3.780640308080888719717549204514168887497;
      -5.553576184438408780167627770540985335746;
      -8.203039868562756347705258717837873321332;
      -12.17636777658874344380596882243824135443;
      -18.15457238794114101062948150155261367928;
      -27.17659891004290239039532652877797426468;
      -40.83060392260416836989749905882789731468;
      -61.54883181994538179005616046095869191895;
      -93.06282233226342536907005748681717761144;
      -141.1070422934543963525344214727914308317;
      -214.5078680394418088266907470030373834564;
      -326.8709548592134856203876168077193310525;
      -499.1987539965874573264494983051459698163;
      -763.9552871233230930836415789961271882512;
      -1171.384879423675484100155954670649264345;
      -1799.344354210144899348505542423855010490;
      -2768.616703657759056029831064650143847869;
      -4266.783655566433949421272671394808083840;
      -6585.472863780683005629919398354833110086;
      -10178.52094643746134429677194638315046173;
      -15752.86959029306683900208591709384222268;
      -24410.72455007831034628117368218189367660;
      -37872.05123166356265113124013469146552909;
      -58823.05170812369363162644078894148861717;
      -91462.32613868108167457626584815484879705]; 
istart=1;
iodd=0;        
sumws=0.0;
k=1;
i=0;
mu2=2.0*n+1;
mu4=mu2*mu2;
mu6=mu4*mu2;
mu8=mu6*mu2;
mu10=mu8*mu2;
mu12=mu10*mu2;
mu14=mu12*mu2;
mu16=mu14*mu2;
mu18=mu16*mu2;
mu20=mu18*mu2;
nz=max(20,floor(0.1*n));
ncomp=floor(n*0.5-nz);
if mod(n,2)>0
  iodd=1;
  istart=0;
end  
for j=istart:ncomp
  if j==0 
    x1=0;
  else  
    if (mod(n,2)==0) 
      lambda2=pihalf*(4.0*k-2.0)/mu2;
    else
      lambda2=pihalf*4.0*k/mu2;
    end
    lambda2i=lambda2;
    lambda=0.5*lambda2;
    etag=-lambda;
    if abs(etag)<0.5
      ki=2; t=coef(1)*etag; s=1.0; 
      etag2=etag*etag; etagc=etag2*etag; 
      while (abs(s/t)>1.0e-20)&&(ki <40) 
        s=coef(ki)*etagc; t=t+s; 
        etagc=etagc*etag2; ki=ki+1;
      end 
    else 
      t=lambda+lambda2*lambda*0.166666666666666666666666666667;
      preci=1.0;
      ki=1;
      while(preci>5.e-15)&&(ki<40)
        told=t;
        t2=t*t;
        sqt=sqrt(1.0-t2);
        y=-asin(t)-t*sqt+lambda2;
        yp=-2.0*sqt;
        t=t-y/yp;
        preci=abs(1.0-t/told);
        ki=ki+1;
      end
    end   
    t2=t*t;
    t4=t2*t2;
    t6=t4*t2;
    t8=t6*t2;
    t10=t8*t2;
    t12=t10*t2;
    t14=t12*t2;
    t16=t14*t2;
    t18=t16*t2;
    t20=t18*t2;
    t22=t20*t2;
    t24=t22*t2;
    t26=t24*t2;
    st=(1.0-t2)^(1.5);
    st2=st*st;
    st3=st*st2;
    st5=st3*st2;
    st7=st5*st2;
    st9=st7*st2;
    eta2=-0.0416666666666666666666666666667*t*(t2-6.0)/st; 
    eta4=-0.000173611111111111111111*t*(2340.0*t2+351.0*t4-252.0*t6...
        +3780.0+56.0*t8)/st3;
    eta6=-0.000003100198412698412698*t*(3968.0*t14-29760.0*t12+95544.0*t10...
           -173232.0*t8+231237.0*t6-1890882.0*t4-6068580.0*t2...
           -1690920.0)/st5; 
    eta8=-9.688120039682539682539682e-8*t*(390144.0*t20-4096512.0*t18+...
            19410816.0*t16-54813120.0*t14+102752648.0*t12...
            -133470484.0*t10+97864929.0*t8+1546472088.0*t6...
            +10016777736.0*t4+7920060960.0*t2+908827920.0)/st7;
    eta10=-7.3394848785473785473785473e-11*t*(2930278400.0*t26-39558758400.0*t24...
            +247049118720.0*t22...
            -945874335488.0*t20+2480139354240.0*t18-4708607233280.0*t16...
            +6659623539280.0*t14-7146685172480.0*t12+7152666884643.0*t10...
            -120838596083370.0*t8-1069562119614120.0*t6...
            -1603518073985520.0*t4-555963268568400.0*t2-34758257133600.0)/st9;
    etac=eta2/mu4+eta4/mu8+eta6/mu12+eta8/mu16+eta10/mu20; 
    lambda2=lambda2i-2.0*etac;
    lambda=0.5*lambda2;
    etag=-lambda;
    if abs(etag)<0.5
      ki=2; t=coef(1)*etag; s=1.0; etag2=etag*etag; 
      etagc=etag2*etag; 
      while (abs(s/t)>1.0e-20)&&(ki < 40) 
        s=coef(ki)*etagc; t=t+s; 
        etagc=etagc*etag2; ki=ki+1;
      end     
    else
      t=lambda+lambda2*lambda*0.166666666666666666666666666667;
      preci=1.0;
      ki=1;
      while (preci>5.e-15)&&(ki<40)
        told=t;
        t2=t*t;
        sqt=sqrt(1.0-t2);
        y=-asin(t)-t*sqt+lambda2;
        yp=-2.0*sqt;
        t=t-y/yp;
        preci=abs(1.0-t/told);
        ki=ki+1;
      end
    end
    x1=sqrt(mu2)*t; 
    k=k+1;
  end
  i=i+1;
  xc(i)=x1;
  xc2=x1*x1;   
  xp=sqrt2*x1;
  if i==1 && iodd==1
    wg(i)=1;
  else
    uax=expaderi(n,xp);
    wg(i)=1.0/(uax*uax);
  end  
  sumws=sumws+2*wg(i)*xc2*exp(-xc2);
end
if iodd==1
  ncomp=ncomp+1;
  a=(n+1)*0.5;
  wns(1)=pi/2*quotgamm(a,a+1/2); 
  ws(1)=wns(1);
  for j=2:ncomp
    x1=xc(j);
    xc2=x1*x1;
    ws(j)=0.5*sqrt(pi)*wg(j)/sumws;
    fac=exp(-xc2);
    wns(j)=fac*ws(j);
  end
else
  for j=1:ncomp
    x1=xc(j);
    xc2=x1*x1;
    ws(j)=0.5*sqrt(pi)*wg(j)/sumws;
    fac=exp(-xc2);
    wns(j)=fac*ws(j);
  end
end
end
function [hermid]=expaderi(n,x)
% -----------------------------------------------------
% Calculation of a function related to the derivative  
% of the Hermite polynomials by using asymptotic
% expansions in terms of elementary functions
% --------------------------------------------------
  sqrt2=1.414213562373095048801688724209;
  gk=[1.0;
      .41666666666666666667e-1;
       0;
       -.97463348765432098765e-2;
       0;
       .12318482904510826965e-1;
       0;
       -.37822933917705539682e-1;
       0;
       .21514326767209896474;
       0;
       -1.9630003732872175294;
       0;
       26.256830962378916652;
       0;
       -484.19061617504532506;
       0;
       11773.948564802034554;
       0;
       -365037.92569092371983;
       0;
       14054558.808383655048;
       0;
       -657894020.31009296820;
       0;
       36795321248.737494263];
  eps=1.e-20;
  mu=sqrt(2.0*n+1.0);
  t=x/(mu*sqrt2);
  mu2=mu*mu;
  t2=t*t; t3=t2*t; t4=t3*t; t5=t4*t; t6=t5*t; t7=t6*t; t8=t7*t; t9=t8*t;
  t10=t9*t; t11=t10*t; t12=t11*t; t13=t12*t; t14=t13*t; t15=t14*t;
  t16=t15*t; t17=t16*t; t18=t17*t; t19=t18*t; t20=t19*t; t21=t20*t;
  t22=t21*t; t23=t22*t; t24=t23*t; t25=t24*t; t26=t25*t; t27=t26*t;
  t28=t27*t; t29=t28*t; t30=t29*t; t31=t30*t; t32=t31*t; t33=t32*t;
  t34=t33*t; t35=t34*t; t36=t35*t; t37=t36*t; t38=t37*t; t39=t38*t;
  t40=t39*t; t41=t40*t;     
  u(1)=1.0;
  u(2)=.4166666666666666666666667e-1*t*(t2-6.0);
  u(3)=.1258680555555555555555556+.2161458333333333333333333*t2-...
         .7812500000000000000000000e-2*t4;
  u(4)=-.6252170138888888888888889*t-.3665002893518518518518519*t3...
       -.6820746527777777777777778e-1*t5+.4385850694444444444444444e-1*t7...
       -.9746334876543209876543210e-2*t9;
  u(5)=-.3892736866640946502057613e-2*t6+.3208267274707433127572016...
       -.8071183569637345679012346e-2*t8+.1827437789351851851851852e-2*t10...
        +3.079461293161651234567901*t2+1.279432885440779320987654*t4;
  u(6)=.1495080253037428963354889e-9*t*(-34009066266.0-119582875013.0*t2...
        +1994971575.0*t10-3630137104.0*t8+4433574213.0*t6...
        -37370295816.0*t4+82393456.0*t14-617950920.0*t12);
  u(7)=25.84962798338368105790252*t6+.1713039028908536874755046e-1*t14...
       +2.581943865065753536501370-.2309715544595780055849500e-2*t16...
       -.5076538089737495643136799e-1*t12-.3186668406760671571869489*t8...
       +.8601473529456107027269498e-1*t10+62.68920892021549979121503*t2...
       +121.7179460820865799300044*t4;
  u(8)=-.7865531634245733182633045e-15*t*(110065274285017326.0...
       -125776738623632286.0*t10+839442893976461885.0*t2-51589093643118259.0*t14...
       +96739097673864045.0*t12+1014872932457342145.0*t4+18208957214179542.0*t16...
       +80153092162171710.0*t6+114221755795701455.0*t8-3833677186738392.0*t18...
       +365112113022704.0*t20);
  u(9)=5596.879044604074283137768*t6+13.69521272837774834409345*t14...
       +2.638371331228334872355069*t18-7.390056136076261345369326*t16...
       -17.49598518388745077640624*t12+679.5130553150720497530461*t8...
       +.5384626640674465938317402e-1*t22+11.60187790297422517485544*t10...
       -.5608986084035902019080627*t20+1769.339898073369191761939*t2...
       +7072.617883848053965523396*t4+46.00893448266345421442011;
  u(10)=.1716369641152583388897846e-22*t*(-.1359234799748243655770368e27...
       +196970983448449506582784.0*t26+.3935158819364260070148776e27*t10...
       -.4824119188126012644493997e27*t12+.4501074357324417329611653e27*t14...
       -.5072207498713186429103949e27*t8-.4586684500765682622356092e28*t4...
       -.2551586343346702497275826e28*t6+.1671990097243978109434037e27*t18...
       -.3176839480721397029728588e27*t16+.1661834830959361591291224e26*t22...
       -.6369835812416149521724992e26*t20-.1825949193391480686660700e28*t2...
       -2659108276554068338867584.0*t24);
  u(11)=914112.2670988274244565704*t6+1457.987476485281604308530*t14...
       +981.4809913805934941962403*t18-52.76053458609560685621252*t24...
       -.6338906553354126033547987*t28+8.504699625750119095010216*t26...
       +1213.983451915325067883233-1375.290270384664889535434*t16...
       -1323.383956656255885190354*t12+415376.7168317029950197364*t8...
       +200.5566577594646000950658*t22+35768.04278735927027177930*t10...
       -521.6682753837636432341761*t20+75167.67289016707645386544*t2...
       +532260.3452982493777355059*t4;
  u(12)=-.3359006667469412593393634e-31*t*(.2788947144378624557826141e37+...
       .1212394967494477547839171e34*t32-.2000451696365887953934633e35*t30...
       +.1550285194341124782611328e36*t28-.7492595928004916139721089e36*t26...
       +.2528614856038361343385493e37*t24-.6321380226416724568027542e37*t22...
       +.1211628603883129655678535e38*t20-.1817616151670370488438873e38*t18...
       -.2039447456964012213382125e38*t14+.1526729786684424672364467e38*t12...
       -.4167726542712734865896683e35*t10+.1286775691925214910694996e39*t8...
       +.3375397423010140569245605e39*t6+.2668957183771871703360651e39*t4...
       +.6033537049761229856043034e38*t2+.2158825430879550563836032e38*t16);
  u(13)=153053249.2910557053308385*t6+78424.56411652519477233020*t14+...
       128182.4650008160699499318*t18-38558.08568947489765851297*t24...
       -4637.584888683471835001935*t28+15541.01589815635919400013*t26...
       -119592.7457128667753060960*t16+2857220.354347191785055925*t12...
       +151197224.7859743079793903*t8+965.8070562838161807622995*t30...
       +73303.13746459791327933258*t22+46150931.05589019507584725*t10...
       +7.635830211413084690217302*t34-125.3548793040314736644007*t32...
       -108987.9643972328459888073*t20+4457999.843158161718417669*t2...
       +50231562.58692156905275991*t4+48082.01508844808488819284;
  u(14)=.7703374808710407147877427e-40*t*(-.6926180733786124297783135e47...
       -.3490732449110820673555558e50*t6+.8082605068869249980049792e48*t22...
       +.2682009600079171280174385e48*t26-.5172558239822205556645540e48*t24...
       -.1109805333478410099533049e48*t28+.1487945383913154715160031e46*t34...
       +.3580113360465377112428930e47*t30-.8679377325149432331738492e46*t32...
       +.8249366361784484160838564e43*t38-.1608626440547974411363520e45*t36...
       -.9370275546601561256767938e48*t16+.6651854621331235420882608e48*t14...
       -.7836351143702021345383874e48*t12-.7007020293314608957292234e49*t10...
       -.2782407158660428165686684e50*t8-.1553433992040236087729803e50*t4...
       -.2221765150562660149162442e49*t2-.1032888153750967506466895e49*t20...
       +.1084709216891677773429753e49*t18);
  u(15)=29777856511.31303518396996*t6+405725357.0120253215335119*t14...
       +12581472.10822014648877845*t18-11128041.92193217407836428*t24...
       -3746199.514655045078233992*t28+7174530.658451246530535730*t26...
       -9965848.257226286974264551*t16+2313.542955855017656723246*t38...
       +7954048017.175341662787203*t12+52707258002.79912630559216*t8...
       +1560495.910682062257811549*t30+14108384.19513404699749891*t22...
       +35147200819.52248373734473*t10+123538.5886859896169363174*t34...
       -506576.1722262477285863913*t32-21294.73752084727438922035*t36...
       -14687754.72489477423506592*t20+358625041.4599066211836996*t2...
       +6078341745.370762847643443*t4-119.1524269109880338226565*t40...
       +2674542.439978280740741820;
  u(16)=-414790432.6994505167392778*t+6945.991168730899603944917+...
        510652.2760188471673646379*t2+3506139.062413368413555602*t18...
       -4424351.480098610189178738*t20+4507540.556879283080170755*t22...
       +2493813.214756674570007723*t26-3725064.570331952034347715*t24...
       +5707621.898105787921162792*t4-19329184319.93965811896088*t3...
       -204822062695.9835996571353*t5-746830449214.8311385338279*t7...
       -1071759390145.197565881790*t9+21556032.59225403242059432*t6...
       +35040737.47008682938237320*t8+24773160.94128538674006004*t10...
       +1461033.332711555204742717*t14+5971318.466177208703908447*t12...
       -2216567.774820235631058887*t16-1343045.511157374057238458*t28...
       -190443.7698884165190432579*t32+574046.2785186452537735790*t30...
       +47314.98337952692225675031*t34+913.5019396509082593070329*t38...
       -8288.707145438840911983684*t36-47.66097076439521352906259*t40...
       +2815957.942354381680464703*t29-4949452.062439341149009949*t27...
       +6883478.737523361808313990*t25-122150797756.7143021925426*t13...
       +16322778.36996041226643312*t17-5600428212.110544205675050*t15...
       -610079501215.4117897742389*t11-4100118.049694015514682209*t19...
       +6373075.827367999613237065*t21-7547338.888154381034617815*t23...
       -110849.0793687075287393032*t35+432724.8534694151550145610*t33...
       -1257756.708472409889487035*t31+119.1524269109880338226565*t41...
       -2244.037373490274636993364*t39+19926.89640129648768991938*t37;
  ud(1)=0.0;
  ud(2)=.12500000000000000000000001*t2-.250000000000000000000000020;
  ud(3)=.4322916666666666666666666*t-0.31250000000000000000000000e-1*t3;
  ud(4)=-.6252170138888888888888889-1.0995008680555555555555557*t2...
        -.34103732638888888888888890*t4+.30700954861111111111111108*t6...
        -0.87717013888888888888888890e-1*t8;
  ud(5)=-0.23356421199845679012345678e-1*t5-0.64569468557098765432098768e-1*t7...
        +0.18274377893518518518518520e-1*t9+6.158922586323302469135802*t...
        +5.117731541763117283950616*t3;
  ud(6)=-5.08462833985379693930041056761-17.8785995033379281335733848449*t2...
        +.298264260715347819297472019228*t10-.542734630000887958063883887870*t8...
        +.662854925623225997574955783788*t6-5.58715913246688528806584257198*t4...
        +0.123184829045108269645306659206e-1*t14-0.923886217838312022339799944048e-1*t12...
        +0.1495080253037428963354889e-9*t*(-239165750026.0*t+19949715750.0*t9...
        -29041096832.0*t7+26601445278.0*t5-149481183264.0*t3+1153508384.0*t13...
        -7415411040.0*t11);
  ud(7)= 155.09776790030208634741512*t5+.23982546404719516246570644*t13...
        -0.36955448713532480893592000e-1*t15-.60918457076849947717641588*t11...
        -2.5493347254085372574955912*t7+.86014735294561070272694980*t9...
        +125.37841784043099958243006*t+486.8717843283463197200176*t3;
  ud(8)=-86.5721896720737200038527038003+98.9300916496436883799925121539*t10...
        -660.266463771464798183829982892*t2+40.5775648032012124737582845972*t14...
        -76.0904433022165467319147142100*t12-798.251515498295795271978893008*t4...
        -14.3223128994756245965300911695*t16-63.0446681984175317579764368556*t6...
        -89.8414833530180711099939641857*t8+3.01539091877770092545774514424*t18...
        -.287180087502638183376928108975*t20-0.7865531634245733182633045e-15*t...
        *(-1257767386236322860.0*t9+1678885787952923770.0*t...
        -722247311003655626.0*t13+1160869172086368540.0*t11+...
         4059491729829368580.0*t3+291343315426872672.0*t15+480918552973030260.0*t5...
        +913774046365611640.0*t7-69006189361291056.0*t17+7302242260454080.0*t19);
  ud(9)= 33581.274267624445698826608*t5+191.73297819728847681730830*t13...
        +47.490683962110027702391242*t17-118.240898177220181525909216*t15...
        -209.95182220664940931687488*t11+5436.1044425205763980243688*t7...
        +1.18461786094838250642982844*t21+116.01877902974225174855440*t9...
        -11.2179721680718040381612540*t19+3538.679796146738383523878*t...
        +28290.471535392215862093584*t3;
  ud(10)=-2332.94934548599650588858619466+3.38075016178886721789226069527*t26...
        +6754.18713067065877334173489266*t10-8279.97171980113623956301475435*t12...
        +7725.50737948200507168148534773*t14-8705.78296441779436263394173633*t8...
        -78724.4603065931077258531698113*t18-5452.63083952514357488666697629*t16...
        +285.232285246858353032996530088*t22-1093.29928075575810321867663845*t20...
        -31340.0376182418479450521966081*t2-45.6401271841497074415455193862*t24...
        +0.1716369641152583388897846e-22*t*(5121245569659687171152384.0*t25...
        +0.39351588193642600701487760e28*t9-0.57889430257512151733927964e28*t11...
        +0.63015041002541842614563142e28*t13-0.40577659989705491432831592e28*t7...
        -0.18346738003062730489424368e29*t3-0.15309518060080214983654956e29*t5...
        +0.30095821750391605969812666e28*t17-0.50829431691542352475657408e28*t15...
        +0.36560366281105955008406928e27*t21-0.127396716248322990434499840e28*t19...
        -0.3651898386782961373321400e28*t-63818598637297640132822016.0*t23);
  ud(11)= 5484673.6025929645467394224*t5+20411.824670793942460319420*t13...
        +17666.6578448506828955323254*t17-1266.25283006629456454910048*t23...
        -17.7489383493915528939343636*t27+221.122190269503096470265616*t25...
        -22004.644326154638232566944*t15-15880.607479875070622284248*t11+...
         3323013.7346536239601578912*t7+4412.2464707082212020914476*t21+...
         357680.42787359270271779300*t9-10433.3655076752728646835220*t19+...
         150335.34578033415290773088*t+2129041.3811929975109420236*t3;
  ud(12)=-93680.9205318757837390847459358-40.7244277942031183478256013230*t32...
        +671.953058604351452739122707345*t30-5207.41830427095221064579769466*t28...
        +25167.6796788226842079144109789*t26-84936.3416089506461745358502399*t24...
        +212335.583281430828302167205797*t22-406986.855894008832742830144828*t20...
        +610538.477236086956857596623746*t18+685051.760589565492368351323467*t14...
        -512829.553289713648811038071792*t12+1399.94212451613200053205781276*t10...
        -4322288.12871436366509480412357*t8-11337982.4492501354387725414946*t6...
        -8965044.97548010337194799712327*t4-2026669.11785717001184329957055*t2...
        -725150.901622693786208213977333*t16-0.3359006667469412593393634e-31*t...
        *(0.38796638959823281530853472e35*t31-0.60013550890976638618038990e36*t29...
        +0.43407985441551493913117184e37*t27-0.194807494128127819632748314e38*t25...
        +0.60686756544920672241251832e38*t23-0.139070364981167940496605924e39*t21...
        +0.24232572077662593113570700e39*t19-0.32717090730066668791899714e39*t17...
        -0.28552264397496170987349750e39*t13+0.18320757440213096068373604e39*t11...
        -0.41677265427127348658966830e36*t9+0.10294205535401719285559968e40*t7...
        +0.20252384538060843415473630e40*t5+0.10675828735087486813442604e40*t3...
        +0.12067074099522459712086068e39*t+0.34541206894072809021376512e39*t15);
  ud(13)= 918319495.7463342319850310*t5+1097943.89763135272681262280*t13+...
         2307284.3700146892590987724*t17-925394.05654739754380431128*t23...
        -129852.376883137211380054180*t27+404066.41335206533904400338*t25...
        -1913483.9314058684048975360*t15+34286644.252166301420671100*t11...
        +1209577798.2877944638351224*t7+28974.2116885144854228689850*t29...
        +1612669.02422115409214531676*t21+461509310.55890195075847250*t9...
        +259.618227188044879467388268*t33-4011.3561377290071572608224*t31...
        -2179759.2879446569197761460*t19+8915999.686316323436835338*t...
        +200926250.34768627621103964*t3;
  ud(14)= -5335496.61852233926762718774595-2689042041.24282792600494809877*t6...
        +62263336.2762824257565651085906*t22+20660525.1899693616357845899365*t26...
        -39846154.8412338230304428469170*t24-8549246.44849003701429121629927*t28...
        +114622.009871735315289533258852*t34+2757895.50733365473255908823246*t30...
        -668604.966418484535507264176964*t32+635.479610191936180387501160728*t38...
        -12391.8523987427555175562727883*t36-72182744.5963656077247417665315*t16...
        +51241729.3211669434343795647347*t14-60366349.9926031389564717681381*t12...
        -539777036.116423667616690266073*t10-2143392521.36002432918621418276*t8...
        -1196668428.12771978122913920966*t4-171150896.917150810623881595746*t2...
        -79567245.8382060492232626215782*t20+83559216.5617934380574066518698*t18...
        +0.7703374808710407147877427e-40*t*(-0.20944394694664924041333348e51*t5...
        +0.177817311515123499561095424e50*t21+0.69732249602058453284534010e49*t25...
        -0.124141397755732933359492960e50*t23-0.31074549337395482786925372e49*t27...
        +0.50590143053047260315441054e47*t33+0.107403400813961313372867900e49*t29...
        -0.277740074404781834615631744e48*t31+0.313475921747810398111865432e45*t37...
        -0.57910551859727078809086720e46*t35-0.149924408745624980108287008e50*t15...
        +0.93125964698637295892356512e49*t13-0.94036213724424256144606488e49*t11...
        -0.70070202933146089572922340e50*t9-0.22259257269283425325493472e51*t7...
        -0.6213735968160944350919212e50*t3-0.4443530301125320298324884e49*t...
        -0.20657763075019350129337900e50*t19+0.19524765904050199921735554e50*t17);    
  ud(15)=178667139067.87821110381976*t5+5680154998.1683545014691666*t13...
        +226466497.94796263679801210*t17-267073006.12637217788074272*t23...
        -104893586.410341262190551776*t27+186537797.119732409793928980*t25...
        -159453572.115620591588232816*t15+87914.632322490670955483348*t37...
        +95448576206.104099953446436*t11+421658064022.39301044473728*t7...
        +46814877.320461867734346470*t29+310384452.29294903394497602*t21...
        +351472008195.22483737344730*t9+4200312.0153236469758347916*t33...
        -16210437.5112399273147645216*t31-766610.55075050187801193260*t35...
        -293755094.49789548470131840*t19+717250082.9198132423673992*t...
        +24313366981.483051390573772*t3-4766.0970764395213529062600*t39;
  ud(16)= 1021304.5520376943347292758*t-414790432.6994505167392778...
        -57987552959.81897435688264*t2+22830487.592423151684651168*t3...
        -1024110313479.9179982856765*t4+129336195.55352419452356592*t5...
        -5227813144503.8179697367953*t6+280325899.76069463505898560*t7...
        -9645834511306.778092936110*t8+247731609.41285386740060040*t9...
        -6710874513369.5296875166279*t10+71655821.594126504446901364*t11...
        -1587960370837.2859285030538*t12+20454466.657961772866398038*t13...
        -84006423181.658163085125750*t14-35465084.397123770096942192*t15...
        +277487232.28932700852936304*t16+63110503.123440631444000836*t17...
        -77902242.944186294778961971*t18-88487029.601972203783574760*t19...
        +133834592.374727991877978365*t20+99165892.251344227763756610*t21...
        -173588794.427550763796209745*t22-89401549.687966848824345160*t23...
        +172086968.438084045207849750*t24+64839143.583673538820200798*t25...
        -133635205.685862211023268623*t26-37605274.312406473602676824*t27...
        +81662780.328277068733476387*t28+17221388.3555593576132073700*t29...
        -38990457.962644706574098085*t30-6094200.6364293286093842528*t31...
        +14279920.1644907001154805130*t32+1608709.43490391535672951054*t33...
        -3879717.7779047635058756120*t34-298393.457235798272831412624*t35...
        +737295.16684797004452701706*t36+34713.0737067345138536672502*t37...
        -87517.457566120710842741196*t38-1906.43883057580854116250360*t39...
        +4885.2495033505093867289165*t40;      
  t2p1=1.0-t2;
  mu4=mu2*mu2;
  tts=t2p1*t2p1*t2p1;
  ttss=sqrt(tts);
  eta=0.5*(acos(t)-t*sqrt(1.0-t2));
  % -----------------------
  % Computation of G(mu) 
  % G(mu)=1/gmus
  % --------------------------
  for k=0:15
    if k==0
      mus=1.0;
      gmus=0.0;
    else
      mus=mus*mu2;
    end
    gmus=gmus+gk(k+1)/mus;
  end
  maxi=1.0;
  k=0;
  while (2*k+1<=14)&&(maxi>eps)
    if k==0
      mus1=1.0;
      mus2=mu2*ttss;
      s1=0.0;
      s2=0.0;
    else
      mus1=-mus1*mu4*tts;
      mus2=-mus2*mu4*tts;
    end
    itwok=2*k;
    as=(0.5+6.0*k)*t*u(itwok+1)+u(itwok+2)+t2p1*ud(itwok+1);
    bs=(3.5+6.0*k)*t*u(itwok+2)+u(itwok+3)+t2p1*ud(itwok+2);
    delta1=as/mus1;
    delta2=bs/mus2;
    s1=s1+delta1;
    s2=s2+delta2;
    e1=abs(delta1/s1);
    e2=abs(delta2/s2);
    k=k+1;
    maxi=max(e1,e2);
  end    
  acoef=s1;
  bcoef=-mu2*ttss+s2;
  facu=t2p1^(-1.25);
  argu3=mu2*eta-pi*0.25;
  hermid=facu/(gmus*mu)*(cos(argu3)*acoef-sin(argu3)*bcoef);
end
function [xc,wg,ws]=hermweightnodesAiry(n)
%--------------------------------------------------
%Use of the expansions in terms of Airy functions
%to compute the nodes and weights of the 
%Hermite quadrature
%--------------------------------------------------
akz=[-2.33810741045976703848919725245;
    -4.08794944413097061663698870146;
    -5.52055982809555105912985551293;
    -6.78670809007175899878024638450;
    -7.94413358712085312313828055580;
    -9.02265085334098038015819083988;
    -10.0401743415580859305945567374;
    -11.0085243037332628932354396496;
    -11.9360155632362625170063649029;
    -12.8287767528657572004067294072;
    -13.6914890352107179282956967795;
    -14.5278299517753349820739814430;
    -15.3407551359779968571462085135;
    -16.1326851569457714393459804472;
    -16.9056339974299426270352387706;
    -17.6613001056970575092536503040;
    -18.4011325992071154158613979295;
    -19.1263804742469521441241486897;
    -19.8381298917214997009475636160;
    -20.5373329076775663599826814113];
 fa=[.701210822720691362490691656032;
    -.803111369654863963634309928051;
     .865204025894151930842956658786;
    -.910850737049601803073652644092;
     .947335709441567765594931000990;
    -.977922808569498610951596048427;
     1.00437012266031196849779945681;
    -1.02773868882078617672330501492;
     1.04872064858818954795581953684;
    -1.06779385915742783465142457418;
     1.08530283135070003206714380883;
    -1.10150457027749681179755325019;
     1.11659617793265608454519281725;
    -1.13073231049318789017561655303;
     1.14403667327355267721472491904;
    -1.15660984911656546389019188625;
     1.16853478448752481831746911777;
    -1.17988072987014557291785268507;
     1.19070613115877665284431455226;
    -1.20106079151982328001598528695];
  tk=[1.0;
      -.1;
      0.314285714285714285714285714286e-1;
      -0.130634920634920634920634920635e-1;
           0.621121418264275407132549989693e-2;
          -0.319906474477903049331620760192e-2;
           0.173777995952145612009557587789e-2;
          -0.980623142726584103134723382823e-3;
           0.569420492357847625313463323308e-3;
          -0.338100196675792239310677242038e-3;
           0.204370114791263009312426285349e-3;
          -0.125357206146868136136169976986e-3;
           0.778376567244785230522960780819e-4;
          -0.488347176911089869923418675793e-4;
           0.309121101417648748863566053596e-4;
          -0.197187318355062768112477381683e-4;
           0.126638038195362885400732567430e-4;
          -0.818166374107958830292428856066e-5;
           0.531404826983844643747599552925e-5;
          -0.346796577957279300938115718981e-5;
           0.227292188320007388086526994870e-5;
          -0.149547340729042461825245455480e-5;
           0.987427662047048302944212416180e-6;
          -0.654081624963445420632311469707e-6;
           0.434553025532847128524374105274e-6;
          -0.289491431556065849185763530316e-6;
           0.193339417524680200780866177522e-6;
           -0.129424497932685479368775178361e-6;
           0.868264737632955638538229057067e-7;
          -0.583664151268043077659649430585e-7;
           0.393089148860581415689990893049e-7;
          -0.265206310610328091041607558560e-7];
   nz=max(20,floor(0.1*n));   
   mu=sqrt(2.0*n+1);
   mu2=mu*mu;
   mu4=mu2*mu2;
   mu8=mu4*mu4;
   mu12=mu8*mu4;
   for m=1:nz
     if m>20
       t=3.0*pi/8*(4.0*m-1.0);
       t2=t*t;
       t4=t2*t2;
       t6=t4*t2;
       t8=t6*t2;
       t10=t8*t2;
       akm=-t^(2.0/3.0)*(1.0+5/(48*t2)...
          -5.0/(36*t4)+77125.0/(82944*t6)...
           -108056875.0/(6967296*t8)+162375596875.0/(334430208.0*t10));
     else
       akm=akz(m);  
     end
     zeta=mu^(-4.0/3.0)*akm;
     zeta2=zeta*zeta;
     zeta5=zeta2*zeta2*zeta;
     zeta8=zeta*zeta2*zeta5;
     zetak(1)=zeta;
     zetag=0.793700525984099737375852819635*zeta;
     if abs(zetag)<0.5
       ki=2; x=zetag; s=1.0;  
       zetagc=zetag*zetag; 
       while (abs(s/x)>1.0e-18)&&(ki < 32) 
         s=tk(ki)*zetagc; x=x+s; 
         zetagc=zetagc*zetag; ki=ki+1;
       end  
       t=1.0+x;
     else  
       beta=(8.0/3.0)*(-zeta)^(1.5);
       if beta>1.0 
         x=beta+sin(beta);
       else
         x=2.0*(beta*0.75)^(1.0/3.0);
       end
       preci=1.0;
       while (preci>5.e-15)
         xold=x; 
         y=x-sin(x)-beta;
         yp=1.0-cos(x);
         x=x-y/yp;
         preci=abs(1.0-x/xold);
       end
       t=cos(x*0.5);
     end  
     t2=t*t;
     t3=t2*t;
     t4=t3*t;
     t5=t4*t;
     t6=t5*t;
     t7=t6*t;
     t8=t7*t;
     t9=t8*t;
     t10=t9*t;
     t11=t10*t;
     t12=t11*t;
     t13=t12*t;
     t14=t13*t;
     t15=t14*t;
     chi=(zeta/(t2-1.0))^0.25;
     chi2=chi*chi;
     chi4=chi2*chi2;
     chi6=chi4*chi2;
     chi12=chi6*chi6;
     chi14=chi12*chi2;
     chi16=chi14*chi2;
     chi18=chi16*chi2;
     chi20=chi18*chi2;
     chi22=chi20*chi2;
     chi24=chi22*chi2;
     chi26=chi24*chi2;
     chi28=chi26*chi2;
     chi30=chi28*chi2;
     zetak(2)=0.0208333333333333333333333333333*...
           (5.0+2.0*chi6*t3-12.0*chi6*t)/zeta2;
     zetak(3)=-0.0000868055555555555555555555555556*(-60.0*chi12*t4...
           -270.0*chi12*t2+702.0*chi18*t5+4680.0*chi18*t3+7560.0*chi18*t...
           +25.0*chi6*t3-150.0*chi6*t-300.0*chi12-504.0*chi18*t7...
           +112.0*chi18*t9+5.0*chi12*t6-1350.0)/zeta5; 
     zetak(4)=2.15291556437389770723104056437e-8*(38853500.0-105525.0*chi6*t3+...
           633150.0*chi6*t-50400.0*chi12*t4+2145150.0*chi12*t2+...
           170100.0*chi18*t5+685440.0*chi18*t3-263088.0*chi24*t6+...
           11544120.0*chi24*t4-272287008.0*chi30*t5+...
           33298128.0*chi30*t7+1171800.0*chi18*t-115920.0*chi18*t7+...
           24080.0*chi18*t9+27488160.0*chi24*t2+312984.0*chi24*t8-...
           98784.0*chi24*t10-873875520.0*chi30*t3-24945408.0*chi30*t9+...
           13758336.0*chi30*t11+1329300.0*chi12+3175200.0*chi24-...
           4285440.0*chi30*t13+571392.0*chi30*t15-243492480.0*chi30*t+...
           9408.0*chi24*t12+4200.0*chi12*t6)/zeta8;  
     zpertub=zetak(2)/mu4+zetak(3)/mu8+zetak(4)/mu12; 
     zeta=zetak(1)+zpertub; 
     zetag=0.793700525984099737375852819635*zeta;
     if abs(zetag)<0.5
       ki=2; x=zetag; s=1.0;  
       zetagc=zetag*zetag; 
       while (abs(s/x)>1.0e-18)&&(ki < 32) 
         s=tk(ki)*zetagc; x=x+s; 
         zetagc=zetagc*zetag; ki=ki+1;
       end
       t=1.0+x;
     else    
       beta=(8.0/3.0)*(-zeta)^(1.5);
       if beta>1.0 
         x=beta+sin(beta);
       else
         x=2.0*(beta*0.75)^(1.0/3.0);
       end   
       preci=1.0;
       while(preci>5.e-15)
         xold=x; 
         y=x-sin(x)-beta;
         yp=1.0-cos(x);
         x=x-y/yp;
         preci=abs(1.0-x/xold);
       end
       t=cos(x*0.5);   
     end
     zetac1(nz+1-m)=zeta;
     zetaper(nz+1-m)=zpertub;
     xc(nz+1-m)=mu*t;
   end
   %Weights
   factorw=quotgamm(n+1,n+1/2)*gamstar(n+1/2)*sqrt(2)/(2*n+1)^(4/3);
   nn=n;
   for i=1:nz
     iz=i;  
     x1=xc(i);
     zeta1=zetac1(i);
     zper1=zetaper(i);
     xc2=x1*x1;
     [uax]=expaderiU(nn,x1,akz,fa,nz,iz,zeta1,zper1);
     ws(i)=(factorw/uax)/uax;
     fac=exp(-xc2);
     wg(i)=fac*ws(i);
   end   
end
function [yp]=expaderiU(n,x,akz,fa,nz,iz,zeta1,zper1)
%Expansion for the derivative U'(a,b)
%Including series
kmax=2;
gammak(1)= 1;
gammak(2)= -0.4166666666666666666667e-1;
gammak(3)= 0.00086805555555555555555556;
gammak(4)= 0.00241849922839506172839506172840;
gammak(5)= -0.101147561406893004115226337449e-3;
gammak(6)= -0.766740395652297055653537135019e-3;
gammak(7)= 0.0000349598874469962819732945761752;
gammak(8)= 0.000589797623989952907426175869677;
gammak(9)= -0.264647245939550185600798299437e-4;
gammak(10)= -0.839514009366161124983906098646e-3;
gammak(11)= 0.0000367266298645205294333014269145;
gammak(12)=0.00191578706758086160815029691048;
gammak(13)= -0.823422154909661800608585390342e-4;
nu=2*n+1;
mu=sqrt(nu);
mu2=nu;
t=x/mu;
z= mu*mu/2; 
s= 0; d= 1; k= 1; zk=1;
while d > eps && k <= 12
  zk=zk*z;  
  term= gammak(k+1)/zk; 
  s= s+term; 
  d= abs(term/s); 
  k= k+1; 
end
gmus=(1+s/2);
eta=(acos(t)-t*sqrt(1-t^2))/2;
zeta=-(3/2*eta)^(2/3);
if abs(zeta)>0.1
  chi=(zeta/(t*t-1))^(1/4);
  psi=2*chi^6; 
  t2=t*t; t3=t2*t; t4=t3*t; t5=t4*t; t6=t5*t; t7=t6*t; t8=t7*t; t9=t8*t;
  t10=t9*t; t11=t10*t; t12=t11*t; t13=t12*t; t14=t13*t; t15=t14*t;
  t16=t15*t; t17=t16*t; t18=t17*t; t19=t18*t; t20=t19*t; t21=t20*t;
  t22=t21*t; t23=t22*t; t24=t23*t; t25=t24*t; t26=t25*t; t27=t26*t;
  psi2=psi*psi;
  psi3=psi2*psi;
  psi4=psi3*psi;
  psi5=psi4*psi;
  psi6=psi5*psi;
  psi7=psi6*psi;
  psi8=psi7*psi;
  psi9=psi8*psi;
  zeta2=zeta*zeta;
  zeta3=zeta2*zeta;
  zeta4=zeta3*zeta;
  zeta5=zeta4*zeta;
  zeta6=zeta5*zeta;
  zeta7=zeta6*zeta;
  zeta8=zeta7*zeta;
  zeta9=zeta8*zeta;
  zeta10=zeta9*zeta;
  zeta11=zeta10*zeta;
  zeta12=zeta11*zeta;
  zeta13=zeta12*zeta;
  Ck(1)=-0.0208333333333333333333333333333*(psi*t3+6*psi*t-7)/zeta;
  Ck(2)=0.30140817901234567901e-6*(4042*psi3*t9-18189*psi3*t7+36387*psi3*t5-238425*psi3*...
    t3+1575*psi2*t4-259290*psi3*t-34335*psi2*t2+6825*psi*t3-15015*psi2+...
    40950*psi*t+475475)/zeta4;
  Ck(3)=-0.46721257907419655105e-11*(82393456*psi5*t15-617950920*psi5*t13+2025529095*...
    psi5*t11-3750839308*psi5*t9+5941740*psi4*t10+3832454253*psi5*t7-...
    27034917*psi4*t8+25747540*psi3*t9+35213253348*psi5*t5+7445942*psi4*t6-...
    115863930*psi3*t7+130919230435*psi5*t3+2816736825*psi4*t4+231785190*psi3...
    *t5+34009066266*psi5*t+6504859662*psi4*t2-1518767250*psi3*t3-99849750*psi2...
    *t4+593817623*psi4-1651677300*psi3*t+2176724550*psi2*t2-1414538125*psi*t3...
    +951900950*psi2-8487228750*psi*t-201713136625)/zeta7;
  Ck(4)=0.67594412481799269538e-16*(4371539900752*psi7*t21-45901168957896*psi7*t19...
    +218405957733906*psi7*t17-620383849291457*psi7*t15+129769693200*psi6*t16+...
    1164406579029195*psi7*t13-979761183660*psi6*t14+562335337200*psi5*t15-...
    1514355184823118*psi7*t11+3046481371815*psi6*t12-4217515029000*psi5*t13+...
    1531341334173469*psi7*t9-5422462086825*psi6*t10+13824236073375*psi5*t11-...
    20079365070264138*psi7*t7+14528861012232*psi6*t8-25599478277100*psi5*t9-...
    403592689500*psi4*t10-113744015324794125*psi7*t5-949813992856953*psi6*t6+...
    26156500276725*psi5*t7+1836346737225*psi4*t8-5717563101250*psi3*t9-...
    89579631055317797*psi7*t3-4372271851405248*psi6*t4+240330454100100*psi5*t5...
    -505765610350*psi4*t6+25729033955625*psi3*t7-10005934025910666*psi7*t-...
    2180186982918693*psi6*t2+893523747718875*psi5*t3-191326848838125*psi4*t4-...
    51470798754375*psi3*t5-84366907577743*psi6+232111877265450*psi5*t-...
    441842592541350*psi4*t2+337261252453125*psi3*t3+45385455740625*psi2*t4-...
    40335062042275*psi4+366775590431250*psi3*t-989402935145625*psi2*t2+...
    1082190977993125*psi*t3-432674678060625*psi2+6493145867958750*psi*t+...
    232671060268521875)/zeta10;
  Ck(5)=-0.74085486463812681435e-23*(56718490318251105536*psi9*t27-...
    765699619296389924736*psi9*t25+4788251773987246801200*psi9*t23-...
    18371197721367697512960*psi9*t21+908843145366340800*psi8*t22+...
    48268121686301454222195*psi9*t19-9588295183614895440*psi8*t20+...
    3938320296587476800*psi7*t21-91777252551611537524410*psi9*t17+...
    45324637291339809480*psi8*t18-41352363114168506400*psi7*t19+...
    130168704679947003610350*psi9*t15-127680678134951429565*psi8*t16+...
    196761927322475915400*psi7*t17-139478709088256681012580*psi9*t13+...
    244232376428305035540*psi8*t14-558903809826673611300*psi7*t15-...
    1163528046200520000*psi6*t16+99730992382525190776545*psi9*t11-...
    322871853522144887730*psi8*t12+1049013887047401775500*psi7*t13+...
    8784636748813926000*psi6*t14-16483313987840700000*psi5*t15+...
    2336003146312065610520910*psi9*t9-265514126868915309000*psi8*t10-...
    1364282586007147006200*psi7*t11-27315056627830471500*psi6*t12+...
    123624854908805250000*psi5*t13+21217860627729298551927414*psi9*t7+...
    88227172159396449632145*psi8*t8+1379585407956878222100*psi7*t9+...
    48618337316681632500*psi6*t10-405219463841786343750*psi5*t11+...
    31403134314757603763939376*psi9*t5+649624176620733679374240*psi8*t6-...
    18089499991800961924200*psi7*t7-130267220721773335200*psi6*t8+...
    750378307127924475000*psi5*t9+24215137597676025000*psi4*t10+...
    10802138054520651928121835*psi9*t3+723481574507545133005110*psi8*t4-...
    102471983406107027212500*psi7*t5+8516127241354726293300*psi6*t6-...
    766705875236432381250*psi5*t7-110178876069425913750*psi4*t8+...
    577396503162363885000*psi3*t9+665979985945122339402450*psi9*t+...
    155468504476794913630380*psi8*t2-80702289617735803317300*psi7*t3+...
    39202226646884594092800*psi6*t4-7044626353195656225000*psi5*t5+...
    30345405567109132500*psi4*t6-2598284264230637482500*psi3*t7+...
    3300056007704888115915*psi8-9014345963942918999400*psi7*t+...
    19547774507547293307300*psi6*t2-26191191474072593718750*psi5*t3+...
    11479410037096219968750*psi4*t4+5197854171343130797500*psi3*t5+...
    756442130032801512300*psi6-6803721374374186762500*psi5*t+...
    26510091617758831582500*psi4*t2-34058822678497429312500*psi3*t3-...
    6910330489975099687500*psi2*t4+2420061370721355611250*psi4-...
    37039371426266534325000*psi3*t+150645204681457173187500*psi2*t2-...
    231380899239332921203125*psi*t3+65878484004429283687500*psi2-...
    1388285395435997527218750*psi*t-66457736059297289034453125)/zeta13;
    Dk(1)= 1;
    Dk(2)=0.21701388888888888889e-3*(15*psi2*t4-327*psi2*t2+10*psi*t3-143*psi2+...
          60*psi*t+385)/zeta3;
    Dk(3)= -0.15698342656893004115e-8*(121260*psi4*t10-551733*psi4*t8+80840*psi3*t9+...
      151958*psi4*t6-363780*psi3*t7+57484425*psi4*t4+727740*psi3*t5+132752238*psi4...
      *t2-4768500*psi3*t3-173250*psi2*t4+12118727*psi4-5185800*psi3*t+3776850*...
      psi2*t2-1701700*psi*t3+1651650*psi2-10210200*psi*t-185910725)/zeta6;
    Dk(4)=0.32445317991263649378e-14*(18538527600*psi6*t16-139965883380*psi6*t14+...
      12359018400*psi5*t15+435211624545*psi6*t12-92692638000*psi5*t13-...
      774637440975*psi6*t10+303829364250*psi5*t11+2075551573176*psi6*t8-...
      562625896200*psi5*t9-4901935500*psi4*t10-135687713265279*psi6*t6+...
      574868137950*psi5*t7+22303806525*psi4*t8-48147899800*psi3*t9-...
      624610264486464*psi6*t4+5281988002200*psi5*t5-6142902150*psi4*t6+...
      216665549100*psi3*t7-311455283274099*psi6*t2+19637884565250*psi5*t3-...
      2323807880625*psi4*t4-433438305300*psi3*t5-12052415368249*psi6+...
      5101359939900*psi5*t-5366509221150*psi4*t2+2840094757500*psi3*t3+...
      292809391875*psi2*t4-489899538975*psi4+3088636551000*psi3*t-6383244742875*...
      psi2*t2+5660981576250*psi*t3-2791449535875*psi2+33965889457500*psi*t+...
      1023694168371875)/zeta9;
   Dk(5)=-0.17602711583801893109e-18*(262292394045120*psi8*t22-2767184757176016*psi8...
      *t20+174861596030080*psi7*t21+13080703402984072*psi8*t18-...
      1836046758315840*psi7*t19-36848680558427541*psi8*t16+8736238309356240*psi7...
      *t17+70485534322743156*psi8*t14-24815353971658280*psi7*t15-28549332504000*...
      psi6*t16-93180910107401122*psi8*t12+46576263161167800*psi7*t13+...
      215547460405200*psi6*t14-280417888150400*psi5*t15-76627453641822600*psi8*t10...
     -60574207392924720*psi7*t11-670225901799300*psi6*t12+2103134161128000*...
      psi5*t13+25462387347589162953*psi8*t8+61253653366938760*psi7*t9+...
      1192941659101500*psi6*t10-6893685721923000*psi5*t11+187481724854468594336*...
      psi8*t6-803174602810565520*psi7*t7-3196349422691040*psi6*t8+...
      12765606500847200*psi5*t9+315609483189000*psi4*t10+208796991199868725254*...
      psi8*t4-4549760612991765000*psi7*t5+208959078428529660*psi6*t6-...
      13043374804660200*psi5*t7-1436023148509950*psi4*t8+6101783341654000*psi3*t9...
     +44868255260258272332*psi8*t2-3583185242212711880*psi7*t3+...
      961899807309154560*psi6*t4-119844786444583200*psi5*t5+395508707293700*psi4...
      *t6-27458025037443000*psi3*t7+952397116220746931*psi8-400237361036426640*...
      psi7*t+479641136242112460*psi6*t2-445570508862479000*psi5*t3+...
      149617595791413750*psi4*t4+54929636430669000*psi3*t5+18560719667103460*psi6...
      -115746456129704400*psi5*t+345520907367335700*psi4*t2-359925208617975000*...
      psi3*t3-61421650102312500*psi2*t4+31542018517059050*psi4-...
      391422910108230000*psi3*t+1338991972230412500*psi2*t2-1774793203908725000*...
      psi*t3+585553064308712500*psi2-10648759223452350000*psi*t-...
      448357133137441653125)/zeta12;
  Czeta=0; Dzeta=0; mu4=mu2*mu2;
  for k=0:kmax
    Czeta=Czeta+Ck(k+1)/mu4^k;
    Dzeta=Dzeta+Dk(k+1)/mu4^k;
  end  
  Fzeta=Czeta/mu2/chi;
  Gzeta=Dzeta/chi;
else
  if nz-iz<20
    zeta=zeta1; 
    eta1=zeta*2^(-1/3); 
  else
    etak(1)=1.;
    etak(2)= .1;
    etak(3)= -0.114285714285714285714285714286e-1;
    etak(4)= 0.234920634920634920634920634921e-2;
    etak(5)= -0.609853638425066996495567924139e-3;
    etak(6)= 0.180738626452912167197881483596e-3;
    etak(7)= -0.584403009437023042465219335968e-4;
    etak(8)= 0.201092346392066280021462094291e-4;
    etak(9)= -0.725136210954316186839818301973e-5;
    etak(10)= 0.271224973437252231456427400267e-5;
    etak(11)= -0.104469994875015343505044081172e-5;
    etak(12)= 0.412202990691874105181841994725e-6;
    etak(13)= -0.165942259072320893801925766508e-6;
    etak(14)= 0.679501132895039943583860640572e-7;
    etak(15)= -0.282328150059657895410496067839e-7;
    etak(16)= 0.118795808696284546323466449923e-7;  
    d= 1;  j= 1; 
    dd=t-1; eta=0;
    while j <= 16 && d > eps
      term= etak(j)*dd^j; 
      eta= eta+term; 
      d= abs(term/eta); 
      j= j+1;
    end
    eta1=eta;  
    zeta=eta*2^(1/3);
  end    
  cjk(1,1)= -.1;
  cjk(2,1)= 0.1e-1;
  cjk(3,1)= -0.229841269841269841269841269841e-1;
  cjk(4,1)= 0.188929292929292929292929292929e-1;
  cjk(5,1)= -0.143008940266083123225980368838e-1;
  cjk(6,1)= 0.105452300926586640872355158069e-1;
  cjk(7,1)= -0.768330089713170945663942862822e-2;
  cjk(8,1)= 0.556130783881249732662067931104e-2;
  cjk(9,1)= -0.400905024302607004970246917744e-2;
  cjk(10,1)= 0.288225069216282985709740724324e-2;
  cjk(11,1)= -0.206821622260765435046747549023e-2;
  %------------------------------------------------
  cjk(1,2)= 0.119830898268398268398268398268e-1;
  cjk(2,2)= -0.119830898268398268398268398268e-2;
  cjk(3,2)= 0.124053285228880466975705070943e-1;
  cjk(4,2)= -0.169823369956633261955390806931e-1;
  cjk(5,2)= 0.190602315356226317740109859829e-1;
  cjk(6,2)= -0.194587390180365368299836788632e-1;
  cjk(7,2)= 0.187242407939765290318113439827e-1;
  cjk(8,2)= -0.172858031195616734921164069860e-1;
  cjk(9,2)= 0.154708654097607916229885866453e-1;
  cjk(10,2)= -0.135156963763942371952364691370e-1;
  cjk(11,2)= 0.115801729046105041564102871166e-1;
  for k=1:2 
    d= 1;  j= 1; 
    ck= cjk(1,k);
    while j <= 10 && d > eps
      term= cjk(j+1,k)*eta1^j; 
      ck= ck+term; 
      d= abs(term/ck); 
      j= j+1;
    end
    Ck(k)=2^(-1/3)*ck;
  end
  djk(1,1)= 0.101240079365079365079365079365e-1;
  djk(2,1)= -0.129954906204906204906204906205e-1;
  djk(3,1)= 0.132413269270412127554984697842e-1;
  djk(4,1)= -0.122399607447226494845542464590e-1;
  djk(5,1)= 0.107090666279461797669080582246e-1;
  djk(6,1)= -0.904181504613803083430168714043e-2;
  djk(7,1)= 0.744533924602741187110181917036e-2;
  djk(8,1)= -0.601776398853332968943407073700e-2;
  djk(9,1)= 0.479448872859975936365180310692e-2;
  djk(10,1)= -0.377638693651310314128868913340e-2;
  djk(11,1)= 0.294682813087680356881578993254e-2;
  %---------------------------------------------
  djk(1,2)= -0.627370444935378591132559386528e-2;
  djk(2,2)= 0.128373245436812707470970776293e-1;
  djk(3,2)= -0.191051785122249118044804740536e-1;
  djk(4,2)= 0.242874273331270553570779704118e-1;
  djk(5,2)= -0.279710609322057709510665097510e-1;
  djk(6,2)= 0.300697060759533722309673750199e-1;
  djk(7,2)= -0.307148176428040350275689711604e-1;
  djk(8,2)= 0.301556558979639758612115327318e-1;
  djk(9,2)= -0.286844300214239245451607595264e-1;
  djk(10,2)= 0.265873192926969347490907100267e-1;
  djk(11,2)= -0.241166927180744584817784898503e-1;
  %---------------------------------------------
  Dk(1)=1;
  for k=1:2 
    d= 1;  j= 1; 
    dk= djk(1,k);
    while j <= 10 && d > eps
      term= djk(j+1,k)*eta1^j; 
      dk= dk+term; 
      d= abs(term/dk); 
      j= j+1;
    end  
    Dk(k+1)=dk;
  end  
  psik(1)= 1;
  psik(2)= -.6;
  psik(3)= .402857142857142857142857142857;
  psik(4)= -.277904761904761904761904761905;
  psik(5)= .193856648113790970933828076685;
  psik(6)= -.136015620569906284191998477713;
  psik(7)= 0.957640124138899649103730736384e-1;
  psik(8)= -0.675766313803221366246576330610e-1;
  psik(9)= 0.477606685464629614811902354397e-1;
  psik(10)= -0.337938397652088449976983380776e-1;
  psik(11)= 0.239318196822205949909434183399e-1;
  d= 1;  k= 1;
  psi= 1; 
  while k <= 10 && d > eps 
    term= psik(k+1)*eta1^k; 
    psi= psi+term; 
    d= abs(term/psi); 
    k= k+1;
  end
  chi=(psi*0.5)^(1/6);
  Czeta=0; Dzeta=0; mu4=mu2*mu2;
  for k=0:1
    Czeta=Czeta+Ck(k+1)/mu4^k;
  end  
  for k=0:2  
    Dzeta=Dzeta+Dk(k+1)/mu4^k;
  end
  Fzeta=Czeta/mu2/chi;
  Gzeta=Dzeta/chi;
end
z= mu^(4/3)*zeta;
if nz-iz<20
  x=akz(nz-iz+1);
  x2=x*x;
  x3=x2*x;
  x4=x3*x;
  d=zper1*mu^(4/3);
  Fa=fa(nz-iz+1);
  d2=d*d; 
  d3=d2*d;
  d4=d3*d;
  d5=d4*d;
  d6=d5*d;
  d7=d6*d;
  d8=d7*d;
  ai=Fa*d*(1+1/6*x*d2+1/12*d3+1/120*x2*d4+1/120*x*d5+...
          1/5040*(x3+10)*d6+1/3360*x2*d7+1/362880*(x4+52*x)*d8);
  aip=Fa*(1+1/2*x*d2+1/3*d3+1/24*x2*d4+1/20*x*d5+...
      1/720*(x3+10)*d6+1/420*x2*d7+1/40320*(x4+52*x)*d8);
else  
  [ai,~]=aibi(z);
  [aip,~]=aibip(z);
end  
fairy=Fzeta*ai+mu^(-2/3)*Gzeta*aip;
yp=gmus*fairy;
end
function [g]=gamstar(x)
giant=realmax/1000;
if (x>=3.0)
  g=exp(stirling(x));
elseif (x>0.0)
  g=gamma(x)/(exp(-x+(x-0.5)*log(x))*sqrt(2*pi));
else
  g=giant;
end
end
function [s]=stirling(x)
%Stirling series, function corresponding with asymptotic series for log(gamma(x))}
% that is:  1/(12x)-1/(360x**3)...; x>= 3}
dwarf=realmin*1000.0;
giant=realmax/1000;
lnsqrttwopi=0.9189385332046727418;
if (x<dwarf)
  s =giant;
elseif (x<1.0)
  ln1=log(gamma(1+x));
  s = ln1-(x+0.5)*log(x)+x-lnsqrttwopi;
elseif (x<2.0)
  ln1=log(gamma(x));
  s =ln1-(x-0.5)*log(x)+x-lnsqrttwopi;
elseif (x<3.0)
  ln1=log(gamma(-1+x));
  s =ln1-(x-0.5)*log(x)+x-lnsqrttwopi+log(x-1);
elseif (x<12.0)
  a=[1.996379051590076518221;
     -0.17971032528832887213e-2;
      0.131292857963846713e-4;
     -0.2340875228178749e-6;
      0.72291210671127e-8;
     -0.3280997607821e-9;
      0.198750709010e-10;
     -0.15092141830e-11;
      0.1375340084e-12;
     -0.145728923e-13;
      0.17532367e-14;
     -0.2351465e-15;
      0.346551e-16;
     -0.55471e-17;
      0.9548e-18;
     -0.1748e-18;
      0.332e-19;
     -0.58e-20];
  z=18.0/(x*x)-1.0;
  s=chepolsum(17,z,a)/(12.0*x);
else
  z=1.0/(x*x);
  if (x<1000.0)
    c=[0.25721014990011306473e-1;
       0.82475966166999631057e-1;
      -0.25328157302663562668e-2;
       0.60992926669463371e-3;
      -0.33543297638406e-3;
       0.250505279903e-3;
       0.30865217988013567769];
    s=((((((c(6)*z+c(5))*z+c(4))*z+c(3))*z+c(2))*z+c(1))/(c(7)+z)/x);
  else
    s=(((-z*0.000595238095238095238095238095238+...
         0.000793650793650793650793650793651)*z...
        -0.00277777777777777777777777777778)*z+...
         0.0833333333333333333333333333333)/x;
  end
end
end
function [chep]=chepolsum(n,t,ak)
u0=0; u1=0; k=n; tt=t+t;
while k>=0
  u2=u1; 
  u1=u0; 
  u0=tt*u1-u2+ ak(k+1); 
  k= k-1; 
end
s=(u0-u2)/2.0;
chep=s;
end 
function [quotgam]=quotgamm(x,y) 
%----------------------------------------------------
% Computation of the quotient of two gamma functions
%  gamma(x)/gamma(y)
%----------------------------------------------------
if (x <= 0.0)||(y <= 0.0)
  quotgam=qratio(x,y);
elseif x>y
  quotgam=1.0/quotgamm(y,x);
else
  n=floor(y-x);
  if n == (y - x)
    quotgam=1.0/shiftfact(x, n);
  elseif (n>15) 
    quotgam=qratio(x,y);
  elseif (n>0)
    quotgam=quotgamm(x+n,y)/shiftfact(x,n);
  elseif (x<26.0) 
    quotgam=qratio(x,y);
  else
    quotgam=qasym(x,y);
  end
end
end
function [qrat]=qratio(x,y)
if (x<=0.0)||(y<=0.0)||(y>2.5*x) 
  qrat=gamma(x)/gamma(y);
else
  b=y-x;
  c=b/x;
  q=lnec(c);
  q=exp(-b*log(x)-(b-0.5)*log(1.0+c)-x*q);
  qrat=q*gamstar(x)/gamstar(y);
end
end
function [qas]=qasym(x,y)  
w=(x+y-1)/2.0;
w2=1.0/(w*w);
r=(x-y+1)/2.0;
r2=r*r;
r3=r2*r;
r4=r2*r2;
r5=r4*r;
r6=r5*r;
r7=r6*r;
cc(1)=1.0;
cc(2)=r/12.0;
cc(3)=r/1440.0+r2/288.0;
cc(4)=r/90720.0+r2/17280.0+r3/10368.0;
cc(5)=r/4838400.0+101*r2/87091200.0+r3/414720.0+r4/497664.0;
cc(6)=r/239500800.0+13*r2/522547200.0+61*r3/1045094400.0+...
      r4/14929920.0+r5/29859840.0;
cc(7)=691.0*r/7846046208000.0+7999.0*r2/14485008384000.0+...
      59.0*r3/41803776000.0+143.0*r4/75246796800.0...
      +r5/716636160.0+r6/2149908480.0;
cc(8)=r/523069747200.0+ 2357*r2/188305108992000.0...
      +5941.0*r3/173820100608000.0...
      +11*r4/214990848000.0+41*r5/902961561600.0...
      +r6/42998169600.0+r7/180592312320.0;
s=1.0;
k=1;
t=1.0;
u=1.0;
while (abs(u)>eps)&&(k< 8)			
  t=-4.0*w2*(k-r)*(k-r-0.5)*t;
  u=t*cc(k+1);
  s=s+u;
  k=k+1;
  qas=s*exp((x-y)*log(w));
end
end
function shift=shiftfact(x,n)
if n==0
  shift=1.0;
elseif (n<0) 
  shift=1.0/shiftfact(x-n,n);
else
  s=1.0;
  k=0;
  while (k<n)
    s=s*(x+k);
    k=k+1;
  end					
  shift=s;
end
end    
function [y]=exmin1minx(x)
if x==0
  y=1.0;
elseif abs(x)>0.9 
  y=(exp(x)-1.0-x)/(x*x*0.5);
else
  t=sinh(x*0.5);
  t2=t*t;
  y=(2*t2+(2.0*t*sqrt(1.0+t2)-x))/(x*x*0.5);
end
end
function [ln1]=lnec(x)
%x>-1; lnec=ln1=ln(1+x)-x
z=logoneplusx(x);
y0=z-x;
e2=exmin1minx(z);
s=e2*z*z/2;
r=(s+y0)/(s+1+z);
ln1=y0-r*(6.0-r)/(6.0-4.0*r);
end
function s=oddchepolsum(n, x, ak)
if (n==0) 
  s=ak(1)*x; 
elseif (n == 1)
  s=x*(ak(1)+ak(2)*(4*x*x - 3)); 
else
  y=2*(2*x*x - 1); 
  r= ak(n+1); h= ak(n)+ r*y;  
  k=n-2;
  while (k >= 0)
    s=r; r= h; h= ak(k+1)+r*y-s; 
    k= k-1; 
  end
  s=x*(h-r);
end
end
function [y]=logoneplusx(t)
if (-0.2928<t)&&(t<0.4142)
  p= 1.18920711500272106671749997;
  p=(p-1.0)/(p+1.0);
  pj=p; ck(1)= pj; p2= p*p; j=1; c=1;
  while (abs(c)> 1.0e-20)&&(j<1000)   
    pj=pj*p2; c=pj/(2.0*j+1.0); 
    ck(j+1)=c; j=j+1; 
  end
  x=t/(2.0+t)*(1.0+p2)/(2.0*p);
  y=4*oddchepolsum(j-1,x,ck);
else
  y=log(1.0+t); 
end
end
function [ai,bi]=aibi(x)
piquart=0.78539816339744830962;
sqrt3=1.732050807568877;
if x < -5
  ar(1)=+1.1280094441222097012e+0;
  ar(2)=-1.836709914558369e-4;
  ar(3)=+1.1677286575962e-6;
  ar(4)=-2.19524008170e-8;
  ar(5)=+7.698908177e-10;
  ar(6)=-4.09915521e-11;
  ar(7)=+2.9533495e-12;
  ar(8)=-2.679714e-13;
  ar(9)=+2.91808e-14;
  ar(10)=-3.6863e-15;
  ar(11)=+5.269e-16;
  ar(12)=-8.36e-17;
  ar(13)=+1.45e-17;
  ar(14)=-2.7e-18;
  ar(15)=+5.0e-19;
  ar(16)=-1.0e-19;
  br(1)=+7.7988242533135881502e-2;
  br(2)=-1.83421439318478417e-4;
  br(3)=+2.226279540000655e-6;
  br(4)=-6.0307865841937e-8;
  br(5)=+2.708298845975e-9;
  br(6)=-1.73155804053e-10;
  br(7)=+1.4396760940e-11;
  br(8)=-1.467799419e-12;
  br(9)=+1.76234030e-13;
  br(10)=-2.4205568e-14;
  br(11)=+3.721795e-15;
  br(12)=-6.30106e-16;
  br(13)=+1.15949e-16;
  br(14)=-2.2951e-17;
  br(15)=+4.846e-18;
  br(16)=-1.084e-18;
  br(17)=+2.55e-19;
  br(18)=-6.3e-20;
  br(19)=+1.6e-20;
  br(20)=-4.0e-21;
  br(21)=+1.0e-21;
  z=(2.0/3.0)*(-x)^(1.5); la= 5.0; 
  t=-2*(la/x)^3-1.0;
  s=sin(z+piquart); c=cos(z+piquart);
  f1=chepolsum(15,t,ar);
  f2=chepolsum(20,t,br);
  y=(-x)^(-0.25);
  ai=y*(s*f1-c*f2/z);
  bi=y*(c*f1+s*f2/z);
elseif x <0  
  ar(1)=+1.5217399882834532859e-1;
  ar(2)=+9.463304395658582345e-2;
  ar(3)=+8.835933286664339033e-2;
  ar(4)=-1.8809032021891572589e-1;
  ar(5)=+7.873696950590187481e-2;
  ar(6)=-1.616162609419079569e-2;
  ar(7)=+2.03792657403144947e-3;
  ar(8)=-1.7619321508091265e-4;
  ar(9)=+1.116557634724685e-5;
  ar(10)=-5.4278037289400e-7;
  ar(11)=+2.092500233007e-8;
  ar(12)=-6.5627359901e-10;
  ar(13)=+1.708749758e-11;
  ar(14)=-3.7550458e-13;
  ar(15)=+7.06091e-15;
  ar(16)=-1.1494e-16;
  ar(17)=+1.64e-18;
  ar(18)=-2.1e-20;    
  br(1)=+7.5365743540308812655e-2;
  br(2)=-4.3238169422348489365e-2;
  br(3)=+9.5247283336721394897e-2;
  br(4)=-6.1705567716412224149e-2;
  br(5)=+1.7697290707409225048e-2;
  br(6)=-2.909533805902076483e-3;
  br(7)=+3.13306256975299299e-4;
  br(8)=-2.3946459531381245e-5;
  br(9)=+1.370954782252896e-6;
  br(10)=-6.1112783503340e-8;
  br(11)=+2.184145572027e-9;
  br(12)=-6.4038637539e-11;
  br(13)=+1.569118251e-12;
  br(14)=-3.2625307e-14;
  br(15)=+5.83052e-16;
  br(16)=-9.054e-18;
  br(17)=+1.23e-19;
  br(18)=-1.5e-21;
  la= 5.0; 
  t= -2*(x/la)^(3)-1.0;
  f1=chepolsum(17,t,ar);
  f2=chepolsum(17,t,br);
  ai=f1-x*f2;
  bi=sqrt3*(f1+x*f2);
elseif x==0.0                                                  
  ai=0.35502805388781723926;
  bi=0.61492662744600073515;
elseif x<4.5                           
  ar(1)=+9.7934675132923263719e-1;
  ar(2)=-5.817935703328346930e-2;
  ar(3)=-1.8573106989330210396e-1;
  ar(4)=+2.466671790187645891e-2;
  ar(5)=+1.523182915947318079e-2;
  ar(6)=-3.18268812403824637e-3;
  ar(7)=-6.4421595859367550e-4;
  ar(8)=+2.1680741331029091e-4;
  ar(9)=+1.036058369682457e-5;
  ar(10)=-9.16356774348920e-6;
  ar(11)=+3.6678407013177e-7;
  ar(12)=+2.5198203640692e-7;
  ar(13)=-2.903896001941e-8;
  ar(14)=-4.22648003774e-9;
  ar(15)=+9.7569578821e-10;
  ar(16)=+2.168534257e-11;
  ar(17)=-2.083233561e-11;
  ar(18)=+1.00889184e-12;
  ar(19)=+2.9268193e-13;
  ar(20)=-3.543870e-14;
  ar(21)=-2.19178e-15;
  ar(22)=+6.4842e-16;
  ar(23)=-1.036e-17;
  ar(24)=-7.75e-18;
  ar(25)=+5.9e-19;
  ar(26)=+6.0e-20;
  br(1)=+7.2340133270078824597e-1;
  br(2)=-6.186433877265966711e-2;
  br(3)=+1.6859154747460945662e-1;
  br(4)=-1.516452843795166719e-2;
  br(5)=+1.268194063516318154e-2;
  br(6)=+2.37665412524311142e-3;
  br(7)=-1.35486356206889915e-3;
  br(8)=+9.4811517986800841e-4;
  br(9)=-3.0184629675683576e-4;
  br(10)=+8.26176092954571e-5;
  br(11)=-1.29237026410167e-5;
  br(12)=+3.86277876708896e-7;
  br(13)=+6.7349791262055e-7;
  br(14)=-2.6650662327003e-7;
  br(15)=+6.313398211272e-8;
  br(16)=-9.28482785276e-9;
  br(17)=+4.2243068981e-10;
  br(18)=+2.2149462027e-10;
  br(19)=-7.885556616e-11;
  br(20)=+1.489486494e-11;
  br(21)=-1.61561338e-12;
  br(22)=-1.99887e-15;
  br(23)=+4.310890e-14;
  br(24)=-1.026039e-14;
  br(25)=+1.36524e-15;
  br(26)=-7.870e-17;
  br(27)=-1.152e-17;
  br(28)=+3.99e-18;
  br(29)=-6.0e-19;
  br(30)=+5.0e-20; 
  la= 4.5; t=2*x/la-1.0;
  f1=chepolsum(25,t,ar);
  f2=chepolsum(29,t, br);
  ai=f1*exp(-1.5*x);
  bi=f2*exp(1.375*x);
elseif x<9
  ar(1)=+5.0491255733788020503e+1;
  ar(2)=-6.257510019590865924e+0;
  ar(3)=-5.510390933031668771e+0;
  ar(4)=+9.23785747211947637e-1;
  ar(5)=+2.69701933599952531e-1;
  ar(6)=-6.0503610861932189e-2;
  ar(7)=-7.272383379486571e-3;
  ar(8)=+2.432739101814126e-3;
  ar(9)=+8.9407383924725e-5;
  ar(10)=-6.7626485765665e-5;
  ar(11)=+1.143189712477e-6;
  ar(12)=+1.369896864000e-6;
  ar(13)=-8.37850105221e-8;
  ar(14)=-2.0445153671e-8;
  ar(15)=+2.247360374e-9;
  ar(16)=+2.14042502e-10;
  ar(17)=-4.0617972e-11;
  ar(18)=-1.169040e-12;
  ar(19)=+5.51909e-13;
  ar(20)=-8.169e-15;
  ar(21)=-5.801e-15;
  ar(22)=+3.09e-16;
  ar(23)=+4.6e-17;
  ar(24)=-5.0e-18;
  br(1)=+5.1865644423401596677e-3;
  br(2)=+3.190078113025389266e-4;
  br(3)=+6.589260266019625254e-4;
  br(4)=+1.77323651950275976e-5;
  br(5)=+4.24724564662038450e-5;
  br(6)=-3.095767914834698e-7;
  br(7)=+1.8968968954113726e-6;
  br(8)=-8.26612616574416e-8;
  br(9)=+6.82206567197979e-8;
  br(10)=-5.5232442059920e-9;
  br(11)=+2.1841788459370e-9;
  br(12)=-2.532110361946e-10;
  br(13)=+6.69024065663e-11;
  br(14)=-9.6266259764e-12;
  br(15)=+2.0421501469e-12;
  br(16)=-3.287463020e-13;
  br(17)=+6.17455626e-14;
  br(18)=-1.01838450e-14;
  br(19)=+1.7333508e-15;
  br(20)=-2.689068e-16;
  br(21)=+3.97206e-17;
  br(22)=-5.1324e-18;
  br(23)=+5.434e-19;
  br(24)=-3.01e-20;
  br(25)=-5.0e-21;
  br(26)=+2.3e-21;
  br(27)=-5.0e-22;
  br(28)=+1.0e-22;
  la=4.5; t=2*(x-la)/(9.0-la)-1.0;
  f1=chepolsum(23,t,ar);
  f2=chepolsum(27,t,br);
  ai=f1*exp(-2.5*x);
  bi=f2*exp(2.5*x);
else
  ar(1)=+5.6312443149444830912e-1;
  ar(2)=-5.2879891960803332e-4;
  ar(3)=+3.72709673104629e-6;
  ar(4)=-4.905124032702e-8;
  ar(5)=+9.3521089895e-10;
  ar(6)=-2.313916112e-11;
  ar(7)=+6.9870927e-13;
  ar(8)=-2.476246e-14;
  ar(9)=+1.00261e-15;
  ar(10)=-4.547e-17;
  ar(11)=+2.28e-18;
  ar(12)=-1.2e-19;
  br(1)=+1.1306068068318665650e+0;
  br(2)=+1.1225343035826004e-3;
  br(3)=+8.8491541977453e-6;
  br(4)=+1.379157291154e-7;
  br(5)=+3.3014426995e-9;
  br(6)=+1.089423404e-10;
  br(7)=+4.6726552e-12;
  br(8)=+2.514325e-13;
  br(9)=+1.66086e-14;
  br(10)=+1.3312e-15;
  br(11)=+1.292e-16;
  br(12)=+1.53e-17;
  br(13)=+2.2e-18;
  br(14)=+4.0e-19;
  la= 9.0; y=(x)^(-0.25); 
  z= 2.0/3.0*(x)^1.5;
  t=2*(la/x)^1.5-1;
  f1=chepolsum(11,t,ar);
  f2=chepolsum(13, t, br);
  la=exp(z);
  ai=y/la*f1;
  bi=y*la*f2;
end
end

function  [aip,bip]=aibip(x)
piquart=0.78539816339744830962;
sqrt3=1.732050807568877;
if x<-5 
  cr(1)=+1.1288167982669480212e+0;
  cr(2)=+2.175180808271174e-4;
  cr(3)=-1.2733503718850e-6;
  cr(4)=+2.33020578931e-8;
  cr(5)=-8.064911115e-10;
  cr(6)=+4.26054712e-11;
  cr(7)=-3.0537799e-12;
  cr(8)=+2.760646e-13;
  cr(9)=-2.99790e-14;
  cr(10)=+3.7789e-15;
  cr(11)=-5.392e-16;
  cr(12)=+8.55e-17;
  cr(13)=-1.48e-17;
  cr(14)=+2.8e-18;
  cr(15)=-6.0e-19;
  cr(16)=+1.0e-19;
  dr(1)=-1.0928773748447830587e-1;
  dr(2)=+2.0544241243325013e-4;
  dr(3)=-2.38739034179860e-6;
  dr(4)=+6.350265424372e-8;
  dr(5)=-2.82350803428e-9;
  dr(6)=+1.7939539824e-10;
  dr(7)=-1.485151455e-11;
  dr(8)=+1.50940584e-12;
  dr(9)=-1.8079342e-13;
  dr(10)=+2.478440e-14;
  dr(11)=-3.80487e-15;
  dr(12)=+6.4333e-16;
  dr(13)=-1.1825e-16;
  dr(14)=+2.339e-17;
  dr(15)=-4.93e-18;
  dr(16)=+1.10e-18;
  dr(17)=-2.60e-19;
  dr(18)=+6.0e-20;
  dr(19)=-2.0e-20;
  z= 2.0/3.0*(-x)^1.5; 
  la=5.0; t= -2*(la/x)^3.0-1.0;
  s=sin(z+piquart); c=cos(z+piquart);
  f3=chepolsum(15,t,cr);
  f4=chepolsum(18,t,dr);
  y=(-x)^0.25;
  aip=-y*(c*f3+s*f4/z);
  bip=y*(s*f3-c*f4/z);
elseif x < 0
  cr(1)=+5.2961692024697341466e-2;
  cr(2)=-4.8382429177635177789e-2;
  cr(3)=+6.2046464244529580518e-2;
  cr(4)=-3.1417437267239646847e-2;
  cr(5)=+7.876452021481851462e-3;
  cr(6)=-1.182440976973326921e-3;
  cr(7)=+1.18871496270269531e-4;
  cr(8)=-8.595270331212026e-6;
  cr(9)=+4.69655735896232e-7;
  cr(10)=-2.0107696526448e-8;
  cr(11)=+6.93493715818e-10;
  cr(12)=-1.9694289584e-11;
  cr(13)=+4.68795260e-13;
  cr(14)=-9.492371e-15;
  cr(15)=+1.65543e-16;
  cr(16)=-2.513e-18;
  cr(17)=+3.4e-20;
  dr(1)=+1.9598877757490956561e-1;
  dr(2)=+2.0709937287929773169e-1;
  dr(3)=-9.618436611491528534e-2;
  dr(4)=-2.6927080774066725642e-1;
  dr(5)=+1.5311467164195350955e-1;
  dr(6)=-3.621663427173734531e-2;
  dr(7)=+5.00970025411579034e-3;
  dr(8)=-4.6418943778727143e-4;
  dr(9)=+3.110071191129936e-5;
  dr(10)=-1.58422527393619e-6;
  dr(11)=+6.359244256854e-8;
  dr(12)=-2.06683376305e-9;
  dr(13)=+5.556077451e-11;
  dr(14)=-1.25683910e-12;
  dr(15)=+2.426805e-14;
  dr(16)=-4.0481e-16;
  dr(17)=+5.89e-18;
  dr(18)=-7.6e-20;
  la= 5.0; t= -2.0*(x/la)^3.0-1.0; z= x*x;
  f3=chepolsum(16,t,cr);
  f4=chepolsum(17,t,dr);
  aip=z*f3-f4;
  bip=sqrt3*(z*f3+f4);
elseif x==0.0
  aip=-0.25881940379280679841;
  bip=0.44828835735382635791
elseif x < 4.5
  cr(1)=-1.0838288082415277302e+0;
  cr(2)=-2.75303325521307795e-2;
  cr(3)=+2.630996799464136716e-1;
  cr(4)=-2.20070838039707907e-2;
  cr(5)=-2.65686371901896143e-2;
  cr(6)=+4.6607302595359725e-3;
  cr(7)=+1.3331627500919505e-3;
  cr(8)=-3.993412832236136e-4;
  cr(9)=-2.57477942743769e-5;
  cr(10)=+1.92965112669086e-5;
  cr(11)=-8.179057497221e-7;
  cr(12)=-5.675046562446e-7;
  cr(13)=+7.38399111711e-8;
  cr(14)=+9.1592819462e-9;
  cr(15)=-2.5909300717e-9;
  cr(16)=-5.596039e-13;
  cr(17)=+5.48262416e-11;
  cr(18)=-4.2085028e-12;
  cr(19)=-6.882068e-13;
  cr(20)=+1.230089e-13;
  cr(21)=+2.2115e-15;
  cr(22)=-2.0268e-15;
  cr(23)=+1.092e-16;
  cr(24)=+2.01e-17;
  cr(25)=-2.8e-18;
  dr(1)=+6.5492503637358356971e-1;
  dr(2)=+7.398273602101549954e-2;
  dr(3)=+1.3916014396498561737e-1;
  dr(4)=-1.318037729688479868e-2;
  dr(5)=+2.721562752659802946e-2;
  dr(6)=-8.95735391942756359e-3;
  dr(7)=+4.64318555084023870e-3;
  dr(8)=-1.31982848083974091e-3;
  dr(9)=+3.2861337599865999e-4;
  dr(10)=-2.823577298366577e-5;
  dr(11)=-1.263661132378531e-5;
  dr(12)=+8.58819079977971e-6;
  dr(13)=-2.83605845640361e-6;
  dr(14)=+6.4357170147486e-7;
  dr(15)=-9.054345148828e-8;
  dr(16)=+1.02361813059e-9;
  dr(17)=+3.75568593189e-9;
  dr(18)=-1.26430133998e-9;
  dr(19)=+2.5000891998e-10;
  dr(20)=-2.967290357e-11;
  dr(21)=+2.6790190e-13;
  dr(22)=+8.3103543e-13;
  dr(23)=-2.2570250e-13;
  dr(24)=+3.487651e-14;
  dr(25)=-2.83929e-15;
  dr(26)=-1.5678e-16;
  dr(27)=+9.941e-17;
  dr(28)=-1.867e-17;
  dr(29)=+2.01e-18;
  dr(30)=-6.0e-20;
  dr(31)=-2.0e-20;
  la= 4.5; t= 2*x/la-1.0;
  f3=chepolsum(24, t, cr);
  f4=chepolsum(30, t, dr);
  aip=f3*exp(-1.375*x);
  bip=f4*exp(1.5*x);
elseif x < 9
  cr(1)=-1.2958123754838538881e+2;
  cr(2)=+6.76832374624909949e+0;
  cr(3)=+1.598511024718904852e+1;
  cr(4)=-1.38866512314607882e+0;
  cr(5)=-9.2855057862186510e-1;
  cr(6)=+1.1311806368323397e-1;
  cr(7)=+3.279015099087572e-2;
  cr(8)=-5.43676653553677e-3;
  cr(9)=-7.5136921782930e-4;
  cr(10)=+1.7836159217021e-4;
  cr(11)=+1.030315382664e-5;
  cr(12)=-4.29105073708e-6;
  cr(13)=-2.395648053e-8;
  cr(14)=+7.851108600e-8;
  cr(15)=-2.78229868e-9;
  cr(16)=-1.10405576e-9;
  cr(17)=+8.374716e-11;
  cr(18)=+1.165092e-11;
  cr(19)=-1.51205e-12;
  cr(20)=-8.180e-14;
  cr(21)=+2.018e-14;
  cr(22)=+1.2e-16;
  cr(23)=-2.1e-16;
  dr(1)=+5.5860183624034104454e-3;
  dr(2)=+2.87080283197283049e-5;
  dr(3)=+6.566960781790676321e-4;
  dr(4)=-1.29004618056797811e-5;
  dr(5)=+3.94734989962719105e-5;
  dr(6)=-1.7468162471848648e-6;
  dr(7)=+1.6312939322265420e-6;
  dr(8)=-1.095384680289487e-7;
  dr(9)=+5.23022431650618e-8;
  dr(10)=-4.4609927148093e-9;
  dr(11)=+1.3623610617155e-9;
  dr(12)=-1.277857258067e-10;
  dr(13)=+2.77519636083e-11;
  dr(14)=-2.2855189985e-12;
  dr(15)=+3.227684345e-13;
  dr(16)=+2.5537222e-15;
  dr(17)=-4.8715113e-15;
  dr(18)=+1.8406926e-15;
  dr(19)=-3.499972e-16;
  dr(20)=+5.20075e-17;
  dr(21)=-3.2250e-18;
  dr(22)=-9.750e-19;
  dr(23)=+5.043e-19;
  dr(24)=-1.464e-19;
  dr(25)=+3.39e-20;
  dr(26)=-6.7e-21;
  dr(27)=+1.2e-21;
  dr(28)=-2.0e-22;
  la= 4.5; t= 2*(x-la)/(9.0-la)-1.0;
  f3= chepolsum(22, t, cr);
  f4= chepolsum(27, t, dr);
  aip= f3*exp(-2.5*x);
  bip= f4*exp(2.625*x);
else
  cr(1)=+5.6568578662442917280e-1;
  cr(2)=+7.4362138971729004e-4;
  cr(3)=-4.42404425936355e-6;
  cr(4)=+5.505791762929e-8;
  cr(5)=-1.02083536642e-9;
  cr(6)=+2.483795569e-11;
  cr(7)=-7.4166337e-13;
  cr(8)=+2.607525e-14;
  cr(9)=-1.04943e-15;
  cr(10)=+4.738e-17;
  cr(11)=-2.36e-18;
  cr(12)=+1.3e-19;
  dr(1)=+1.1252717606343474943e+0;
  dr(2)=-1.5639596736331532e-3;
  dr(3)=-1.04063425452027e-5;
  dr(4)=-1.533581036012e-7;
  dr(5)=-3.5697709625e-9;
  dr(6)=-1.158278459e-10;
  dr(7)=-4.9121069e-12;
  dr(8)=-2.621683e-13;
  dr(9)=-1.72103e-14;
  dr(10)=-1.3725e-15;
  dr(11)=-1.326e-16;
  dr(12)=-1.56e-17;
  dr(13)=-2.2e-18;
  dr(14)=-4.0e-19;
  la= 9.0; y=(x)^0.25; 
  z=2.0/3.0*(x)^1.5;
  t=2*(la/x)^1.5-1.0;
  f3=chepolsum(11,t,cr);
  f4=chepolsum(13,t,dr);
  la=exp(z);
  aip=-y/la*f3;
  bip= y*la*f4;
end
end


